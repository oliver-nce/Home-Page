{"chunk_id": "03_doctype_system__basics__doctypes__frameworktatus__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/frameworktatus", "title": "Frameworktatus", "section_heading": "", "content": "Frappe uses the concept of a \"Docstatus\" to keep track of the status of transactions. The docstatus will always have one of the following three values:\n\n1. Draft (value: 0)\n2. Submitted (value: 1)\n3. Cancelled (value: 2)\n\nDocuments that are \\_not submittable\\_ will always remain in the \"draft\" state. Documents that are \\_submittable\\_ can optionally proceed from the draft state to the \"submitted\", and then to the \"cancelled\" state.\n\nDocuments in the submitted and cancelled state cannot be edited, with one execption: for individual fields we can explicitly allow edits, even when the document is in the submitted state.\n\nIn the backend code we have a helper class `DocStatus` that can be used as follows:\n\n```python\nimport frappe\nfrom frappe.model.docstatus import DocStatus\n\ndraft_invoice_names = frappe.get_list(\n \"Sales Invoice\",\n filters={\"docstatus\": DocStatus.draft()},\n pluck=\"name\"\n)\n\ninvoice_doc = frappe.get_doc(\"Sales Invoice\", draft_invoice_names[0])\ninvoice_doc.docstatus == DocStatus.draft() # -> True\ninvoice_doc.docstatus.is_draft() # -> True\ninvoice_doc.docstatus.is_submitted() # -> False\ninvoice_doc.docstatus.is_cancelled() # -> False\n\ninvoice_doc.submit()\ninvoice_doc.docstatus == DocStatus.submitted() # -> True\ninvoice_doc.docstatus.is_draft() # -> False\ninvoice_doc.docstatus.is_submitted() # -> True\ninvoice_doc.docstatus.is_cancelled() # -> False\n\ninvoice_doc.cancel()\ninvoice_doc.docstatus == DocStatus.cancelled() # -> True\ninvoice_doc.docstatus.is_draft() # -> False\ninvoice_doc.docstatus.is_submitted() # -> False\ninvoice_doc.docstatus.is_cancelled() # -> True\n```\n\nThe docstatus gets stored as an integer value in each Doctype table of the database.", "content_type": "mixed", "has_code": true, "token_count": 421}
{"chunk_id": "03_doctype_system__basics__doctypes__modules__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/modules", "title": "Modules", "section_heading": "", "content": "A DocType will always belong to a module, to enable easier grouping of related models.\nFrappe comes with a lot of built-in modules. For e.g\n\n1. Core - contains doctypes like DocType, DocField, Report, System Settings, etc\n2. Desk - contains doctypes like ToDo, Event, Note, Kanban Board, etc\n3. Email - contains doctypes like Email Account, Newsletter, Email Group, etc\n\nModules also helps in grouping of code files in directories. The controller files\ngenerated by a DocType will live in it's respective Module directory.\n\n```python\nfrappe\n\u251c\u2500\u2500 commands\n\u251c\u2500\u2500 config\n\u251c\u2500\u2500 core\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 doctype\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 doctype\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 docfield\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 report\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 system_settings\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 ...\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 ...\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 page\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 report\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 web_form\n\u251c\u2500\u2500 desk\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 doctype\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 ...\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 event\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 kanban_board\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 note\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 todo\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 form\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 page\n```", "content_type": "mixed", "has_code": true, "token_count": 225}
{"chunk_id": "03_doctype_system__basics__doctypes__docfield__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/docfield", "title": "Docfield", "section_heading": "", "content": "A DocField defines a property (or a field) of a DocType. You can define the column name, label, datatype and more for DocFields. For instance, a ToDo doctype has fields `description`, `status` and `priority`. These ultimately become columns in the database table `tabToDo`.\n\n**Example**\n\nThe DocField stores meta-data about the field. Some of them are described below.\n\n```python\n[\n {\n \"label\": \"Description\", // the value shown to the user (Form, Print, etc)\n \"fieldname\": \"description\", // the property name we refer in code, also the column name\n \"fieldtype\": \"Text Editor\", // the fieldtype which also decides how to store this value\n \"reqd\": 1 // whether this field is mandatory\n },\n {\n \"label\": \"Status\",\n \"fieldname\": \"status\",\n \"fieldtype\": \"Select\",\n \"options\": [\n \"Open\",\n \"Pending\",\n \"Closed\"\n ]\n },\n {\n \"label\": \"Priority\",\n \"fieldname\": \"priority\",\n \"fieldtype\": \"Select\",\n \"options\": [ // list of options for select\n \"Low\",\n \"Medium\",\n \"High\"\n ],\n \"default\": \"Low\" // the default value to be set\n },\n {\n \"label\": \"Completed By\",\n \"fieldname\": \"completed_by\",\n \"fieldtype\": \"Link\",\n \"options\": \"User\",\n \"depends_on\": \"eval: doc.status == 'Closed'\", // the condition on which this field's display depends\n },\n {\n \"collapsible\": 1,\n \"collapsible_depends_on\": \"eval:doc.status!='Closed'\", // determines if a Section Break field is collapsible\n \"fieldname\": \"sb_details\",\n \"fieldtype\": \"Section Break\",\n \"label\": \"Details\"\n },\n {\n \"fieldname\": \"amount\",\n \"fieldtype\": \"Currency\", // Currency field\n \"label\": \"Amount\",\n \"non_negative\": 1, // determines whether this field value can be negative\n \"options\": \"INR\",\n }\n]\n```\n\nSimilar to the `depends_on` property which determines whether a field will be displayed or not,\nin Version 12 we have introduced two new properties:\n\n* `mandatory_depends_on`: If this condition is satisfied, the field will be mandatory.\n* `read_only_depends_on`: If this condition is satisfied, the field will be read only.\n\nFrappe comes with more than 30 different fieldtypes out-of-the-box.\nThese fieldtypes serve a variety of use-cases. You can learn more about fieldtypes in the next page.", "content_type": "mixed", "has_code": true, "token_count": 531}
{"chunk_id": "03_doctype_system__basics__virtual_docfield__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/virtual_docfield", "title": "Virtual Docfield", "section_heading": "How to use Virtual DocFields", "content": "## How to use Virtual DocFields\n\nA Virtual DocField is a dynamic attribute of a given Document (or Record). It's a calculated attribute that isn't stored in the site database. This could be used for representing values that may be functions of other static Document attributes.\n\n![Person Record](/files/Screenshot%202022-02-14%20at%201.55.38%20PM.png)\n*Person Form*\n\nThe age of a person is a function of their date of birth ie if you know a person's birth day, you can figure out their age. Age is also a continuous value; it may change every year, or month, or day, even hour depending on what type of granularity you wish to have. Another attribute is a Person's name. Most common implementations will have a First, Middle and a Last Name, and for the view it would be all of them together like \"Jon Raphael Doe\". Although saving the full name as a separate attribute may not make so much sense when the strings can be easily concatenated. These are a couple of instances where Virtual DocFields make more sense.\n\n![Person DocType](/files/Screenshot%202022-02-14%20at%201.55.08%20PM.png)\n*Person DocType*\n\nHere we've added three fields to Person; two for First and Last names which are stored in the site database, and one that utilizes this data to populate the third field \"Full Name\". In this instance, the options field takes input for the return value of the respective virtual field.\n\n![Full Name - Virtual DocField](/files/Screenshot%202022-02-14%20at%2012.18.20%20PM.png)\n*Person DocType - DocField*\n\nWe discussed the possibility of fields that depend on attributes in the system so far. But this could easily extend to something that doesn't depend on your DocType data alone. You may also want to fetch the statuses of multiple external services in their place, or anything else that you can map here instead.\n\n### How to use Virtual DocFields\n\nThe steps involved in making this work are:\n\n### 1. Define a Virtual DocField\n\nDefining a Virtual DocField is fairly straight forward. Just checking on the \"Virtual\" check box under the DocField's configuration does this. Virtual DocFields don't create a corresponding column in the DocType's table. This makes the field \"Read Only\" in the Form Views.\n\n> Note: Avoid making existing DocFields virtual unless you know what you're doing", "content_type": "prose", "has_code": false, "token_count": 572}
{"chunk_id": "03_doctype_system__basics__virtual_docfield__002", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/virtual_docfield", "title": "Virtual Docfield", "section_heading": "2. Define a source for the field", "content": "## 2. Define a source for the field\n\nThe first step only adds a sort of a placeholder for the values. Without adding some code that dictates what the field should show, there's no field itself. There's two ways of doing this:\n\n* By extending the DocType controllers\n\nAdding a Python property with the same name as the virtual field should do this. This is the most flexible way to do this; you could daisy chain an internal API request, or fetch the data from multiple data sources, sky is the limit.\n\n```python\nclass Person(Document):\n @property\n def age(self):\n return frappe.utils.now_datetime() - self.creation\n```\n\n* Using the `DocField.options`\n\nThis is a bit more restrictive given it allows you to write code directly from Desk. [Utils allowed in Server Scripts](/framework/v14/user/en/desk/scripting/script-api) and Document attributes can be accessed through this. Equivalent of the above property maybe as follows:\n\n```python\nfrappe.utils.now_datetime() - self.creation\n```\n\nThe above mentioned `Person.full_name` example uses Python's f-string feature to achive this in a similar way.\n\n> Note: This should be preferred for relatively smaller scripting. Lookout for in-compatible types errors while using this\n\n### Impact on internals\n\nIf you're wellversed with the physics of the Frappe world, this feature will appear quite predictable.\n\n### Backend API\n\nThe `DatabaseQuery` methods or `Database` APIs will not return virtual values since they don't live in the Site Database.\n\n![](/files/Screenshot%202022-02-14%20at%202.01.58%20PM.png)\n\n### REST API\n\nThe `/api/method/frappe.desk.form.load.getdoc` and `/api/resource` APIs utilize `Document.get_valid_dict` which will compute Virtual values too. These APIs are used to render the Desk Form views too.\n\n![](/files/Screenshot%202022-02-14%20at%201.58.33%20PM.png)\n\n### Database\n\nThere's no footprint of virtual fields in the respective DocType's table. However, you may find corresponding records to give some evidence of their existence in the Custom Field, DocField tables that store DocType's Meta.\n\n![](/files/Screenshot%202022-02-14%20at%202.03.18%20PM.png)", "content_type": "mixed", "has_code": true, "token_count": 531}
{"chunk_id": "03_doctype_system__basics__doctypes__fieldtypes__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/fieldtypes", "title": "Fieldtypes", "section_heading": "Data", "content": "## Data\n\nThere are variety of fieldtypes available in Frappe Framework. Each one has its own use case and can be used to input and store different types of data in a document. Fieldtypes are used to render components in desk as well as web forms.\n\n![Field Types Dropdown Menu](/files/fieldtypes.png)\n\n### Data\n\nThe data field will be a **simple text field**. It allows you to enter a value of up to 140 characters, making this the most generic field type.\n\nYou can enable validations for the following types of data:\n\n1. Name\n2. Email\n3. Phone\n4. URL\n\nby setting the options to \"Name\", \"Email\", \"Phone\" or \"URL\" respectively.\n\n![Data field types](/files/data-field-1.png)\n\n### Link\n\nLink field is connected to another master from where it fetches data. For example, in the Quotation master, the Customer is a Link field. To know more, [click here](https://erpnext.com/docs/user/manual/en/customize-erpnext/articles/creating-custom-link-field).\n\n### Dynamic Link\n\nDynamic Link field is one which can search and hold value of any document/doctype. [Click here](https://erpnext.com/docs/user/manual/en/customize-erpnext/articles/dynamic-link-fields) to learn how Dynamic Link Field functions.\n\n### Check\n\nThis will enable you to have a checkbox here. You can set the `Default` value to 1 and it will be checked by default.\n\n![Check Field Preview](/files/check-field-2.png) ![Check Field Edit](/files/check-field-1.png)", "content_type": "prose", "has_code": false, "token_count": 353}
{"chunk_id": "03_doctype_system__basics__doctypes__fieldtypes__002", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/fieldtypes", "title": "Fieldtypes", "section_heading": "Select", "content": "## Select\n\nUsing the field type \"Select\", you can create a drop-down field. You can specify all selectable values in the *Options* field, each value separated by a new line.\n\nOne of the selectable values can be copied into the *Default* field. This value will then be selected by default in a new form.\n\nIf you enable the *Sort Options* checkbox, values will be displayed in alphabetical order (in the user's language).\n\nThe following screenshot shows how a \"Select\" field can be defined in the **DocType** or via **Customize Form**:\n\n![define_select_field](/files/define_select_field.png \"define_select_field.png\")\n\nAnd this is how it will be rendered in a new form:\n\n![use_select_field](/files/use_select_field.png \"use_select_field.png\")\n\n### Table\n\nWith a \"Table\" field, you can render another DocType as a child table within your form.\n\nFirst, you'll have to choose or define a DocType that has the Checkbox *Is Child Table* enabled. Then you can add a field of type \"Table\" and paste the name of your child table DocType into the *Options* field.\n\nFor example, ERPNext defines a child DocType called \"Purchase Receipt Item\" with *Is Child Table* enabled:\n\n![define_child_table_doctype](/files/define_child_table_doctype.png \"define_child_table_doctype.png\")\n\nAnother DocType called \"Purchase Receipt\" has a field of type \"Table\", with *Options* set to above child doctype \"Purchase Receipt Item\":\n\n![define_child_table_field](/files/define_child_table_field.png \"define_child_table_field.png\")\n\nFinally, the child table will be rendered in the Purchase Receipt form:\n\n![child_table_in_form](/files/child_table_in_form.png \"child_table_in_form.png\")\n\n### Attach\n\nAttach field allows you to browse a field from the File Manager and attach the same herein.\n\n![Field Types](/files/attach_fieldtype.png)\n\n### Attach Image\n\nAttach Image is a field wherein you will be allowed to attach Images of the format jpeg, png, etc. This becomes the Image representing that particular DocType. For e.g., you would want the image of an Item in its DocType, you can choose your field to be an Attach Image Field.\n\n### Text Editor\n\nText Editor is a text field and renders a **WYSIWYG** editor for input. It has various text-formatting options.\n\n![Field Types](/files/text_editor_field.png)\n\n### Date\n\nThis field will enable you to enter the Date in this field.\n\n![Field Types](/files/date_fieldtype.png)\n\n### Date and Time\n\nThis field will give you a date and time picker. The current date and time (as provided by your computer) are set by default.\n\n### Barcode\n\nIn this field, you can specify the field as Barcode which will allow you to enter a Barcode number. Once you do that, the Barcode would automatically get generated against the number.\n\n![barcode](/files/barcode.png)\n\n### Button\n\nThis field lets you place a button in a document. This can be used to perform specific actions like publishing a blog post, triggering an action etc.", "content_type": "prose", "has_code": false, "token_count": 732}
{"chunk_id": "03_doctype_system__basics__doctypes__fieldtypes__003", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/fieldtypes", "title": "Fieldtypes", "section_heading": "Code", "content": "## Code\n\nThis fieldtype can be used to take `code` as input. A code editor is rendered in the document form. Optionally, you can provide a langauge in the fieldtype options to enable syntax highlighting. For example, below is a `Code` type field with options set to `Python`:\n\nYou can enable basic syntax validations for following languages by setting \"Option\".\n\n1. Python (for scripts)\n2. PythonExpression (for simple one-line expressions that must evaluate to a value) E.g. Assignment Rule condition\n\nExample of differences between `Python` and `PythonExpression`:\n\n* `variable = 42` is a valid `Python` code but not a valid `PythonExpression` since the assignment doesn't evaluate to any value.\n* `variable == 42` is both valid `Python` code and valid `PythonExpression` as the expresion can evaluate to some value.\n\n![Field Types](/files/code_fieldtype.png)\n\n### Color\n\nThis will let the user input a color via a rendered color picker or directly input a hexadecimal color.\n\n![Field Types](/files/color_fieldtype.png)\n\n### Column Break\n\nThis is a `'meta'` fieldtype that does not store any input data but can be used to indicate a column break in the document view or form.\n\nFor example,\n\n![Field Types](/files/column_break_fieldtype_1.png)\n\nwill result into:\n\n![Field Types](/files/column_break_fieldtype_2.png)\n\n### Currency\n\nCurrency field holds numeric value, like Item Price, Amount, etc. Currency field can have value up to six decimal places. Also, you can have a currency symbol being shown for the currency field.\n\n### Float\n\nFloat field carries numeric value, up to nine decimal places.", "content_type": "prose", "has_code": false, "token_count": 400}
{"chunk_id": "03_doctype_system__basics__doctypes__fieldtypes__004", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/fieldtypes", "title": "Fieldtypes", "section_heading": "Geolocation", "content": "## Geolocation\n\nA Geolocation field will show a map view on which you can draw polygons, lines, and points. The data is stored as a GeoJSON [feature\\_collection](https://tools.ietf.org/html/rfc7946#section-3.3).\n\nIf you add a Geolocation field with the exact field name \"location\", you will get an additional map view (the equivalent of list view, but on a map). By the way, this also works if you create two separate fields named \"latitude\" and \"longitude\".\n\nNote: Frappe uses the \"Leaflet\" library which stores coordinates as [latitude, longitude] which is the reverse of what GeoJSON usually does.\n\n### HTML\n\nThis will render the content entered in `Options` as HTML in the document form or view page. Here is an example:\n\n![Field Types](/files/html_fieldtype_1.png)\n\nwill result into:\n\n![Field Types](/files/html_fieldtype_2.png)\n\n### Image\n\nImage field will render an image file selected in another attach field.\n\nFor the Image field, under Option (in Doctype), a field name should be provided where the image file is attached. By referring to the value in that field, the image will be a reference in the Image field.\n\n![Field Types](/files/image_fieldtype_1.png)\n\nwill result into:\n\n![Field Types](/files/image_fieldtype_2.png)\n\n### Int (Integer)\n\nThe integer field holds numeric value, without decimal place.\n\n### Small Text\n\nSmall Text field carries text content and has more character limit than the Data field.\n\n### Long Text\n\nYou can define your field to a Long Text Field when you would want to enter data with an unlimited character limit.\n\n### Text\n\nThis field type would allow you to add text in the field. The character limit in Small text, Long text and Text fields shall be determined based on the Relational Database Management System.\n\n### Markdown Editor\n\nThis field will allow you to add the text in markdown. This fieldtype also provides a `Preview` view of rendered HTML:\n\n![Field Types](/files/md_fieldtype_1.png)\n\nwhen preview is clicked:\n\n![Field Types](/files/md_fieldtype_2.png)\n\n### Password\n\nThe password field will have decoded value in it. This type of field can be used to store sensitive data like passwords, pass phrases, secret keys etc.\n\n### Percent\n\nYou can define the field as a Percentage field which in the background will be calculated as a percentage.", "content_type": "prose", "has_code": false, "token_count": 574}
{"chunk_id": "03_doctype_system__basics__doctypes__fieldtypes__005", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/fieldtypes", "title": "Fieldtypes", "section_heading": "Rating", "content": "## Rating\n\nThis field can be used to display an interactive star rating input. The default star count shown is 5, however, this can easily be changed by entering a number ranging from 3 - 10 in the options field for that particular rating field.\n\n![Check Field Edit](/files/rating-field.png)\n\nYou can also provide half ratings e.g 3.5 out of 5.\n\n![Half Rating](/files/Screenshot%202021-12-20%20at%204.52.09%20PM.png)\n\n### Read Only\n\nRead Only field will carry data fetched from another form which will be non-editable. You should set Read Only as field type if its source for value is predetermined.\n\n### Section Break\n\nSection Break is used to divide the form into multiple sections. Any fields that follow (and before any other `Section Break`) a `Section Break` field will be part of this new section.\n\n![Field Types](/files/section_break_fieldtype.png)\n\n### Tab Break\n\nTab Break is used to divide the form into multiple tabs. Any field that follow till the next `Tab Break` will be the part of this new tab.\n\n![Tabs](/files/form-tabs.png)\n\n**Note:** If the `fields` table of a DocType is not started with a Tab Break, a default Tab Break named `Details` will be used. This happens only if a DocType has atleast one `Tab Break` in the `fields` table.\n\n### Signature\n\nYou can define the field to be a Signature field wherein you can add the Digital Signature in this field. Read documentation for [Signature Field](https://docs.erpnext.com/docs/v14/user/manual/en/customize-erpnext/articles/electronic-signature) to know more.\n\n### Table MultiSelect\n\nThis is a combination of 'Link' type and 'Table' type fields. Instead of a child table with 'Add Row' button, in one field multiple values can be selected.\n\n### Time\n\nThis is a Time field where you can define the Time in the field.\n\n### Duration\n\nYou can use the Duration field if you want to define a timespan.\n\nIf you don't want to track duration in terms of days or seconds, you can enable \"Hide Days\" and \"Hide Seconds\" options respectively in your Form. One day is equivalent to 24 hours.\n\n### JSON\n\nThis creates a JSON type column in your database. Also adds syntax highlighting for Desk controls.", "content_type": "prose", "has_code": false, "token_count": 539}
{"chunk_id": "03_doctype_system__basics__doctypes__naming__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/naming", "title": "Naming", "section_heading": "DocType `autoname`", "content": "## DocType `autoname`\n\nAll DocTypes in Frappe have a primary key called `name`. This is the unique id by\nwhich you will be finding records and manipulating them using the ORM.\nYou can configure how `docs` should be named when a new document is created.\nThe following are the ways you can setup naming in a DocType.\n\n### DocType `autoname`\n\nYou can set the name by the `autoname` property of the DocType.\n\n### 1. field:[fieldname]\n\nThe `doc` name is fetched from the value of the field provided.\n\n![naming by field](/files/naming_field.png)\n\n### 2. [series]\n\nYou can provide a naming pattern which will be incremented automatically. For e.g, if you set it as `PRE.#####`, the first document created will have the `name` as **PRE00001**, and second one will be **PRE00002** and so on.\n\n![naming by series](/files/naming_series_1.png)", "content_type": "prose", "has_code": false, "token_count": 207}
{"chunk_id": "03_doctype_system__basics__doctypes__naming__002", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/naming", "title": "Naming", "section_heading": "3. naming\\_series:", "content": "## 3. naming\\_series:\n\nThe naming pattern is derived from a field in the document. For e.g, you have a field `naming_series` in your document and it's value is set as `PRE.#####`, then that will be the pattern used for generating the name. This value can change per document. So the next document can have a different pattern.\n\n> This works only if you have a field called `naming_series` in your DocType.\n\n![naming by series by field](/files/naming_series_2.png)\n\n### 4. Prompt\n\nIf you set it as **Prompt**, the name is required to be filled in manually.\n\n![naming by prompt](/files/naming-prompt.png)\n\n### 5. Format\n\nThis is the most flexible one when it comes to configuring your naming schemes.\n\nLet's say we have\n\n```python\nEXAMPLE-{MM}-test-{fieldname1}-{fieldname2}-{#####}\n```\n\n![naming by format](/files/naming_format.png)\n\nEverything outside the curly braces are plain text. Keywords inside the curly braces will be evaluated based on what they represent. In this case:\n\n* **MM**: will be replaced by the current month\n* **fieldname1**: will be replaced by the value of `fieldname1` in the document\n* **#####**: will generate a series, which starts with `00001`\n\nSo the final name may look like, `EXAMPLE-02-test-value1-value2-00001`\n\n### By Controller Method\n\nYou can also define a name programatically by declaring an `autoname` method in the controller class. Example\n\n```python\nfrom frappe.model.naming import getseries\n\nclass Project(Document):\n def autoname(self):\n # select a project name based on customer\n prefix = `P-{}-`.format(self.customer)\n self.name = getseries(prefix, 3)\n```", "content_type": "mixed", "has_code": true, "token_count": 400}
{"chunk_id": "03_doctype_system__basics__doctypes__naming__003", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/naming", "title": "Naming", "section_heading": "By Document Naming Rule", "content": "## By Document Naming Rule\n\nYou can also create rules for naming DocTypes by creating **Document Naming Rule**\n\n![Document Naming Rule](/files/document-naming-rule.png)\n\nYou can create multiple Document Naming Rules for a particular doctype that can be applied selectively based on filters.\n\nTo define a Document Naming Rule you have to specify\n\n1. Document Type it is being applied on\n2. Priority of the rule (rules with higher priority will be applied first)\n3. Conditions to apply the rule\n4. Naming Rules\n\n### Numbering\n\nYou can define various numbering prefixes for the rule based on the conditions defined. This is done by setting a prefix and the number of digits for that rule.\n\nFor example if you are creating a separate numbering for high priority todos:\n\n1. Prefix: todo-high-\n2. Digits: 3\n\nWill lead to numbering like `todo-high-001`, `todo-high-002` and so on.\n\n### Priority of Naming\n\nNaming priority is as follows\n\n1. Document Naming Rule\n2. `autoname` controller method.\n3. `autoname` DocType property\n\n### Special Rules\n\n1. Child DocTypes do not follow naming rules\n2. Amended documents have a suffix (`-1`, `-2` etc) to the original document", "content_type": "prose", "has_code": false, "token_count": 289}
{"chunk_id": "03_doctype_system__basics__doctypes__controllers__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/controllers", "title": "Controllers", "section_heading": "Controller Methods", "content": "## Controller Methods\n\nA Controller is a normal Python class which extends from `frappe.model.Document` base class. This base class is the core logic of a DocType. It handles how values are loaded from the database, how they are parsed and saved back to the database.\n\nWhen you create a DocType named `Person`, a python file is created by the name `person.py` and the contents look like:\n\n```python\nimport frappe\nfrom frappe.model.document import Document\n\nclass Person(Document):\n    pass\n```\n\nAll the fields are available to the class as attributes.\n\n### Controller Methods\n\nYou can add custom methods to your Controller and it will be callable using the `doc` object. For example,\n\n```python\n# controller class\nclass Person(Document):\n    def get_full_name(self):\n        \"\"\"Returns the person's full name\"\"\"\n        return f\"{self.first_name} {self.last_name}\"\n\n# somewhere in your code\n>>> doc = frappe.get_doc(\"Person\", \"000001\")\n>>> doc.get_full_name()\nJohn Doe\n```", "content_type": "mixed", "has_code": true, "token_count": 243}
{"chunk_id": "03_doctype_system__basics__doctypes__controllers__002", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/controllers", "title": "Controllers", "section_heading": "Controller Hooks", "content": "## Controller Hooks\n\nTo add custom behaviour during the lifecycle of a document, we have controller hooks.\n\n| Method Name | Description | Insert | Save | Submit | Cancel | Update after submit |\n| --- | --- | --- | --- | --- | --- | --- |\n| `before_insert` | This is called before a document is prepared for insertion. | X |  |  |  |  |\n| `before_naming` | This is called before the `name` property of the document is set. | X |  |  |  |  |\n| `autoname` | If defined in the controller, this method is used to set `name` property of the document. | X |  |  |  |  |\n| `before_validate` | This hook is called before validation, use this for auto setting missing values. | X | X | X |  |  |\n| `validate` | Use this method to throw any validation errors and prevent the document from saving. | X | X | X |  |  |\n| `before_save` | This method is called before the document is saved. | X | X |  |  |  |\n| `before_submit` | This method is called before the document is submitted. | X |  | X |  |  |\n| `before_cancel` | This method is called before the document is cancelled. |  |  |  | X |  |\n| `before_update_after_submit` | This method is called when doc fields are updated on submitted document. |  |  |  |  | X |\n| `db_insert` | This method inserts document in database, do not override this unless you're working on virtual DocType. | X |  |  |  |  |\n| `after_insert` | This is called after the document is inserted into the database. | X |  |  |  |  |\n| `db_update` | This method updates document in database, do not override this unless you're working on virtual DocType. |  | X | X | X | X |\n| `on_update` | This is called when values of an existing document is updated. | X | X | X |  |  |\n| `on_submit` | This is called when a document is submitted. |  |  | X |  |  |\n| `on_cancel` | This is called when a submitted document is cancelled. |  |  |  | X |  |\n| `on_update_after_submit` | This is called *when* a submitted document values are updated. |  |  |  |  | X |\n| `on_change` | This is called to hen a document's values has been changed. This method is also called when db\\_set is performed, so operation performed in this this method should be idempotent. | X | X | X | X | X |\n\nApart from doc events for typical actions, you can also hook into other actions.\n\n| Method Name | Description |\n| --- | --- |\n| `before_rename` | This is called before a document is renamed. |\n| `after_rename` | This is called after a document is renamed. |\n| `on_trash` | This is called when a document is being deleted. |\n| `after_delete` | This is called after a document has been deleted. |\n\nTo use a controller hook, just define a class method with that name. For e.g\n\n```python\nclass Person(Document):\n    def validate(self):\n        if self.age <= 18:\n            frappe.throw(\"Person's age must be at least 18\")\n\n    def after_insert(self):\n        frappe.sendmail(recipients=[self.email], message=\"Thank you for registering!\")\n```\n\nYou can also override the pre-defined document methods to add your own behaviour if the hooks aren't enough for you. For e.g to override the `save()` method,", "content_type": "mixed", "has_code": true, "token_count": 771}
{"chunk_id": "03_doctype_system__basics__doctypes__controllers__003", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/controllers", "title": "Controllers", "section_heading": "Controller Hooks", "content": "## Controller Hooks\n\nYou can also override the pre-defined document methods to add your own behaviour if the hooks aren't enough for you. For e.g to override the `save()` method,\n\n```python\nclass Person(Document):\n    def save(self, *args, **kwargs):\n        super().save(*args, **kwargs) # call the base save method\n        do_something() # eg: trigger an API call or a Rotating File Logger that \"User X has tried updating this particular record\"\n```\n\nThere are a lot of methods provided by default on the `doc` object. You can find the complete [list here](/framework/v14/user/en/api/document#document-methods).\n\n### 1. Create a document\n\nTo create a new document and save it to the database,\n\n```python\ndoc = frappe.get_doc({\n    'doctype': 'Person',\n    'first_name': 'John',\n    'last_name': 'Doe'\n})\ndoc.insert()\n\ndoc.name # 000001\n```\n\n### 2. Load a document\n\nTo get an existing document from the database,\n\n```python\ndoc = frappe.get_doc('Person', '000001')\n\n# doctype fields\ndoc.first_name # John\ndoc.last_name # Doe\n\n# standard fields\ndoc.creation # datetime.datetime(2018, 9, 20, 12, 39, 34, 236801)\ndoc.owner # john.doe@frappeframework.com\n```", "content_type": "mixed", "has_code": true, "token_count": 288}
{"chunk_id": "03_doctype_system__basics__doctypes__controllers__004", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/controllers", "title": "Controllers", "section_heading": "Document", "content": "## Document\n\nA Document is an instance of a DocType. It usually maps to a single row in the database table. We refer to it as `doc` in code.\n\n**Example**\n\nLet's say we have a DocType **ToDo** with the following fields:\n\n* `description`\n* `status`\n* `priority`\n\nNow, if we want to query a document from the database, we can use the [ORM](#orm).\n\n```python\n>>> doc = frappe.get_doc(\"ToDo\", \"0000001\")\n<todo: 0000001=\"\">\n\n>>> doc.as_dict()\n{'name': '0000001',\n 'owner': 'Administrator',\n 'creation': datetime.datetime(2022, 3, 28, 18, 20, 23, 275229),\n 'modified': datetime.datetime(2022, 3, 28, 18, 20, 23, 275229),\n 'modified_by': 'Administrator',\n 'docstatus': 0,\n 'idx': 0,\n 'status': 'Open',\n 'priority': 'Medium',\n 'color': None,\n 'date': None,\n 'allocated_to': None,\n 'description': 'Test',\n 'reference_type': None,\n 'reference_name': None,\n 'role': None,\n 'assigned_by': 'Administrator',\n 'assigned_by_full_name': 'Administrator',\n 'sender': None,\n 'assignment_rule': None,\n 'doctype': 'ToDo'}\n```\n\nYou get the values of `description`, `status` and `priority`, but you also get fields like `creation`, `owner` and `modified_by` which are fields added by default by the framework on all `docs`.", "content_type": "mixed", "has_code": true, "token_count": 299}
{"chunk_id": "03_doctype_system__basics__doctypes__controllers__005", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/controllers", "title": "Controllers", "section_heading": "Type Annotations", "content": "## Type Annotations\n\n> Introduced in Version 15.\n\nFrappe support automatically generating Python type annotations in controller files. These annotations can be used for auto-completion, reference and type-checking inside the controller file.\n\n```python\nclass Person(Document):\n    # begin: auto-generated types\n    # This code is auto-generated. Do not modify anything in this block.\n\n    from typing import TYPE_CHECKING\n\n    if TYPE_CHECKING:\n        from frappe.types import DF\n\n        first_name: DF.Data\n        last_name: DF.Data \n        user: DF.Link\n    # end: auto-generated types\n    pass\n```\n\nNote: These annotations are generated when creating or updating doctypes. If you modify the code block, it will get overridden on the next update.\n\nYou can configure automatic exporting in your app by adding the following hook.\n\n```python\n# hooks.py\n\nexport_python_type_annotations = True\n```\n\nLearn more about type annotations:\n\n* <https://docs.python.org/3/library/typing.html>\n* VS Code users can install Python extension for better auto-complete - <https://code.visualstudio.com/docs/languages/python>\n* Most other editors have an equivalent plugin system using LSP.", "content_type": "mixed", "has_code": true, "token_count": 294}
{"chunk_id": "03_doctype_system__basics__doctypes__form___view_settings__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/form_&_view_settings", "title": "Form & View Settings", "section_heading": "Title Field", "content": "## Title Field\n\nA field of the DocType which will be displayed as a title in the Form\n\n![](/files/8mYiuB1.png)\n\n**Set the title field**\n\nEnter the name of a custom field in 'Title Field'\n\n![](/files/HafbLM1.png)\n\n**Show Title in Link Fields**\n\nYou can enable **Show Title in Link Fields** to display **Title** instead of **Name** in the **Link Fields** in another doctype.\n\n![](/files/xhk48oU.png)\n\nSo if a custom field of 'link' type is added in another doctype (or through customize form), then the title of the linked document will be displayed in the field instead of name.\n\n![](/files/8vUNrEr.png)", "content_type": "prose", "has_code": false, "token_count": 150}
{"chunk_id": "03_doctype_system__basics__doctypes__child-doctype__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/child-doctype", "title": "Child Doctype", "section_heading": "Child Properties", "content": "## Child Properties\n\nUp until now we have only seen DocTypes that can have a single value for each field.\nHowever, there might be a need for storing multiple records against one record, also\nknown as many-to-one relationships. A Child DocType is doctype which can only be linked\nto a parent DocType. To make a Child DocType make sure to check **Is Child Table** while\ncreating the doctype.\n\n![Child DocType](/files/child-doctype.png)\n\nTo link a Child Doctype to its parent, add another row in Parent Doctype with field\ntype **Table** and options as **Child Table**.\n\n![Child Table](/files/child-table-field.png)\n\nChild DocType records are directly attached to the parent doc.\n\n```python\n>>> person = frappe.get_doc('Person', '000001')\n>>> person.as_dict()\n{\n 'first_name': 'John',\n 'last_name': 'Doe',\n 'qualifications': [\n {'title': 'Frontend Architect', 'year': '2017'},\n {'title': 'DevOps Engineer', 'year': '2016'},\n ]\n}\n```\n\n### Child Properties\n\nChild documents have special properties that define their relationship to their parent :\n\n* `parent`: name of the parent.\n* `parenttype`: DocType of the parent.\n* `parentfield`: Field in the parent that links this child to it.\n* `idx`: Sequence (row).", "content_type": "mixed", "has_code": true, "token_count": 300}
{"chunk_id": "03_doctype_system__basics__doctypes__single-doctype__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/single-doctype", "title": "Single Doctype", "section_heading": "Schema", "content": "## Schema\n\nA Single DocType is a DocType that has only one instance in the database. It is useful\nfor persisting things like *System Settings*, which don't make sense to have multiple\nrecords.\n\n![Single DocType](/files/single-doctype.png)\n\n```python\n>>> settings = frappe.get_doc('System Settings')\n>>> settings.notification_frequency\n'Daily'\n```\n\n### Schema\n\nSingle DocTypes are stored in the `tabSingles` table in the database, with each property having its own record.\n\nColumns:\n\n* `doctype`\n* `field`\n* `value`", "content_type": "mixed", "has_code": true, "token_count": 128}
{"chunk_id": "03_doctype_system__basics__doctypes__virtual-doctype__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/virtual-doctype", "title": "Virtual Doctype", "section_heading": "Creating a Virtual DocType", "content": "## Creating a Virtual DocType\n\nVirtual DocType is a feature-extension for DocType which allows developers to create DocTypes with custom data sources and DocType controller. The purpose is to define custom DocTypes in the system without creating a table in the database, while utilizing the frontend, resource APIs, and roles and permissions from the framework.\n\nThese Virtual DocTypes function exactly like normal DocTypes in the frontend and are indistinguishable for the end-user, but gives more control to the developer over the DocType's data source. With this, the data source for a Virtual DocType can be anything: an external API, a secondary database, JSON or CSV files, etc. This enables the developers to plug-in database backends other than MariaDB and Postgres, and makes the Frappe Framework even more powerful!\n\n### Creating a Virtual DocType\n\nTo create a Virtual DocType, just select the Virtual DocType checkbox while creating the DocType:\n\n![Virtual DocType](/files/virtual_doctype.png)", "content_type": "prose", "has_code": false, "token_count": 251}
{"chunk_id": "03_doctype_system__basics__doctypes__virtual-doctype__002", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/virtual-doctype", "title": "Virtual Doctype", "section_heading": "Creating a Custom Controller", "content": "## Creating a Custom Controller\n\nAs an example, the following controller code uses a JSON file as the DocType datasource:\n\n```python\nclass VirtualDoctype(Document):\n \"\"\"This is a virtual doctype controller for demo purposes.\n\n - It uses a single JSON file on disk as \"backend\".\n - Key is docname and value is the document itself.\n\n Example:\n {\n \"doc1\": {\"name\": \"doc1\", ...}\n \"doc2\": {\"name\": \"doc2\", ...}\n }\n \"\"\"\n\n DATA_FILE = \"data_file.json\"\n\n @staticmethod\n def get_current_data() -> dict[str, dict]:\n \"\"\"Read data from disk\"\"\"\n if not os.path.exists(VirtualDoctype.DATA_FILE):\n return {}\n\n with open(VirtualDoctype.DATA_FILE) as f:\n return json.load(f)\n\n @staticmethod\n def update_data(data: dict[str, dict]) -> None:\n \"\"\"Flush updated data to disk\"\"\"\n with open(VirtualDoctype.DATA_FILE, \"w+\") as data_file:\n json.dump(data, data_file)\n\n def db_insert(self, *args, **kwargs):\n d = self.get_valid_dict(convert_dates_to_str=True)\n\n data = self.get_current_data()\n data[d.name] = d\n\n self.update_data(data)\n\n def load_from_db(self):\n data = self.get_current_data()\n d = data.get(self.name)\n super(Document, self).__init__(d)\n\n def db_update(self, *args, **kwargs):\n # For this example insert and update are same operation,\n # it might be different for you.\n self.db_insert(*args, **kwargs)\n\n def delete(self):\n data = self.get_current_data()\n data.pop(self.name, None)\n self.update_data(data)\n\n @staticmethod\n def get_list(args):\n data = VirtualDoctype.get_current_data()\n return [frappe._dict(doc) for name, doc in data.items()]\n\n @staticmethod\n def get_count(args):\n data = VirtualDoctype.get_current_data()\n return len(data)\n\n @staticmethod\n def get_stats(args):\n return {}\n```\n\nYou can read about the interface requriements and explanation in the [interface file](https://github.com/frappe/frappe/blob/develop/frappe/model/virtual_doctype.py).\nTo integrate other datasources with the Virtual DocType, you will need to add controller methods defining the database access.\n\n### Outcome\n\nThe frontend for Virtual DocTypes remain unchanged\n\n![Virtual DocType Form](/files/virtual_doctype_form.png)\n\nAll the /api/resource methods defined by the framework are compatible with Virtual DocTypes.\n\n> Added in Version 13", "content_type": "mixed", "has_code": true, "token_count": 554}
{"chunk_id": "03_doctype_system__basics__doctypes__actions-and-links__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/actions-and-links", "title": "Actions And Links", "section_heading": "Actions", "content": "## Actions\n\n> Added in Version 12.1\n\nAction and Links (also called Connections) are two ways to provide the end user more interaction with the document. The image below shows what they are :\n\n![Action and Link View](/files/action-link.png)\n\n### Actions\n\nA DocType may have some `DocType Action` that will result in a button creation on the DocType View. Supported actions are:\n\n1. **Server Action**: This will trigger a whitelisted server action.\n2. **Route**: This will redirect to a given route.\n\n### Configuration of Action\n\n![Action Configuraton](/files/action-config.png)\n\n### Configuration of Action in custom app\n\nTo call an Action in you own app, you will need a python function decorated with `frappe.whitelist` :\n\n```python\nimport frappe\n\n@frappe.whitelist()\ndef execute_function(*args,**kwargs):\n \"\"\"\n This fonction will be executed when the Execute Action Button will be clicked\n \"\"\"\n print('Hello World')\n # The data is transmitted via keyword argument\n print(kwargs)\n```\n\nThis code should go somewhere inside you app, typically in a file like `apps/my_app/my_app/api.py`\n\nAnd then, configure the correspondant Action path :\n\n![Custom Action Configuraton](/files/custom-app-action-config.png)\n\n### Connections (Linked Documents)\n\nA standard navigation aid to the DocType view is the `Connections` section on the dashboard. This helps the viewer identify at a glance which document types are connected to this DocType and can quickly create new related documents.\n\nThese links also support adding internal links (links to DocType in child tables).\n\n### Configuration Connections\n\n![Link Configuration](/files/link-config.png)\n\n![Internal Link](/files/internal-link.png)\n\n### Customization of Actions and Links\n\nDocType Actions and Links are extensible via [Customize Form](customize)", "content_type": "mixed", "has_code": true, "token_count": 448}
{"chunk_id": "03_doctype_system__basics__doctypes__customize__001", "module": "03_doctype_system", "source_url": "https://docs.frappe.io/framework/v15/user/en/basics/doctypes/customize", "title": "Customize", "section_heading": "Customize Form", "content": "## Customize Form\n\nIf you are using the same application for multiple site (tenants), each site may want specific customization on top of the DocType. For example if you have a \"Customer\" DocType each user may want addition Custom Fields or naming or other configuration that would be specific to them.\n\nTo allow for site-specific customization, Frappe Framework has multiple approaches\n\n1. Custom Field: A DocType that keeps track of site-specific fields.\n2. Property Setter: This keeps track of specific properties that are overridden in DocType and its children.\n3. Customize Form: A view that helps you easily customize DocTypes\n4. [Client Script](/framework/v14/user/en/desk/scripting/client-script): Additional client-side event handlers.\n5. [Server Script](/framework/v14/user/en/desk/scripting/server-script): Additional server-side business logic.\n6. Custom DocPerm: Additional Permission (handled via Role Permission Manager)\n\n### Customize Form\n\nCustomize Form is a view that helps you override properties of a DocType and add Custom Fields via a single view.\n\n![Customize Form](/files/customize-form.png)\n\nWhen you change any properties of the DocType via Customize Form, it will not change the underlying DocType but add new custom objects to override those properties. This is done in a seamless manner.\n\n### Adding Custom Links and Actions\n\n> Added in Version 13\n\nYou can also add / edit Links and Actions via Customize Form. These changes are saved in the same DocTypes (`DocType Link` and `DocType Action`) but with a `custom` property checked.\n\nThese addtional (custom) configurations are automatically applied when metadata is fetched via `frappe.get_meta`.", "content_type": "prose", "has_code": false, "token_count": 419}
