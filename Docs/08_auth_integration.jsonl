{"chunk_id": "08_auth_integration__guides__integration__google_gsuite__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_gsuite", "title": "Google Gsuite", "section_heading": "1.1 Publish Google apps script", "content": "## 1.1 Publish Google apps script\n\nFrappe allows you to use Google's Gsuite documents as templates, generate from them a new Gsuite document that will be placed in a chosen folder. Variables can populated in both the body and the name of the Gsuite document using the standard Jinja2 format. Once generated, the Gsuite document will remain associate to the DocType as an attachment.\n\nThe Gsuite document is generated by invoking the \"attach file\" function of any DocType.\n\nA common use cases of this features is populating contracts from customer/employee/supplier data.\n\n### 1.1 Publish Google apps script\n\n*If you will use the default script you can go to 1.2*\n\n1. Go to <https://script.google.com>\n2. Create a new Project. Click on **File > New > Project**\n3. Copy the code of **Desk > Explore > Integrations > GSuite Settings > Google Apps Script** to clipboard and paste to an empty Code.gs in script.google.com\n4. Save the Project. Click on **File > Save > Enter new project name**\n5. Deploy the app. Click on **Publish > Deploy as web app**\n6. Copy \"Current web app URL\" into **Desk > Explore > Integrations > GSuite Settings > Script URL**\n7. Click on OK but don't close the script", "content_type": "prose", "has_code": false, "token_count": 297}
{"chunk_id": "08_auth_integration__guides__integration__google_gsuite__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_gsuite", "title": "Google Gsuite", "section_heading": "1.2 Get Google access", "content": "## 1.2 Get Google access\n\n1. Go to your Google project console and select your project or create a new one. <https://console.developers.google.com>\n2. In Library click on **Google Drive API** and **Enable**\n3. Click on **Credentials > Create Credentials > OAuth Client ID**\n4. Fill the form with:\n\n* Web Application\n* Authorized redirect URI as `http:///?cmd=frappe.integrations.doctype.gsuite_settings.gsuite_settings.gsuite_callback`\n\n1. Copy the Client ID and Client Secret into **Desk > Explore > Integrations > GSuite Settings > Client ID and Client Secret**\n2. Save GSuite Settings\n\n### 1.3 Test Script\n\n1. Click on **Allow GSuite Access** and you will be redirected to select the user and give access. If you have any error please verify you are using the correct Authorized Redirect URI.\n   You can find the complete URI Gsuite redirected to in the final part of the URL of the error page. Check that the protocol `http://` or `https://` matches the one your using.\n2. Click on **Run Script test**. You should be asked to give permission.", "content_type": "prose", "has_code": false, "token_count": 261}
{"chunk_id": "08_auth_integration__guides__integration__google_gsuite__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_gsuite", "title": "Google Gsuite", "section_heading": "2.1 Google Document as Template", "content": "## 2.1 Google Document as Template\n\n1. Create a new Document or use one you already have. Set variables as you need. Variables are defined with `` with ***VARIABLE*** is the field of your Doctype\n\nFor Example,\nIf this document will be used to employee and the Doctype has the field ***name*** then you can use it in Google Docs ad ``\n\n1. Get the ID of that Document from url of your document.\n   For example: in this document url `https://docs.google.com/document/d/1Y2_btbwSqPIILLcJstHnSm1u5dgYE0QJspcZBImZQso/edit` the document ID is `1Y2_btbwSqPIILLcJstHnSm1u5dgYE0QJspcZBImZQso`\n2. Get the ID of the folder where you want to place the generated documents. (You can step this point if you want to place the generated documents in Google Drive root. )\n\nFor example: in this folder url `https://drive.google.com/drive/u/0/folders/0BxmFzZZUHbgyQzVJNzY5eG5jbmc` the folder ID is `0BxmFzZZUHbgyQzVJNzY5eG5jbmc`", "content_type": "prose", "has_code": false, "token_count": 227}
{"chunk_id": "08_auth_integration__guides__integration__google_gsuite__004", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_gsuite", "title": "Google Gsuite", "section_heading": "2.2 Associate the Template to a Doctype", "content": "## 2.2 Associate the Template to a Doctype\n\n1. Go to **Desk > Explore > Integrations > GSuite Templates > New**\n2. Fill the form with:\n\n* Template Name (Example: `Employee Contract`)\n* Related DocType (Example: `Employee`)\n* Template ID is the Document ID you get from your Google Docs (Example: `1Y2_btbwSqPIILLcJstHnSm1u5dgYE0QJspcZBImZQso`)\n* Document name is the name of the new files. You can use field from DocType (Example: `Employee Contract of {name}`)\n* Destination ID is the folder ID of your files created from this Template. (Example: `0BxmFzZZUHbgyQzVJNzY5eG5jbmc`)\n\n### 3. Create Documents\n\n1. Go to a Document you already have a Template for (Example: Employee > John Doe)\n2. Click on **Attach File**\n3. On **GSuite Document** section select the Template and click **Attach**\n4. You should see the generated document is already created and attached\n5. Clicking on the attached document will open it inside Gsuite", "content_type": "prose", "has_code": false, "token_count": 232}
{"chunk_id": "08_auth_integration__guides__integration__how_to_setup_token_based_auth__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_setup_token_based_auth", "title": "How To Setup Token Based Auth", "section_heading": "How does it work?", "content": "## How does it work?\n\nToken-based authentication is a security technique that authenticates the users who attempt to gain access to a server. It is available starting with v11.0.3. The service validates the security token and processes the user request.\n\n### How does it work?\n\nAuthentication is the process by which an application confirms user identity. Applications have traditionally persisted identity through session cookies, relying on session IDs stored server-side. This forces developers to create session storage that is either unique to each server, or implemented as a totally separate session storage layer.\n\nToken authentication is a more modern approach and it is designed to solve problems that session IDs storage mechanism on server-side can\u2019t. Using tokens in place of session IDs can lower your server load.", "content_type": "prose", "has_code": false, "token_count": 207}
{"chunk_id": "08_auth_integration__guides__integration__how_to_setup_token_based_auth__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_setup_token_based_auth", "title": "How To Setup Token Based Auth", "section_heading": "Token CRUD", "content": "## Token CRUD\n\nAs a developer, you can use tokens for full CRUD operations.\nOnce a Token is generated, the token can be used to authorize individual requests made by your users as they are passed to your application. Your application will validate the token sent along with each request.\n\nA combination of API Key and API Secret forms a token which is then used to authenticate you with your application and can be used to authenticate both RPC and REST API.\n\n### Generate a Token\n\nFor every user you can generate an api-key and api-secret which together form a token.\n\n* api-key: identifies the user.\n* api-secret: validates the request.\n\nApi-key and api-secret can be generated from the web interface, from the command line or by remote procedure call (RPC):\n\n* RPC:\n  `/api/method/frappe.core.doctype.user.user?user=\"user_name\"`\n* Command:\n  `bench execute frappe.core.doctype.user.user --args ['user_name']`\n* Web:\n  `User -> Api Access -> Generate Keys`\n\nCheck `Guides / Integrations / Rest Api / Token Based Authentication` to see how to use the token in an API request.\n\n**Note:**\n\n1. Api key cannot be re-generated.\n2. Only users with system manager role can generate keys.", "content_type": "prose", "has_code": false, "token_count": 295}
{"chunk_id": "08_auth_integration__guides__integration__openid_connect_and_frappe_social_login__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/openid_connect_and_frappe_social_login", "title": "Openid Connect And Frappe Social Login", "section_heading": "OpenID Connect", "content": "## OpenID Connect\n\nFrappe also uses Open ID connect essential standard for authenticating users. To get `id_token` with `access_token`, pass `openid` as the value for the scope parameter during authorization request.\n\nIf the scope is `openid` the JSON response with `access_token` will also include a JSON Web Token (`id_token`) signed with `HS256` and `Client Secret`. The decoded `id_token` includes the `at_hash`.\n\nExample Bearer Token with scope `openid`\n\n```python\n{\n \"token_type\": \"Bearer\",\n \"id_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6Imp3dCJ9.eyJpc3MiOiJodHRwczovL21udGVjaG5pcXVlLmNvbSIsImF0X2hhc2giOiJOQlFXbExJUy1lQ1BXd1d4Y0EwaVpnIiwiYXVkIjoiYjg3NzJhZWQ1YyIsImV4cCI6MTQ3Nzk1NTYzMywic3ViIjoiNWFjNDE2NThkZjFiZTE1MjI4M2QxYTk0YjhmYzcwNDIifQ.1GRvhk5wNoR4GWoeQfleEDgtLS5nvj9nsO4xd8QE-Uk\",\n \"access_token\": \"ZJD04ldyyvjuAngjgBrgHwxcOig4vW\",\n \"scope\": \"openid\",\n \"expires_in\": 3600,\n \"refresh_token\": \"2pBTDTGhjzs2EWRkcNV1N67yw0nizS\"\n}\n```\n\n### Frappe social login setup\n\nIn this example there are 2 servers,", "content_type": "mixed", "has_code": true, "token_count": 251}
{"chunk_id": "08_auth_integration__guides__integration__openid_connect_and_frappe_social_login__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/openid_connect_and_frappe_social_login", "title": "Openid Connect And Frappe Social Login", "section_heading": "Primary Server", "content": "## Primary Server\n\nThis is the main server hosting all the users. e.g. `https://frappe.io`. To setup this as the main server, go to *Setup* > *Integrations* > *Social Login Keys* and enter `https://frappe.io` in the field `Frappe Server URL`. This URL repeats in all other Frappe servers who connect to this server to authenticate. Effectively, this is the main Identity Provider (IDP).\n\nUnder this server add as many `OAuth Client`(s) as required. Because we are setting up one app server, add only one `OAuth Client`\n\n### Frappe App Server\n\nThis is the client connecting to the IDP. Go to *Setup* > *Integrations* > *Social Login Keys* on this server and add appropriate values to `Frappe Client ID` and `Frappe Client Secret` (refer to client added in primary server). As mentioned before keep the `Frappe Server URL` as `https://frappe.io`\n\nNow you will see Frappe icon on the login page. Click on this icon to login with account created in primary server (IDP) `https://frappe.io`\n\n**Note**: If `Skip Authorization` is checked while registering a client, page to allow or deny the granting access to resource is not shown. This can be used if the apps are internal to one organization and seamless user experience is needed.\n\n### Part 1 : on Frappe Identity Provider (IDP)\n\nLogin to IDP\n![](/files/00-login-to-idp.png)\n\nAdd OAuth Client on IDP\n![](/files/01-add-oauth-client-on-idp.png)\n\nSet Server URL on IDP\n![](/files/02-set-server-url-on-idp.png)\n\n### Part 2 : on Frappe App Server\n\nSet `Frappe Client ID` and `Frappe Client Secret` on App server (refer the client set on IDP)\n![](/files/03-set-clientid-client-secret-server-on-app-server.png)\n\n**Note**: Frappe Server URL is the main server where identities from your organization are stored.\n\nLogin Screen on App Server (login with frappe)\n![](/files/04-login-screen-on-app-server.png)\n\n### Part 3 : Redirected on IDP\n\nlogin with user on IDP\n![](/files/05-login-with-user-on-idp.png)\n\nConfirm Access on IDP\n![](/files/06-confirm-grant-access-on-idp.png)\n\n### Part 4 : Back on App Server\n\nLogged in on app server with ID from IDP\n![](/files/07-logged-in-as-website-user-with-id-from-idp.png)", "content_type": "prose", "has_code": false, "token_count": 537}
{"chunk_id": "08_auth_integration__guides__integration__webhooks__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/webhooks", "title": "Webhooks", "section_heading": "Configuring a Webhook", "content": "## Configuring a Webhook\n\nWebhooks are \"user-defined HTTP callbacks\". For a select DocType, you can create a webhook that triggers on specific document events under certain conditions, if required.\n\nWhen the `doc_event` occurs, the source site makes an HTTP request to the URI configured for the webhook. Users can configure these webhooks to use events on one site to invoke behaviour on another.\n\n### Configuring a Webhook\n\nTo add a Webhook, go to:\n\n> Integrations > Webhook > Webhook\n\n![](/files/webhook.png)\n\n1. Select the DocType for which the Webhook needs to be triggered (e.g. `Quotation`).\n2. Select the Doc Event that will trigger the Webhook (e.g. `on_update`).\n3. Optionally, you can set additional document Conditions to trigger Webhooks for specific scenarios.\n4. Enter a valid request URL that will receive the Webhook data.\n5. Select the Request Method. `POST` is the default method.\n6. Optionally, you can add HTTP headers to the request. (e.g. useful for sending an API key, if required).\n\nYou can also disable a webhook by unchecking the `Enabled` checkbox. Only webhooks that are enabled get triggered.\n\n### Data Structure\n\n* If your request structure is based on forms, you can select fields from the document in the table, which uses the fieldname as the `key`.\n* If your request structure is based on JSON, you can insert fields from the document using jinja templating (make sure to wrap your fields with double-quotes).", "content_type": "prose", "has_code": false, "token_count": 361}
{"chunk_id": "08_auth_integration__guides__integration__webhooks__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/webhooks", "title": "Webhooks", "section_heading": "Webhook Security", "content": "## Webhook Security\n\nTo optionally add security to your webhook requests and ensure that the webhook is being sent from Frappe, you can set up a \"Webhook Secret\" along with the request. Do not share the secret publicly.\n\nIf enabled, an additional header (`X-Frappe-Webhook-Signature`) will be added to the request before it's sent out, with its value being generated from the secret as a base64-encoded HMAC-SHA256 hash of the payload.", "content_type": "prose", "has_code": false, "token_count": 108}
{"chunk_id": "08_auth_integration__guides__integration__webhooks__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/webhooks", "title": "Webhooks", "section_heading": "Example Webhook Request", "content": "## Example Webhook Request\n\n* **DocType**: `Quotation`\n* **Doc Event**: `on_update`\n* **Request URL**: `https://httpbin.org/post`\n* **Request Structure**: `Form URL-Encoded`\n* **Webhook Headers**:\n\n1. **Key**: `Content-Type:`, **Value**: `application/x-www-form-urlencoded`\n\n* **Webhook Data**:\n\n1. **Fieldname**: `name`, **Key**: `id`\n2. **Fieldname**: `items`, **Key**: `lineItems`\n\nThe above configuration creates the following JSON request (sent by a Frappe server on `Quotation` - `on_update` to https://httpbin.org/post):\n\n```python\n{\n \"args\": {},\n \"data\": \"{\"lineItems\": [{\"stock_qty\": 1.0, \"base_price_list_rate\": 1.0, \"image\": \"\", \"creation\": \"2017-09-14 13:41:58.373023\", \"base_amount\": 1.0, \"qty\": 1.0, \"margin_rate_or_amount\": 0.0, \"rate\": 1.0, \"owner\": \"Administrator\", \"stock_uom\": \"Unit\", \"base_net_amount\": 1.0, \"page_break\": 0, \"modified_by\": \"Administrator\", \"base_net_rate\": 1.0, \"discount_percentage\": 0.0, \"item_name\": \"I1\", \"amount\": 1.0, \"actual_qty\": 0.0, \"net_rate\": 1.0, \"conversion_factor\": 1.0, \"warehouse\": \"Finished Goods - R\", \"docstatus\": 0, \"prevdoc_docname\": null, \"uom\": \"Unit\", \"description\": \"I1\", \"parent\": \"QTN-00001\", \"brand\": null, \"gst_hsn_code\": null, \"base_rate\": 1.0, \"item_code\": \"I1\", \"projected_qty\": 0.0, \"margin_type\": \"\", \"doctype\": \"Quotation Item\", \"rate_with_margin\": 0.0, \"pricing_rule\": null, \"price_list_rate\": 1.0, \"name\": \"QUOD/00001\", \"idx\": 1, \"item_tax_rate\": \"{}\", \"item_group\": \"Products\", \"modified\": \"2017-09-14 17:09:51.239271\", \"parenttype\": \"Quotation\", \"customer_item_code\": null, \"net_amount\": 1.0, \"prevdoc_doctype\": null, \"parentfield\": \"items\"}], \"id\": \"QTN-00001\"}\",\n \"files\": {},\n \"form\": {},\n \"headers\": {\n \"Accept\": \"*/*\",\n \"Accept-Encoding\": \"gzip, deflate\",\n \"Connection\": \"close\",\n \"Content-Length\": \"1075\",\n \"Host\": \"httpbin.org\",\n \"User-Agent\": \"python-requests/2.18.1\"\n },\n \"json\": {\n \"id\": \"QTN-00001\",\n \"lineItems\": [\n {\n \"actual_qty\": 0.0,\n \"amount\": 1.0,\n \"base_amount\": 1.0,\n \"base_net_amount\": 1.0,\n \"base_net_rate\": 1.0,\n \"base_price_list_rate\": 1.0,\n \"base_rate\": 1.0,\n \"brand\": null,\n \"conversion_factor\": 1.0,\n \"creation\": \"2017-09-14 13:41:58.373023\",\n \"customer_item_code\": null,\n \"description\": \"I1\",\n \"discount_percentage\": 0.0,\n \"docstatus\": 0,\n \"doctype\": \"Quotation Item\",\n \"gst_hsn_code\": null,\n \"idx\": 1,\n \"image\": \"\",\n \"item_code\": \"I1\",\n \"item_group\": \"Products\",\n \"item_name\": \"I1\",\n \"item_tax_rate\": \"{}\",\n \"margin_rate_or_amount\": 0.0,\n \"margin_type\": \"\",\n \"modified\": \"2017-09-14 17:09:51.239271\",\n \"modified_by\": \"Administrator\",\n \"name\": \"QUOD/00001\",\n \"net_amount\": 1.0,\n \"net_rate\": 1.0,\n \"owner\": \"Administrator\",\n \"page_break\": 0,\n \"parent\": \"QTN-00001\",\n \"parentfield\": \"items\",\n \"parenttype\": \"Quotation\",\n \"prevdoc_docname\": null,\n \"prevdoc_doctype\": null,\n \"price_list_rate\": 1.0,\n \"pricing_rule\": null,\n \"projected_qty\": 0.0,\n \"qty\": 1.0,\n \"rate\": 1.0,\n \"rate_with_margin\": 0.0,\n \"stock_qty\": 1.0,\n \"stock_uom\": \"Unit\",\n \"uom\": \"Unit\",\n \"warehouse\": \"Finished Goods - R\"\n }\n ]\n },\n \"url\": \"https://httpbin.org/post\"\n}\n```\n\n### Webhook Request Log\n\nA webhook request log is created for every successful request with all the relevant details\n\n![](/files/webhook-request-log.png)", "content_type": "mixed", "has_code": true, "token_count": 799}
{"chunk_id": "08_auth_integration__guides__integration__social_login_key__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/social_login_key", "title": "Social Login Key", "section_heading": "Setup Social Logins", "content": "## Setup Social Logins\n\nAdd social login providers like Facebook, Frappe, Github, Google, Microsoft, etc and enable social login.\n\n### Setup Social Logins\n\nTo add Social Login Key go to\n\n> Integrations > Authentication > Social Login Key\n\nSocial Login Key\n\n![](/files/social-login-key.png)\n\n1. Select the Social Login Provider or select \"Custom\"\n2. If required for provider enter \"Base URL\"\n3. To enable check \"Enable Social Login\" to show Icon on login screen\n4. Also add Client ID and Client Secret as per provider.\n\ne.g. Social Login Key\n\n* **Social Login Provider** : `Frappe`\n* **Client ID** : `ABCDEFG`\n* **Client Secret** : `123456`\n* **Enable Social Login** : `Check`\n* **Base URL** : `https://erpnext.org` (required for some providers)\n\n### Generating Client ID and Client Secret for providers\n\n* [Creating a Google API Console project and client ID](https://developers.google.com/identity/sign-in/web/devconsole-project)\n* [Manually Build a Login Flow for Facebook](https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow)\n* [Creating an OAuth App for GitHub](https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/)\n* [Authorize access to web applications using OpenID Connect and Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-protocols-openid-connect-code)\n* [Create a Connected App on Salesforce](https://help.salesforce.com/articleView?id=connected_app_create.htm)", "content_type": "prose", "has_code": false, "token_count": 370}
{"chunk_id": "08_auth_integration__guides__integration__google_calendar__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_calendar", "title": "Google Calendar", "section_heading": "Setup", "content": "## Setup\n\nFrappe provides an integration with Google Calendar in order for all users to synchronize their events.\n\n### Setup\n\nIn order to allow a synchronization with Google Calendar you need to connect to your application in Google Cloud Platform and then create an account for each of your users:\n\n1. Create a new project on [Google Cloud Platform](https://cloud.google.com/) and generate new OAuth 2.0 credentials\n2. Add `https://{yoursite}` to Authorized JavaScript origins\n3. Add `https://{yoursite}?cmd=frappe.integrations.doctype.gcalendar_settings.gcalendar_settings.google_callback` as an authorized redirect URI\n4. Add your Client ID and Client Secret in the Gcalendar application: in \"Modules>Integrations>Google Calendar>GCalendar Settings\"\n\nOnce this step is successfully completed, each user can create their own account in `Google Calendar > GCalendar Account`.\nThey will be requested to authorize your Google application to access their calendar information and will then be redirected to a success page.", "content_type": "prose", "has_code": false, "token_count": 255}
{"chunk_id": "08_auth_integration__guides__integration__google_calendar__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/google_calendar", "title": "Google Calendar", "section_heading": "Features", "content": "## Features\n\n1. Creation of a new calendar in Google Calendar\n\n* Each User can choose a dedicated name for their Google Calendar.\n\n2. Events synchronization from Frappe to GCalendar\n\n* All Events created in Frappe are created in Google Calendar.\n* Recurring Events are created as recurring events too.\n* You can optionally add a Google Meet conference link to the Event.\n* All participants (User email) will be added to the Event.\n* Events modified in Frappe are updated in Google Calendar.\n* Events deleted in Frappe are deleted in Google Calendar.\n\n3. Events synchronization from GCalendar to Frappe\n\n* Events created in Google Calendar are created in Frappe.\n* Events updated in Google Calendar are updated in Frappe.\n\nThe synchronization module follows Frappe's authorization rule: An event will be only synchronized if it is public or if the user is the owner.\n\n### Limitations\n\nCurrently, if an instance of a recurring event is cancelled in Google Calendar, this change will not be reflected in Frappe.", "content_type": "prose", "has_code": false, "token_count": 252}
{"chunk_id": "08_auth_integration__guides__integration__how_to_set_up_oauth__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_set_up_oauth", "title": "How To Set Up Oauth", "section_heading": "resource owner", "content": "## resource owner\n\n[OAuth 2.0](https://tools.ietf.org/html/rfc6749) provider based on [oauthlib](https://github.com/oauthlib/oauthlib) is built into frappe. Third party apps can now access resources of users based on Frappe Role and User permission system. To setup an app to access\n\n### resource owner\n\nAn entity capable of granting access to a protected resource. When the resource owner is a person, it is referred to as an end-user.\n\n### resource server\n\nThe server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens.\n\n### client\n\nAn application making protected resource requests on behalf of the resource owner and with its authorization. The term \"client\" does not imply any particular implementation characteristics (e.g.,\nwhether the application executes on a server, a desktop, or other devices).\n\n### authorization server\n\nThe server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization.\n\n### Setup OAuth 2 Provider\n\nSystem Managers can setup behavior of confirmation message as `Force` or `Auto` in OAuth Provider Settings.\nIf Force is selected the system will always ask for user's confirmation. If Auto is selected system asks for the confirmation only if there are no active tokens for the user.\n\nGo to\n\n> Setup > Integrations > OAuth Provider Settings\n\n![](/files/oauth_provider_settings.png)", "content_type": "prose", "has_code": false, "token_count": 360}
{"chunk_id": "08_auth_integration__guides__integration__how_to_set_up_oauth__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_set_up_oauth", "title": "How To Set Up Oauth", "section_heading": "Add Primary Server", "content": "## Add Primary Server\n\nThis is the main server hosting all the users. e.g. `https://frappe.io`. To setup this as the main server, go to *Setup* > *Integrations* > *Social Login Key* and add new `Frappe Social Login Key`. Enter `https://frappe.io` in the field `Base URL`. This URL repeats in all other Frappe servers who connect to this server to authenticate. Effectively, this is the main Identity Provider (IDP).\n\nUnder this server add as many `OAuth Client`(s) as required.\n\n### Add a Client App\n\nAs a System Manager go to\n\n> Setup > Integrations > OAuth Client\n\n![](/files/oauth2_client_app.png)\n\nTo add a client fill in the following details\n\n1. **App Name** : Enter App Name e.g. CAVS\n2. **Skip Authorization** : If this is checked, during authentication there won't be me any confirmation message. Skip Authorization means the client is treated as trusted client.\n3. **Scopes** : List of scopes shown to user along with confirmation message. scopes are separated by space.\n4. **Redirect URIs** : List of Redirect URIs separated by space.\n5. **Default Redirect URIs** : Default Redirect URI from list of Redirect URIs\n6. **Grant Type**: select `Authorization Code` or `Implicit`.\n7. **Response Type**: select `Code` if grant type is `Authorization Code` or select `Token`.\n\n### Using OAuth 2\n\nPlease refer to the API documentation to learn how to use OAuth 2 in you application.", "content_type": "prose", "has_code": false, "token_count": 346}
{"chunk_id": "08_auth_integration__guides__integration__how_to_set_up_token_based_auth__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_set_up_token_based_auth", "title": "How To Set Up Token Based Auth", "section_heading": "How does it work?", "content": "## How does it work?\n\nToken-based authentication is a security technique that authenticates the users who attempt to gain access to a server. It is available starting with v11.0.3. The service validates the security token and processes the user request.\n\n### How does it work?\n\nAuthentication is the process by which an application confirms user identity. Applications have traditionally persisted identity through session cookies, relying on session IDs stored server-side. This forces developers to create session storage that is either unique to each server, or implemented as a totally separate session storage layer.\n\nToken authentication is a more modern approach and it is designed to solve problems that session IDs storage mechanism on server-side can\u2019t. Using tokens in place of session IDs can lower your server load.", "content_type": "prose", "has_code": false, "token_count": 207}
{"chunk_id": "08_auth_integration__guides__integration__how_to_set_up_token_based_auth__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/how_to_set_up_token_based_auth", "title": "How To Set Up Token Based Auth", "section_heading": "Token CRUD", "content": "## Token CRUD\n\nAs a developer, you can use tokens for full CRUD operations.\nOnce an Token is generated, the token can be used to authorize individual requests made by your users as they are passed to your application. Your application will validate the token sent along with each request.\n\nAn combination of API Key and API Secret forms a token which is then used to authenticate you with your application and can be used to authenticate both RPC and REST API.\n\n### Generate a Token\n\nFor every user you can generate an api-key and api-secret which together form a token.\n\n* api-key: identifies the user.\n* api-secret: validates the request.\n\nApi-key and api-secret can be generated from the web interface, from the command line or by remote procedure call (RPC):\n\n* RPC:\n  `/api/method/frappe.core.doctype.user.user.generate_keys?user=\"user_name\"`\n* Command:\n  `bench execute frappe.core.doctype.user.user.generate_keys --args ['user_name']`\n* Web:\n  `User -> Api Access -> Generate Keys`\n\nCheck `Guides / Integrations / Rest Api / Token Based Authentication` to see how to use the token in an API request.\n\n**Note:**\n\n1. Api key cannot be re-generated.\n2. Only users with system manager role can generate keys.", "content_type": "prose", "has_code": false, "token_count": 302}
{"chunk_id": "08_auth_integration__using_frappe_as_oauth_service__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/using_frappe_as_oauth_service", "title": "Using Frappe As Oauth Service", "section_heading": "Prerequisites", "content": "## Prerequisites\n\nIn this guide we will learn how to use Frappe Framework for authenticating 3rd party apps with OAuth. We will learn how to set up Grafana server and how to connect to the Frappe Framework for authenticating Grafana.\n\nWe hope this guide will be useful for beginners and we won\u2019t be writing any code other than some configuration files.\n\n### Prerequisites\n\n* A server running a debian based system(Debian, Ubuntu, Pop OS etc..)\n* A Frappe Cloud account. You can sign up for Frappe Cloud [here](https://frappecloud.com/)\n\nOR\n\n* A Frappe Framework site(easier if it\u2019s on the same server)\n* Basic text editing knowledge\n\n### Frappe Framework\n\nFrappe Framework is a low-code, Python, and JavaScript web framework that is used to build delightful web applications. Frappe framework was initially developed for building enterprise-level applications, but it has evolved to be a framework for building general-purpose applications without much fuss. It\u2019s open source and MIT licensed.\n\nThe interesting thing about Frappe Framework is that you don\u2019t have to write code to make everything work. It was built to be as useful for anyone without prior programming knowledge. You can generate DB schemas, REST APIs, Webhooks, Reports and much more without writing a single line of code. You can check all the feature [here](https://frappeframework.com)", "content_type": "prose", "has_code": false, "token_count": 338}
{"chunk_id": "08_auth_integration__using_frappe_as_oauth_service__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/using_frappe_as_oauth_service", "title": "Using Frappe As Oauth Service", "section_heading": "Grafana", "content": "## Grafana\n\nGrafana is an awesome metrics visualization platform built by Grafana Labs. Grafana generates interactive graphs from data and can be used for alerting. Grafana has dashboards, which can pull data from the data source and generate graphs that make the most sense out of the data. Grafana is used internally at Frappe for visualizing server statistics for multiple clients and gives a lot of insights to the servers.\n\n### Installing Frappe Framework\n\nInstalling the Frappe Framework is an art in itself. It requires many moving parts for optimal functioning. Don't let this make you afraid; we have an elaborate guide on how to install and setup Frappe Framework in the [Framework documentation](https://frappeframework.com/docs/v14/user/en/installation#debian-ubuntu).\n\nIf you want the easy way, you can install and setup Frappe Framework with Docker. You can read more about it [here](https://github.com/frappe/frappe_docker).\n\nThe easiest way is to use [Frappe Cloud](https://frappecloud.com) to spin up a new site with Frappe Framework installed.", "content_type": "prose", "has_code": false, "token_count": 265}
{"chunk_id": "08_auth_integration__using_frappe_as_oauth_service__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/using_frappe_as_oauth_service", "title": "Using Frappe As Oauth Service", "section_heading": "Installing Grafana", "content": "## Installing Grafana\n\nFor installing Grafana, you can refer to the [Official Grafana Installation Guide](https://grafana.com/docs/grafana/v9.0/setup-grafana/installation/). We are assuming you're installing Grafana on a Debian-based system.\n\nOnce installed, you have to add grafana to systemd. You can do that by\n\n```python\n# add to systemd to start on bootup\nsystemctl enable grafana-server.service\n# start the service\nsystemctl start grafana-server\n# check status\nsystemctl status grafana-server\n```\n\n### Configuring Frappe for OAuth\n\nOnce you have logged into your site and completed the getting started process for the site, we will create a new entry in the\n`OAuth Client` doctype.\n\nFor accessing the `OAuth Client` doctype, you can use the awesomebar or press `Ctrl + G` to invoke the awesomebar and type in \"OAuth Client\", the autocomplete will show you the list of options.\n\n![Dropdown for OAuth Client](/files/g-2.png)\n\nSelect \"New OAuth Client\" from the dropdown, and you'll be taken to a page for adding the OAuth scopes and settings for the application you want to add OAuth for.\n\n![New OAuth Client](/files/g-3.png)\n\nHere, you have to configure the:\n\n* App Name (Grafana here)\n* Open ID scopes\n* Redirect URIs\n\nThe redirect URI for Grafana from their docs is `<grafana-url>/login/generic_oauth`.\n\n> If you\u2019re on a server without a URL, you can provide the IP address of the server for the `<grafana-url>` part.\n\nOnce you have added the details in the respective fields, you will receive an `App Client ID` and `App Client Secret`. These will be used in the Grafana configuration for the OAuth setup.\n\n![OAuth Client details added](/files/g-5.png)", "content_type": "mixed", "has_code": true, "token_count": 415}
{"chunk_id": "08_auth_integration__using_frappe_as_oauth_service__004", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/using_frappe_as_oauth_service", "title": "Using Frappe As Oauth Service", "section_heading": "Configuring Grafana for OAuth", "content": "## Configuring Grafana for OAuth\n\nAs we have our Client ID and Client Secret from our Frappe framework site, it's time to connect to our Grafana server for the authentication.\n\nThe Grafana configuration files are in the `/etc/grafana` folder on an Ubuntu/Debian system. We will be editing the `grafana.ini` file.\n\n```python\n$ sudo vim grafana.ini\n```\n\nInside the configuration file, for setting up OAuth, you need to edit the `[oauth.generic_oauth]` section. Here you have to uncomment the lines and add the required data.\n\n```python\n[auth.generic_oauth]\nenabled = True\nname = Frappe\nclient_id = <client id=\"\">\nclient_secret = <client secret=\"\">\nscopes = openid all\nauth_url = <frappe_site_url>/api/method/frappe.integrations.oauth2.authorize\ntoken_url = <frappe_site_url>/api/method/frappe.integrations.oauth2.get_token\napi_url = <frappe_site_url>/api/method/frappe.integrations.oauth2.openid_profile\n```\n\nAlso, you will have to add the domain name of the Grafana server to the config if you're using a reverse proxy. You can define the domain and root\\_url in the `server` section of the `grafana.ini` file.\n\nOnce you have done this and saved the file, you have to restart Grafana to make it work. You can use\n\n```python\n$ sudo systemctl restart grafana-server.service\n```\n\nto restart Grafana on an Ubuntu/Debian system.\n\nThat is mostly it. Now reload your Grafana site, and you'll be able to see a \"Sign in with Frappe\" button on the login page.\n\n![Signin with Frappe Grafana](/files/g-6.png)\n\nIf you have done everything correctly, you'll be logged into Grafana with the credentials from your Frappe site.\n\n![Logging in with Frappe GIF](/files/grafana-oauthlogin.gif)", "content_type": "mixed", "has_code": true, "token_count": 417}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api", "title": "Rest Api", "section_heading": "RPC", "content": "## RPC\n\nFrappe ships with an HTTP API that can be classified into *Remote Procedure Calls* (RPC), to call whitelisted methods and *Representational State Transfer* (REST), to manipulate resources.\n\nThe base URL is `https://{your frappe instance}`. Every request shown here should be added to the end of your base URL. For example, if your instance is `demo.erpnext.com`, `GET /api/resource/User` means `GET https://demo.erpnext.com/api/resource/User`.\n\n### RPC\n\nA request to an endpoint `/api/method/dotted.path.to.function` will call a whitelisted python function.\n\nFor example, `GET /api/method/frappe.auth.get_logged_user` will call [this function](https://github.com/frappe/frappe/blob/28b909435320e3d6d1a3b2e7c02f286984dc39b3/frappe/auth.py#L347-L349) from frappe's auth module:\n\n```python\n@frappe.whitelist()\ndef get_logged_user():\n return frappe.session.user\n```\n\nResponse:\n\n```python\n{\n \"message\": \"Administrator\"\n}\n```", "content_type": "mixed", "has_code": true, "token_count": 231}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api", "title": "Rest Api", "section_heading": "REST", "content": "## REST\n\nAll documents in Frappe are available via a RESTful API with prefix `/api/resource/`. You can perform all CRUD operations on them:\n\n* Create\n\nYou can create a document by sending a `POST` request to the endpoint, `/api/resource/{doctype}`.\n\n* Read\n\nYou can get a document by its name using the endpoint, `/api/resource/{doctype}/{name}`\n\n* Update\n\nYou can update a document by sending a `PUT` request to the endpoint, `/api/resource/{doctype}/{name}`. This acts like a `PATCH` HTTP request in which you do not have to send the whole document but only the parts you want to change.\n\n* Delete\n\nYou can delete a document by its name by sending a `DELETE` request to the endpoint, `/api/resource/{doctype}/{name}`.", "content_type": "prose", "has_code": false, "token_count": 179}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__simple_authentication__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/simple_authentication", "title": "Simple Authentication", "section_heading": "POST /api/method/login", "content": "## POST /api/method/login\n\nContent-Type: application/x-www-form-urlencoded\n\nParams (in body):\n\n* usr (string)\n\nUsername\n\n* pwd (string)\n\nPassword\n\nExample:\n\n```python\ncurl -X POST https://{your frappe instance}/api/method/login \\\n -H 'Content-Type: application/json' \\\n -H 'Accept: application/json' \\\n -d '{\"usr\":\"Administrator\",\"pwd\":\"admin\"}'\n```\n\nReturns:\n\n* HTTP Code: 200\n* application/json:\n\n```python\n {\n \"home_page\": \"/desk\",\n \"full_name\": \"Administrator\",\n \"message\": \"Logged in\"\n }\n```\n\n* Cookie: `sid` (send this to authenticate future requests). [Expires in three days](https://github.com/frappe/frappe/blob/e551153ea0a5fb905f2d9508143a9d25ec74aa43/frappe/auth.py#L320).\n\n```python\n sid=05d8d46aaebff1c87a90f570a3ff1c0f570a3ff1c87a90f56bacd4;\n path=/;\n domain=.{your frappe instance};\n Expires=Sat, 29 Sep 2018 00:59:54 GMT;\n```\n\nError:\n\n* HTTP Code: 401\n* text/html: Wrong password or username.\n\n### GET /api/method/logout\n\nExample:\n\n```python\n curl -X GET https://{your frappe instance}/api/method/logout\n```\n\nReturns:\n\n* HTTP Code: 200\n* application/json: `{}`\n\n### GET /api/method/frappe.auth.get\\\\_logged\\\\_user\n\nGet the ID of the currently authenticated user.\n\nExample:\n\n```python\n curl -X GET https://{your frappe instance}/api/method/frappe.auth.get_logged_user\n```\n\nReturns:\n\n* HTTP Code: 200\n* application/json:\n\n```python\n {\n \"message\": \"Administrator\"\n }\n```\n\nAuthor: Raffael Meyer (raffael@alyf.de)", "content_type": "mixed", "has_code": true, "token_count": 356}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__token_based_authentication__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/token_based_authentication", "title": "Token Based Authentication", "section_heading": "Generating API Key and API Secret", "content": "## Generating API Key and API Secret\n\n> Available starting with v11.0.3\n\nThe HTTP Authorization request header contains the credentials to authenticate a user with a server. It consists of the authorization type (`token` or `Basic`) and the corresponding token.\n\n```python\nAuthorization: <type> <token>\n```\n\nThe token consists of `api-key` and `api-secret` joined by a colon.\n\n### Generating API Key and API Secret\n\n1. Go to User list and open a user.\n2. Click on the \"Settings\" tab. (skip this step if you don't see tabs)\n3. Expand the API Access section and click on Generate Keys.\n4. You will get a popup with the API Secret. Copy this value and keep it somewhere safe (Password Manager).\n5. You will also see another field \"API Key\" in this section.\n\nNow, using these two keys you can authenticate your API requests. Every request you make with these keys will be logged against the user you selected in Step 1. This also means that roles will be checked against this user. You can also create a new user just for API calls.\n\n### Token\n\nHTTP header:\n\n```python\nAuthorization: token <api_key>:<api_secret>\n```\n\nExample in python:\n\n```python\nimport requests\n\nurl = \"http://frappe.local:8000/api/method/frappe.auth.get_logged_user\"\nheaders = {\n    'Authorization': \"token <api_key>:<api_secret>\"\n}\nresponse = requests.request(\"GET\", url, headers=headers)\n```", "content_type": "mixed", "has_code": true, "token_count": 339}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__token_based_authentication__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/token_based_authentication", "title": "Token Based Authentication", "section_heading": "Basic", "content": "## Basic\n\nIf the \"Basic\" authentication scheme is used, the credentials are a combination of api\\_key and api\\_secret and are constructed like this:\n\n1. The values are combined with a colon `<api_key>:<api_secret>`\n2. The resulting string is base64 encoded. `base64encode(<api_key>:<api_secret>)`\n\nHTTP header:\n\n```python\nAuthorization: Basic base64encode(\"<api_key>:<api_secret>\")\n```\n\nExample in python:\n\n```python\nimport requests\nimport base64\n\nurl = \"http://frappe.local:8000**/api/method/frappe.auth.get_logged_user**\"\nheaders = {\n    'Authorization': \"Basic %s\" % base64.b64encode(<api_key>:<api_secret>)\n}\nresponse = requests.request(\"GET\", url, headers=headers)\n```\n\n### Access Token\n\nIf the OAuth 2 Access Token is used to authenticate request, the token is opaque `access_token` string provided by Frappe Server after setting up OAuth 2 and generating token. Check `Guides / Integration / How To Use OAuth 2`\n\nHTTP header:\n\n```python\nAuthorization: Bearer access_token\n```\n\nExample in python:\n\n```python\nimport requests\nimport base64\n\nurl = \"http://frappe.local:8000**/api/method/frappe.auth.get_logged_user**\"\nheaders = {\n    \"Authorization\": \"Bearer %s\" % access_token\n}\nresponse = requests.request(\"GET\", url, headers=headers)\n```\n\n### Further resources\n\n* [Authorization Header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization)", "content_type": "mixed", "has_code": true, "token_count": 341}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "GET /api/method/frappe.integrations.oauth2.authorize", "content": "## GET /api/method/frappe.integrations.oauth2.authorize\n\nUse the header `Authorization: Bearer <access_token>` to perform authenticated requests. You can receive a [bearer token](https://tools.ietf.org/html/rfc6750) by combining the following two requests.\n\n> Here is an amazing introduction to OAuth: [OAuth 2.0 and OpenID Connect (in plain English)](https://www.youtube.com/watch?v=996OiexHze0)\n\n### GET /api/method/frappe.integrations.oauth2.authorize\n\nGet an authorization code from the user to access ERPNext on his behalf.\n\nParams (in query):\n\n* client\\_id (string)\n\nID of your OAuth2 application\n\n* state (string)\n\nArbitrary value used by your client application to maintain state between the request and callback. The authorization server includes this value when redirecting the user-agent back to the client. The parameter should be used for preventing [cross-site request forgery](https://tools.ietf.org/html/rfc6749#section-10.12).\n\n* response\\_type (string)\n\n\"code\"\n\n* scope (string)\n\nThe scope of access that should be granted to your application.\n\n* redirect\\_uri (string)\n\nCallback URI that the user will be redirected to, after the application is authorized. The authorization code can then be extracted from the params.\n\n* code\\_challenge\\_method (string)\n\n(OPTIONAL) Can be one from `s256` or `plain`.\n\n* code\\_challenge (string)\n\n(OPTIONAL) Can be `base64encode(sha256(random_string))` in case `code_challenge_method=s256` or `random_string` in case `code_challenge_method=plain`. Refer https://tools.ietf.org/html/rfc7636#appendix-A\n\nExample:\n\n```python\ncurl -X POST https://{your frappe instance}/api/method/frappe.integrations.oauth2.authorize \\\n --data-urlencode 'client_id=511cb2ac2d' \\\n --data-urlencode 'state=444' \\\n # base64encode(sha256('420')) => 21XaP8MJjpxCMRxgEzBP82sZ73PRLqkyBUta1R309J0\n # --data-urlencode 'code_verifier=21XaP8MJjpxCMRxgEzBP82sZ73PRLqkyBUta1R309J0' \\\n --data-urlencode 'response_type=code'\n --data-urlencode 'scope=openid%20all' \\\n --data-urlencode 'redirect_uri=https://app.getpostman.com/oauth2/callback'\n```\n\nReturns:\n\n* HTTP Code: 200\n* text/html\n\nThis will open the authorize page which then redirects you to the `redirect_uri`.\n\nIf the user clicks 'Allow', the redirect URI will be called with an authorization code in the query parameters:\n\n`https://{redirect uri}?code=plkj2mqDLwaLJAgDBAkyR1W8Co08Ud&state=444`\n\nIf user clicks 'Deny' you will receive an error:\n\n`https://{redirect uri}?error=access_denied`", "content_type": "mixed", "has_code": true, "token_count": 616}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "Token Exchange for Authorization Code Grant with ID Token", "content": "## Token Exchange for Authorization Code Grant with ID Token\n\n```python\nPOST /api/method/frappe.integrations.oauth2.get_token\nHeader Content-Type: application/x-www-form-urlencoded\n```\n\n> Note: This endpoint can also be used to get a refreshed access token. Just send the `refresh_token` in the request body.\n\nTrade the authorization code (obtained above) for an access token.\n\nParams (in body):\n\n* grant\\_type (string)\n\n\"authorization\\_code\"\n\n* code (string)\n\nAuthorization code received in redirect URI.\n\n* client\\_id (string)\n\nID of your OAuth2 application\n\n* redirect\\_uri (string)\n\nRegistered redirect URI of client app\n\nExample:\n\n```python\ncurl -X POST https://{your frappe instance}/api/method/frappe.integrations.oauth2.get_token \\\n -H 'Content-Type: application/x-www-form-urlencoded' \\\n -H 'Accept: application/json' \\\n -d 'grant_type=authorization_code&code=wa1YuQMff2ZXEAu2ZBHLpJRQXcGZdr\n &redirect_uri=https%3A%2F%2Fapp.getpostman.com%2Foauth2%2Fcallback&client_id=af615c2d3a'\n```\n\nFor **testing purposes** you can also pass the parameters in the URL like this (and open it in the browser):\n\n`https://{your frappe instance}/api/method/frappe.integrations.oauth2.get_token?grant_type=authorization_code&code=A1KBRoYAN1uxrLAcdGLmvPKsRQLvzj&client_id=511cb2ac2d&redirect_uri=https%3A%2F%2Fapp.getpostman.com%2Foauth2%2Fcallback`\n\nReturns:\n\n```python\n {\n \"access_token\": \"pNO2DpTMHTcFHYUXwzs74k6idQBmnI\",\n \"token_type\": \"Bearer\",\n \"expires_in\": 3600,\n \"refresh_token\": \"cp74cxbbDgaxFuUZ8Usc7egYlhKbH1\",\n \"scope\": \"openid all\",\n \"id_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.XbPfbIHMI6arZ3Y922BhjWgQzWXcXNrz0ogtVhfEd2o\"\n }\n```", "content_type": "mixed", "has_code": true, "token_count": 428}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "Token Exchange for Authorization Code Grant with ID Token (PKCE)", "content": "## Token Exchange for Authorization Code Grant with ID Token (PKCE)\n\n```python\nPOST /api/method/frappe.integrations.oauth2.get_token\nHeader Content-Type: application/x-www-form-urlencoded\n```\n\nTrade the authorization code (obtained above) for an access token.\n\nParams (in body):\n\n* grant\\_type (string)\n\n\"authorization\\_code\"\n\n* code (string)\n\nAuthorization code received in redirect URI.\n\n* client\\_id (string)\n\nID of your OAuth2 application\n\n* redirect\\_uri (string)\n\nRegistered redirect URI of client app\n\n* code\\_verifier (string)\n\n`random_string` used during `Authorization Request` with `code_challenge_method` and `code_challenge`.\n\nContent-Type: application/x-www-form-urlencoded\n\nExample:\n\n```python\ncurl -X POST https://{your frappe instance}/api/method/frappe.integrations.oauth2.get_token \\\n -H 'Content-Type: application/x-www-form-urlencoded' \\\n -H 'Accept: application/json' \\\n -d 'grant_type=authorization_code&code=wa1YuQMff2ZXEAu2ZBHLpJRQXcGZdr\n &redirect_uri=https%3A%2F%2Fapp.getpostman.com%2Foauth2%2Fcallback&client_id=af615c2d3a&code_verifier=420'\n```\n\nFor **testing purposes** you can also pass the parameters in the URL like this (and open it in the browser):\n\n`https://{your frappe instance}/api/method/frappe.integrations.oauth2.get_token?grant_type=authorization_code&code=A1KBRoYAN1uxrLAcdGLmvPKsRQLvzj&client_id=511cb2ac2d&redirect_uri=https%3A%2F%2Fapp.getpostman.com%2Foauth2%2Fcallback&code_verifier=420`\n\nReturns:\n\n```python\n{\n \"access_token\": \"pNO2DpTMHTcFHYUXwzs74k6idQBmnI\",\n \"token_type\": \"Bearer\",\n \"expires_in\": 3600,\n \"refresh_token\": \"cp74cxbbDgaxFuUZ8Usc7egYlhKbH1\",\n \"scope\": \"openid all\",\n \"id_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.XbPfbIHMI6arZ3Y922BhjWgQzWXcXNrz0ogtVhfEd2o\"\n}\n```\n\n### Revoke Token Endpoint\n\n```python\nPOST /api/method/frappe.integrations.oauth2.revoke_token\nHeader: Content-Type: application/x-www-form-urlencoded\n```\n\nRevoke token endpoint.\n\nParams:\n\n* token\n\nAccess token to be revoked.\n\nReturns:\n\nAlways returns empty response with HTTP status code 200.\n\n```python\n {}\n```", "content_type": "mixed", "has_code": true, "token_count": 530}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__004", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "Open ID Connect id\\_token", "content": "## Open ID Connect id\\_token\n\nID Token is a JWT.\n\n* `aud` claim has registered `client_id`.\n* `iss` claim has frappe server url.\n* `sub` claim has Frappe User's userid.\n* `roles` claim has user roles.\n* `exp` claim has expiration time.\n* `iat` claim has issued at time.\n\nExample: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkouIERvZSIsImVtYWlsIjoiakBkb2UuY29tIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDIwMjIsImF1ZCI6ImNsaWVudF9pZCJ9.ZEdnrHjLbArahVTN19b4zoRFoBO5a2BakRkR82O1VU8`\n\nVerify and extract it with PyJWT.\n\n```python\nimport jwt\n\nid_token = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkouIERvZSIsImVtYWlsIjoiakBkb2UuY29tIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDIwMjIsImF1ZCI6ImNsaWVudF9pZCIsInJvbGVzIjpbIlN5c3RlbSBNYW5hZ2VyIiwiU2FsZXMgTWFuYWdlciJdLCJub25jZSI6Ijc4OTEyMyIsImlzcyI6Imh0dHBzOi8vZXJwLmV4YW1wbGUuY29tIn0.F8Wbh5dtD1loZPltJLj_sqF9DZNeBvEbo-ITtf3UPqk\"\n\nclient_id = 'client_id'\nclient_secret = 'client_secret'\n\npayload = jwt.decode(\n id_token,\n audience=client_id,\n key=client_secret,\n algorithm=\"HS256\",\n options={\"verify_exp\": False}, # Enabled by default to verify expiration time\n)\n\nprint(payload)\n# Output\n\n{'sub': '1234567890', 'name': 'J. Doe', 'email': 'j@doe.com', 'iat': 1516239022, 'exp': 1516242022, 'aud': 'client_id', 'roles': ['System Manager', 'Sales Manager'], 'nonce': '789123', 'iss': 'https://erp.example.com'}\n```", "content_type": "mixed", "has_code": true, "token_count": 352}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__005", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "OpenID User Info Endpoint", "content": "## OpenID User Info Endpoint\n\nRequest\n\n```python\nGET /api/method/frappe.integrations.oauth2.openid_profile\nHeader: Authorization: Bearer valid_access_token\n```\n\nResponse\n\n```python\n{\n \"sub\": \"1234567890\",\n \"name\": \"J. Doe\",\n \"given_name\": \"J\",\n \"family_name\": \"Doe\",\n \"iss\": \"https://erp.example.com\",\n \"picture\": \"https://erp.example.com/files/jdoe.jpg\",\n \"email\": \"j@doe.com\",\n \"iat\": 1516239022,\n \"exp\": 1516242022,\n \"aud\": \"client_id\",\n \"roles\": [\"System Manager\", \"Sales Manager\"]\n}\n```\n\n### Introspect Token Endpoint\n\n```python\nPOST /api/method/frappe.integrations.oauth2.introspect_token\nHeader: Content-Type: application/x-www-form-urlencoded\n```\n\nRevoke token endpoint.\n\nParams:\n\n* token\\_type\\_hint\n\n`access_token` or `refresh_token`, defaults to `access_token` if nothing is provided\n\n* token\n\nAccess token or Refresh Token to be introspected. Depends on token\\_type\\_hint\n\nReturns:\n\n```python\n{\n \"client_id\": \"511cb2ac2d\",\n \"trusted_client\": 1,\n \"active\": true,\n \"exp\": 1619523326,\n \"scope\": \"openid all\",\n \"sub\": \"1234567890\",\n \"name\": \"J. Doe\",\n \"given_name\": \"J\",\n \"family_name\": \"Doe\",\n \"iss\": \"https://erp.example.com\",\n \"picture\": \"https://erp.example.com/files/jdoe.jpg\",\n \"email\": \"j@doe.com\",\n \"iat\": 1516239022,\n \"exp\": 1516242022,\n \"aud\": \"511cb2ac2d\",\n \"roles\": [\"System Manager\", \"Sales Manager\"]\n}\n```\n\nOR\n\n```python\n{\n \"active\": false,\n \"_server_messages\": \"...\"\n}\n```", "content_type": "mixed", "has_code": true, "token_count": 348}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__oauth-2__006", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/oauth-2", "title": "Oauth 2", "section_heading": "Further Reading", "content": "## Further Reading\n\nPlease check `Guides / Integration / How To Set Up Oauth` to see how to create a new OAuth 2 client.\n\n* [Content-Type Header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type),\n* [Authorization Header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization),\n* [OAuth 2 Specification](https://tools.ietf.org/html/rfc6749),\n* [Bearer token](https://tools.ietf.org/html/rfc6750).\n\nAuthors:\n\n* Raffael Meyer (raffael@alyf.de)\n* Revant Nandgaonkar (revant@castlecraft.in)\n\n</access\\_token>", "content_type": "prose", "has_code": false, "token_count": 136}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__listing_documents__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/listing_documents", "title": "Listing Documents", "section_heading": "", "content": "To list documents, make a GET request to `/api/resource/{doctype}`.\n\nGET **/api/resource/Person**\n\n> All listings are returned paginated by 20 items. To change the page size, you can pass the query parameter `limit_page_length`. To request succesive pages, pass `limit_start`.\n\nThe response is returned as JSON Object and the listing is an array in with the key `data`.\n\nResponse:\n\n```python\n{\n \"data\": [\n {\n \"name\": \"000000012\"\n },\n {\n \"name\": \"000000008\"\n }\n ]\n}\n```\n\nBy default, only the `name` field is included in the listing. To add more fields, you can pass the `fields` parameter with your GET request. `fields` has to be a JSON array containing the fieldnames.\n\nGET **/api/resource/Person/?fields=[\"name\",\"first\\_name\"]**\n\nResponse:\n\n```python\n{\n \"data\": [\n {\n \"first_name\": \"Jane\",\n \"name\": \"000000012\"\n },\n {\n \"first_name\": \"John\",\n \"name\": \"000000008\"\n }\n ]\n}\n```\n\nYou can filter the listing using SQL-conditions by passing the query parameter `filters`. `filters` has to be a JSON array containing one or multiple filters. Each condition is an array of the format, [{doctype}, {field}, {operator}, {operand}].\n\nFor example, get the name (id) of all persons with firstname \"Jane\":\n\nGET **/api/resource/Person?filters=[[\"Person\",\"first\\_name\",\"=\",\"Jane\"]]**\n\nResponse:\n\n```python\n { \"data\": [ { \"name\": \"000000012\" } ] }\n```\n\nAuthors: Rushabh Mehta (rushabh@erpnext.com), Raffael Meyer (raffael@alyf.de)", "content_type": "mixed", "has_code": true, "token_count": 353}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__manipulating_documents__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/manipulating_documents", "title": "Manipulating Documents", "section_heading": "GET /api/resource/{DocType}", "content": "## GET /api/resource/{DocType}\n\nA DocTypes is a specific type of document, for example: Customer, Employee or Item.\n\nA DocumentName is the unique ID of a Document, for example: CUST-00001, EMP-00001 or ITEM-00001.\n\nAuthentication is missing in the following examples. See [Basic Authentication] and [OAuth2] for more.\n\n### GET /api/resource/{DocType}\n\nGet a list of documents of this DocType.\n\nParams (in path):\n\n* DocType (string)\n\nThe DocType you'd like to receive. For example, 'Customer'.\n\nParams (in query):\n\n* `fields` []\n\nBy default, only the 'name' field will be returned. To add more fields, you can pass the *fields* parameter. For example, fields=[\"name\",\"country\"]\n\n* `filters` [[(string)]]\n\nYou can filter the listing using SQL conditions by passing them in the *filters* parameter. Each condition is an array of the format, [{doctype}, {field}, {operator}, {value}]. For example, filters=[[\"Customer\", \"country\", \"=\", \"India\"]]\n\n* `limit_page_length` (int)\n\nAll listings will be paginated. With this parameter you can change the page size (how many items are teturned at once). Default: 20.\n\n* `limit_start` (int)\n\nTo request successive pages, pass a multiple of your `limit_page_length` as `limit_start`. For example, to request the second page, pass `limit_start` as 20.\n\nExample:\n\n*Get at most 20 Names (IDs) of all Customers whose phone number is 4915227058038.*\n\n```python\ncurl -X GET https://{your frappe instance}/api/resource/Customer?fields=[\"name\"]\\\n &filters=[[\"Customer\",\"phone\",\"=\",\"4915227058038\"]]\n```\n\nReturns:\n\n```python\n {\n \"data\": [\n {\n \"name\": \"CUST-00001\"\n },\n ]\n }\n```", "content_type": "mixed", "has_code": true, "token_count": 401}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__manipulating_documents__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/manipulating_documents", "title": "Manipulating Documents", "section_heading": "POST /api/resource/{DocType}", "content": "## POST /api/resource/{DocType}\n\nCreate a new document of this DocType.\n\nParams (in path):\n\n* DocType (string)\n\nThe DocType you'd like to create. For example, 'Customer'.\n\nContent-Type: `application/json`\n\nRequest Body: `{\"fieldname\": value}`\n\nExample:\n\n*Create a new Lead named Mustermann.*\n\n```python\ncurl -X POST https://{your frappe instance}/api/resource/Lead \\\n -H 'Content-Type: application/json' \\\n -H 'Accept: application/json' \\\n -d '{\"lead_name\":\"Mustermann\"}'\n```\n\n### GET /api/resource/{DocType}/{DocumentName}\n\nRetrieve a specific document by name (ID).\n\nParams (in path):\n\n* DocType (string)\n\nThe type of the document you'd like to get. For example, 'Customer'.\n\n* DocumentName (string)\n\nThe name (ID) of the document you'd like to get. For example, 'EMP-00001'.\n\nExample:\n\n*Get the Customer with Name (ID) CUST-00001.*\n\n```python\ncurl -X GET https://{your frappe instance}/api/resource/Customer/CUST-00001\n```", "content_type": "mixed", "has_code": true, "token_count": 231}
{"chunk_id": "08_auth_integration__guides__integration__rest_api__manipulating_documents__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/integration/rest_api/manipulating_documents", "title": "Manipulating Documents", "section_heading": "PUT /api/resource/{DocType}/{DocumentName}", "content": "## PUT /api/resource/{DocType}/{DocumentName}\n\nUpdate a specific document. This acts like a `PATCH` HTTP request in which you do not have to send the whole document but only the parts you want to change.\n\nParams (in path):\n\n* DocType (string)\n\nThe type of the document you'd like to update. For example, 'Customer'.\n\n* DocumentName (string)\n\nThe name (ID) of the document you'd like to update. For example, 'EMP-00001'.\n\nContent-Type: application/json\n\nRequest Body: `{\"fieldname\": value}`\n\nExample:\n\n*Update Next Contact Date.*\n\n```python\ncurl -X PUT https://{your frappe instance}/api/resource/Lead/LEAD-00001 \\\n -H 'Accept: application/json' \\\n -H 'Content-Type: application/json' \\\n -d '{\"contact_date\":\"2018-10-08\"}'\n```\n\nReturns:\n\n```python\n{\n \"data\": {\n \"doctype\": \"Lead\",\n \"name\": \"LEAD-00001\",\n \"contact_date\": \"2018-10-08\",\n \"...\": \"...\"\n }\n}\n```\n\n### DELETE /api/resource/{DocType}/{DocumentName}\n\nParams (in path):\n\n* DocType (string)\n\nThe type of the document you'd like to delete. For example, 'Customer'.\n\n* DocumentName (string)\n\nThe name (ID) of the document you'd like to delete. For example, 'EMP-00001'.\n\n### Further Reading\n\nHTTP Headers:\n\n* [Content-Type](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type)\n* [Accept](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept)\n* [Authorization](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization)\n\nAuthor: Raffael Meyer (raffael@alyf.de)", "content_type": "mixed", "has_code": true, "token_count": 364}
{"chunk_id": "08_auth_integration__integration__razorpay__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/razorpay", "title": "Razorpay", "section_heading": "Integrating Razorpay Client Checkout", "content": "## Integrating Razorpay Client Checkout\n\nRazorpay is a popular payments solution in India which allows businesses to accept, process and disburse payments with its product suite. It gives you access to payment methods like Credit Cards, Debit Cards and Netbanking.\n\n### Integrating Razorpay Client Checkout\n\nRazorpay Payment\n\n### Include checkout script in your code\n\nInsert the following script on your page `<script type=\"text/javascript\" src=\"/assets/js/checkout.min.js\"></script>`\nThe checkout script automatically fetches the razorpay checkout script and wraps their API for some syntactic sugar.\n\n### Create the Order controller in your backend\n\n```python\ndef get_razorpay_order(self):\n controller = get_payment_gateway_controller(\"Razorpay\")\n\n payment_details = {\n \"amount\": 30000,\n ...\n \"reference_doctype\": \"Conference Participant\",\n \"reference_docname\": self.name,\n ...\n \"receipt\": self.name\n }\n\n return controller.create_order(**payment_details)\n```", "content_type": "mixed", "has_code": true, "token_count": 240}
{"chunk_id": "08_auth_integration__integration__razorpay__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/razorpay", "title": "Razorpay", "section_heading": "Inititate the payment in client using checkout API", "content": "## Inititate the payment in client using checkout API\n\n```python\nfunction make_payment(ticket) {\n var options = {\n \"name\": \"<CHECKOUT MODAL TITLE>\",\n \"description\": \"<CHECKOUT MODAL DESCRIPTION>\",\n \"image\": \"<CHECKOUT MODAL LOGO>\",\n \"prefill\": {\n \"name\": \"<CUSTOMER NAME>\",\n \"email\": \"<CUSTOMER EMAIL>\",\n \"contact\": \"<CUSTOMER PHONE>\"\n },\n \"theme\": {\n \"color\": \"<MODAL COLOR>\"\n },\n \"doctype\": \"<REFERENCE DOCTYPE>\", // Mandatory\n \"docname\": \"<REFERENCE DOCNAME\" // Mandatory\n };\n\n razorpay = new frappe.checkout.razorpay(options)\n razorpay.on_open = () => {\n // SCRIPT TO RUN WHEN MODAL OPENS\n }\n razorpay.on_success = () => {\n // SCRIPT TO RUN ON PAYMENT SUCCESS\n }\n razorpay.on_fail = () => {\n // SCRIPT TO RUN ON PAYMENT FAILURE\n }\n razorpay.init() // Creates the order and opens the modal\n}\n```\n\n### Lifecycle\n\n1. **Create an Order in your backend**\n\nAn order is first created at the server triggered by `razorpay.init()`, for this a controller `get_razorpay_order` must be created for the doctype. The server method sets the amount to be charged and a unique receipt id for razorpay APIs to consume.\n\nThe `get_razorpay_order` internally calls the create\\_order controller of razorpay settings doctype. which then creates an integration request and sends POST request to `https://api.razorpay.com/v1/orders`\n\n1. **Process Checkout at Client**\n\nA successful creation of the Order returns the `order_id` that is stored against the Order in integration request. This `order_id` is passed to the client which triggers the razorpay modal. After the payment, depending on the status the success or fail API method is called and the payment ID is passed to it.\n\n1. **Verify the payment**\n\nOnce the API method is called, The transaction details are saved in integration request. If successful the `authorize_payment` controller is called, which checks the payment status from razorpay API using the Payment ID. Once authorized, the integration request is marked as Completed, following this the payment success hook of the reference\\_doctype is called.\n\nYou can read more about Razorpay custom checkout in their [documentation](https://razorpay.com/docs/payment-gateway/web-integration/custom/)", "content_type": "mixed", "has_code": true, "token_count": 547}
{"chunk_id": "08_auth_integration__integration__google_drive__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/google_drive", "title": "Google Drive", "section_heading": "Google Cloud Console", "content": "## Google Cloud Console\n\nGoogle Drive is a file storage and synchronization service developed by Google. It allows users to store, synchronize and share files. Google Drive is a key component of Google Workspace, Google's monthly subscription offering for businesses.\n\nYou can use Frappe Framework's file picker to select any file from Google Drive and attach it to the current DocType. For example, you can attach the invoice PDF stored in Google Drive to a Sales Invoice record in your Frappe app.\n\n### Google Cloud Console\n\nFirst we need to get some credentials that will allow us to access Google Drive. You can [use the setup tool](https://console.cloud.google.com/flows/enableapi?apiid=picker&credential=client_key), which guides you through creating a project in the Google Cloud Console, enabling the API, and creating credentials.\n\nIf you haven't done so already, create your application's API key by clicking **Create credentials > API key**. Next, look for your API key in the **API keys** section. You can open the API Key and restrict it.\n\n1. Under **Application restrictions** choose \"HTTP referrers\",\n2. under **Website restrictions** add your frappe instance's hostname and\n3. under **API restrictions** choose \"Restrict key\" and select the \"Google Picker API\".\n\n![API Key configuration](/files/google_drive_picker_api_key.png)\n\nIf you haven't done so already, create your OAuth 2.0 credentials by clicking **Create credentials > OAuth client ID**.\n\n1. Under **Application type** choose \"Web application\" and\n2. under **Authorized JavaScript origins** add your frappe instance's hostname.\n\n![OAuth Client configuration](/files/google_drive_picker_oauth_client.png)\n\nAfter you've created the credentials, you can see your client ID on the [Credentials page](https://console.cloud.google.com/apis/credentials).\n\nLast but not least you need to configure the [OAuth Consent Screen](https://console.cloud.google.com/apis/credentials/consent). This is the page that users will see when they are using the Google Drive Picker for the first time. It asks them to grant access to their Google Drive. You can configure this as you like, just take care to add the scope `https://www.googleapis.com/auth/drive.readonly` on the **Scopes** page.\n\nYou will also need your App ID at hand. This is your project number which you can find under **IAM & Admin > Settings**.\n\n> Portions of this section are modifications based on work created and [shared by Google](https://developers.google.com/picker/docs) and used according to terms described in the [Creative Commons 4.0 Attribution License](https://creativecommons.org/licenses/by/4.0/).", "content_type": "prose", "has_code": false, "token_count": 659}
{"chunk_id": "08_auth_integration__integration__google_drive__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/google_drive", "title": "Google Drive", "section_heading": "Frappe instance", "content": "## Frappe instance\n\nNow that the Google Picker API is enabled and we have the necessary credentials we can go ahead and configure the **Google Settings** in you Frappe instance.\n\n1. Open **Google Settings**.\n2. Check the \"Enable\" checkbox.\n3. In the **Google Drive Picker** section, check the \"Google Drive Picker Enabled\" checkbox.\n4. Enter your App ID, Client ID and API Key.\n5. Save the **Google Settings** and reload your browser window.\n\n![Google Settings](/files/google_drive_picker_settings.png)\n\nNow when you click \"Attach file\" in the sidebar you should see the Google Drive icon.\n\n![Attach File Dialog](/files/google_drive_picker_attach_file.png)\n\nIf you click on it the first time you have to authorize the Frappe app to access your Google Drive files.\n\n![Google Sign In](/files/google_drive_picker_signin.png)\n\nThen the Google Drive Picker opens where you can choose a file.\n\n![Google Drive Picker](/files/google_drive_picker_select.png)\n\nClick the blue button on the bottom left to attach a link to this file to the current DocType.\n\n![File Attached to DocType](/files/google_drive_picker_attached.png)\n\n> In case you're looking for technical details, Google Drive was introduced in [Pull Request #12715](https://github.com/frappe/frappe/pull/12715).", "content_type": "prose", "has_code": false, "token_count": 315}
{"chunk_id": "08_auth_integration__integration__ldap-integration__001", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1. Configuring", "content": "## 1. Configuring\n\nLightweight Directory Access Protocol (LDAP) is an object directory that is commonly used for centralized authentication, commonly known as Single Sign on (SSO). Many small through to large-scale organizations have an LDAP implementation.\n\nBy setting up the LDAP Integration within Frappe, you will able to login to your frappe app by using your LDAP credentials.\n\n### 1. Configuring\n\nMany of the fields that are on the LDAP Settings page are mandatory. These fields will be easily distinguished below by being in **bold** font.\n\nWhen configuring LDAP Settings, and the 'enabled' check box is checked. Frappe will validate the data you have entered into the fields. If any appear to be invalid, the settings won't save and you will be presented with an error message. Once you have corrected any errors, you will be able to successfully enable LDAP authentication.\n\nThe LDAP Settings configuration page has been broken down into smaller sections. Please see the headings below, on how to configure each section.\n\nTo setup LDAP, Navigate to:\n\n> Home > Integrations > LDAP Settings\n\n| :memo: *Reminder* |\n| --- |\n| *Don't forget to 'check' the enable box at the top of the page once you have entered your settings into the configuration page.* |", "content_type": "prose", "has_code": false, "token_count": 315}
{"chunk_id": "08_auth_integration__integration__ldap-integration__002", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1.1 LDAP Server", "content": "## 1.1 LDAP Server\n\nFrappe has been tested with both OpenLDAP and Active Directory. However any standards compliant LDAP Directory could be used as the LDAP authentication source.\n\n* **LDAP Directory Server**: *(drop-down)* Select the option that matches your LDAP Directory. Available options are:\n\n*Active Directory* for Microsoft Active Directory\n\n*OpenLDAP* for OpenLDAP\n\n*Custom* Select this option if you need to adjust the LDAP Group attributes. i.e. your setup for LDAP groups are `groupofnames` or `uniquegroupofnames` etc\n\n* **LDAP Server URL**: This is the URL to your LDAP Server. Must be in the form of `ldap://yourserver:port` or `ldaps://yourserver:port`\n\n### 1.2 LDAP Authentication\n\nThis section contains the details of the user that will bind to the directory server.\n\n* **Base Distinguished Name (DN)**: This is the user that will bind to LDAP. This user requires permission to view the search paths that you enter below.\n* **Password for Base DN**: This is the password for the user above, that is used to look up user details on your LDAP server.", "content_type": "prose", "has_code": false, "token_count": 266}
{"chunk_id": "08_auth_integration__integration__ldap-integration__003", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1.3 LDAP Search Paths", "content": "## 1.3 LDAP Search Paths\n\nThis section is the searh paths for each of the LDAP Directory objects. Any LDAP container object path can be used as long as it is in LDAP FDN (Full Distinguished Name) format. *i.e. ou=my frappe objects,dc=example,dc=com*. Any paths provided here require that the bind user has access to read and write to.\n\n> Write access is required for the bind user so that end users can reset their passwords.\n\n* **LDAP search path for Users**: This is the search path that all users in your LDAP server must be part of to be able to log into a frappe app.\n* **LDAP search path for Group**: This is the search path that all groups in your LDAP server must be part of to be able to log into a frappe app.\n* **LDAP Search String**: This field allows frappe to match the user/email entered in the frappe login screen, with the LDAP Server. For example, you could use email address, or username depending on your preference.\n\nYou can use complex LDAP search filters here as long as they contain the login name placeholder `{0}` and are enclosed in braces `()`. This is placed inside the search filter where you would like to match the login name. Any filter the [ldap3 python module](https://ldap3.readthedocs.io/en/latest/searches.html#the-ldap-filter) and that your LDAP directory supports should work. examples include:\n\n`(uid={0})`\n\n`(SamAccountName={0})` - *(Active Directory)*\n\n`(&(description=*ACCESS:Frappe*)(uid={0})` - *using a filter description in OpenLDAP allows filtering similar to Active Directories `memberOf` as it will only select users who have `ACCESS:Frappe` in the description field.*\n\n`(&(SamAccountName={0})(memberof=cn=Domain Users,ou=Groups,DC=example,dc=com))` - *(Active Directory)*", "content_type": "prose", "has_code": false, "token_count": 430}
{"chunk_id": "08_auth_integration__integration__ldap-integration__004", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1.4 LDAP User Creation and Mapping", "content": "## 1.4 LDAP User Creation and Mapping\n\nThis section contains the LDAP attributes that will be read from the directory server to map against the frappe user.\n\n* **LDAP Email Field**: Specifies the LDAP attribute that contains the email address of the user. `mail` is the common LDAP attribute to use.\n* **LDAP Username Field**: Specifies the LDAP attribute that contains the username of the user. `sAMAccountName` for Active Directory and `uid` for OpenLDAP.\n* **LDAP First Name Field**: Specifies the LDAP field that contains the first name of the user. `givenName` or `sn` is commonly used.\n\nThere are many other non-mandatory LDAP attributes that you can use to map to the frappe user. They are:\n\n* Middle Name\n* Phone\n* Mobile\n\n> **SECURITY WARNING** Understand that if you use the LDAP attribute `mail` for the username field, that this may cause security implications. `mail` is not a unique value within LDAP. Enabling `mail` attribute to be used for login purposes is outside of the scope of this documentation. Please consult your directory server documentation on how to do this.", "content_type": "prose", "has_code": false, "token_count": 272}
{"chunk_id": "08_auth_integration__integration__ldap-integration__005", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1.5 LDAP Security", "content": "## 1.5 LDAP Security\n\nThis section is optional. However if you would like to configure a secure connection to your directory server, this where you enter the TLS connection details.\n\n* In the LDAP Settings area, there are two dropdowns.\n\n1. SSL/TLS Mode - set this to **StartTLS** to connect to your LDAP server using StartTLS. If your LDAP server does not support StartTLS, setting this to StartTLS will result in an error `StartTLS is not supported`. Check the configuration on your LDAP server if you receive this error.\n2. Require Trusted Certificate - if you change this to\n\n`Yes` then the certificate provided by the LDAP server must be trusted by the Frappe server.\n\n`No` it is not recommended to use this setting as it bypasses ensuring the certificate is signed by a trusted certificate authority.\n\nIf you would rather use StartTLS with a self-signed (untrusted) certificate, set this to **No**. If you do not use StartTLS, this setting is ignored.\n\n* SSL/TLS Mode\n  Specifies whether you want to start a TLS session on initial connection to the LDAP server.\n* Require Trusted Certificate\n  Specifies if you require a trusted certificate to connect to the LDAP server\n\nIf you are specifying a trusted certificate, you will need to specify the paths to your certificate files. These files are to be placed on your frappe server, and the following fields should be an absolute path to the files on your server.\nThe certificate fields are:\n\n* Path to private Key File\n* Path to Server Certificate\n* Path to CA Certs File\n\n> To configure your Frappe Instance to accept certificates signed by your own 'Certificate Authority' or a 'self-signed certificate', please consult your Operating Systems documentation on how to add a 'Certificate Authority' / 'self-signed' certificate to your 'Trusted Certificates store.'", "content_type": "prose", "has_code": false, "token_count": 454}
{"chunk_id": "08_auth_integration__integration__ldap-integration__006", "module": "08_auth_integration", "source_url": "https://docs.frappe.io/framework/v15/user/en/integration/ldap-integration", "title": "Ldap Integration", "section_heading": "1.6 LDAP Custom Directory", "content": "## 1.6 LDAP Custom Directory\n\nThis section is **mandatory if you select custom** directory server. There are only two options available here and they pertain to the groups that your directory server uses. They are:\n\n* **\\_Group Object Class\\_** This is the object class of the groups within your directory server.\n* **\\_Group Member Attribute\\_** This is the LDAP Attribute within the group that contains the common name (CN) of the user.\n* **\\_Custom Group Search\\_** This can be used to specify a custom LDAP Custom Group Search which is necessary for some LDAP providers.\n\n### 1.7 LDAP Group Mapping\n\nThis section contains the details for mapping the LDAP Groups. Any group the user is a member of will be mapped to the specified frappe role(s).\n\n> Frappe Feature: if you have configured group mapping. Each time a user logs on, their roles are checked and added/removed as required.\n\n* **Default Role on Creation**: When the user is created in your frappe app, they will be assigned with this default role.\n* **LDAP Group Mappings Table** You can map mutiple LDAP groups to Frappe roles. Entry of the LDAP group must match the LDAP `cn` attribute. *i.e. 'Domain Users'* not *'cn=Domain Users,ou=Groups,dc=example,dc=com'* which is a LDAP FDN entry.\n\n*Example*\n\n| No | LDAP Group | Role |\n| --- | --- | --- |\n| 1 | Domain Users | Guest |\n| 2 | Domain Administrators | Administrator |\n\n* LDAP Group Field *(depreciation WARNING)* This is the LDAP Attribute within the user LDAP object that contains the list of groups the user is a member of. If you have configured all of the settings as per above, this setting will have no effect. This field exists purely for those who configured LDAP prior to the current layout. This field will be removed in a future version of Frappe.\n\n### 2. Log in to frappe with LDAP\n\nAfter setting up and enabling LDAP, on the login screen, the system enables **Login Via LDAP** option.\n\n![Log into frappe](/files/login_via_ldap.png)\n*Figure 1. Frappe app login screen when LDAP has been configured and enabled.*\n\n### 3. Troubleshooting\n\n> ToDo: is this section needed?", "content_type": "prose", "has_code": false, "token_count": 524}
