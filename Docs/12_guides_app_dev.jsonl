{"chunk_id": "12_guides_app_dev__guides__app-development__custom_action_link_field__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/custom_action_link_field", "title": "Custom Action Link Field", "section_heading": "1. Adding Custom Option", "content": "## 1. Adding Custom Option\n\nYou can add a new custom link option to the standard link field by defining the function in the namespace `frappe.ui.form.ControlLink.link_options`.\n\nIn the `frappe.ui.form.ControlLink.link_options`, you have access to the link field object.\n\n### 1. Adding Custom Option\n\n```python\nfrappe.ui.form.ControlLink.link_options = function(link) {\n return [\n {\n html: \"\"\n + \" \"\n + __(\"Custom Link Option\")\n + \"\",\n label: __(\"Custom Link Option\"),\n value: \"custom__link_option\",\n action: () => {}\n }\n ];\n}\n```\n\nOnce a function is assigned to `frappe.ui.form.ControlLink.link_options`, the link field will have a new link option:\n\n![182354398 c1fc9f55 4464 4683 bb74 982ec2546f71](https://user-images.githubusercontent.com/7310479/182354398-c1fc9f55-4464-4683-bb74-982ec2546f71.png)", "content_type": "mixed", "has_code": true, "token_count": 200}
{"chunk_id": "12_guides_app_dev__guides__app-development__executing-code-on-doctype-events__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/executing-code-on-doctype-events", "title": "Executing Code On Doctype Events", "section_heading": "1. Controller Module", "content": "## 1. Controller Module\n\nTo execute code when a DocType is inserted, validated (before saving), updated, submitted, cancelled, deleted, you must write in the DocType's controller module.\n\n### 1. Controller Module\n\nThe controller module exists in the `doctype` folder in the Module of the `DocType`. For example, the controller for **ToDo** exists in `frappe/desk/doctype/todo/todo.py` (version 5). A controller template is created when the DocType is created. which looks like\n\nfrom \\_\\_future\\_\\_ import unicode\\_literals\n\nimport frappe\nfrom frappe.model.document import Document\n\nclass CustomType(Document):\npass\n\n### 2. Document Properties\n\nAll the fields and child tables are available to the class as attributes. For example the **name** property is `self.name`\n\n### 3. Adding Methods\n\nIn this module, you can add standard methods to the class that are called when a document of that type is created. Standard Handlers are:\n\n1. `autoname`: Called while naming. You can set the `self.name` property in the method.\n2. `before_insert`: Called before a document is inserted.\n3. `validate`: Called before document is saved. You can throw an exception if you don't want the document to be saved\n4. `on_update`: Called after the document is inserted or updated in the database.\n5. `on_submit`: Called after submission.\n6. `on_cancel`: Called after cancellation.\n7. `on_trash`: Called after document is deleted.", "content_type": "prose", "has_code": false, "token_count": 352}
{"chunk_id": "12_guides_app_dev__guides__app-development__how-to-improve-a-standard-control__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/how-to-improve-a-standard-control", "title": "How To Improve A Standard Control", "section_heading": "", "content": "Frappe has a couple of elegant and useful widgets, but some times we need to edit them to add small improvements. This small article will describe how to add new resources to the standard widgets.\n\nLet me explain first our goal:\n\n> Add `many` alternative translations in `numerous records` and in a `lot of doctypes`\n\nLook the highlighted sections in the \\_\\_goal\\_\\_, we have \\_many translations\\_ to add in \\_many records\\_ and in \\_many doctypes\\_, so, we heave a **many of work**, so we have a lot to do right?\n\nThe answer for this question is: \\_-Of course not! Because we know that if one element exists in many records and in many doctypes, this element is the `Control` or `Widget`\\_\n\nSo, what we need do, is improve your goal based on the `Control`, to reduce our quantity of work.\n\nBut, where will we find this magic element, the control? \\_-For now, we can look it in the JavaScript sources - let's look now at [Github](https://github.com/frappe/frappe/blob/develop/frappe/public/js/frappe/form/controls/control.js)\\_\n\n> Don't worry if you don't understand the code for now, our goal there is simplify our work.\n\nLet's go ahead with the thought!\n\nWe know where we need to make the changes, but how will we dismember which are the controls that are affected by our feature and which aren't ?\n\nWe need to keep in mind, that `Control` are instance of `DocFields` and the `DocFields` have a field that is very important for us in this case, the field that will help us to dismember which are affected by our feature and which aren't is the field `options` in the `DocField`.\n\n\\_-Wait!, we understood that the field `options` can help us, but, how will it help us?\\_\n\nGood question, we will define a word to put in the `options` of the `DocFields` that we need to include the feature, this world will be **`Translatable`.**\n\n> If you forget how to customize the options of a field look [this article](https://kb.erpnext.com/kb/customize/creating-custom-link-field), it can refresh your knowledge.\n\nWell, with the defined word in `options` of our selected `DocFields`, now is time to code:\n\n\\_-At last, we think we would never stop talking!\\_", "content_type": "prose", "has_code": false, "token_count": 536}
{"chunk_id": "12_guides_app_dev__guides__app-development__how-to-improve-a-standard-control__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/how-to-improve-a-standard-control", "title": "How To Improve A Standard Control", "section_heading": "", "content": "```python\n frappe.ui.form.ControlData = frappe.ui.form.ControlData.$extend({\n make_input: function(){\n var options = this.df.options;\n if (!options || options!==\"Translatable\"){\n this._super();\n return;\n }\n var me = this;\n $('\\\n \\\n \\\n \\\\\n \\\n ').prependTo(this.input_area);\n this.$input_area = $(this.input_area);\n this.$input = this.$input_area.find('input');\n this.$btn = this.$input_area.find('.dialog-btn');\n this.set_input_attributes();\n this.$input.on(\"focus\", function(){\n me.$btn.toggle(true);\n });\n this.$input.on(\"blur\", function(){\n setTimeout(function(){ me.$btn.toggle(false) }, 500);\n });\n this.input = $this.input.get(0);\n this.has_input = true;\n var me = this;\n this.setup_button();\n },\n setup_button: function(){\n var me = this;\n if (this.only_input){\n this.$btn.remove();\n return;\n }\n this.$btn.on(\"click\", function(){\n var value = me.get_value();\n var options = me.df.options;\n if (value && options && options===\"Translatable\"){\n this.open_dialog();\n }\n });\n },\n open_dialog: function(){\n if (this.frm && !this.frm.is_dirty()) {\n new frappe.ui.form.TranslationSelector({\n doc: doc,\n df: this.doc,\n text: this.value\n });\n }\n }\n });\n```\n\n\\_-Other letter soup, for my gosh!\\_\n\nIn fact, it IS a soup of letters, for a newbie, but we are not a beginner.\n\nLet me explain what this code does;\n\n* At line 1 the code overrides the `ControlData` by one extended `Class` of itself.\n* The method `make_input` checks if the docfield is **`Translatable`** to make the new `Control` if not, it calls the *original* `make_input` using `_super()`\n* The method `setup_button` checks if the docfield is **`Translatable`** to enable it show a `dialog`\n* The method `open_dialog` invokes a new instance of the `TranslationSelector` that we will create in the code below.", "content_type": "mixed", "has_code": true, "token_count": 441}
{"chunk_id": "12_guides_app_dev__guides__app-development__running-background-jobs__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/running-background-jobs", "title": "Running Background Jobs", "section_heading": "", "content": "Sometimes you may not want a user request to be executed immediately but added to a queue that will be executed by a background worker. The advantage of doing this is that your web workers remain free to execute other requests and longer jobs do not eat up all of your resources.\n\nFrappe uses Python RQ to run background jobs. The following example illustrates how you can enqueue a job:\n\n```python\nimport frappe\n\ndef long_job(arg1, arg2):\n frappe.publish_realtime('msgprint', 'Starting long job...')\n # this job takes a long time to process\n frappe.publish_realtime('msgprint', 'Ending long job...')\n\ndef enqueue_long_job(arg1, args2):\n frappe.enqueue('myapp.mymodule.long_job', arg1=arg1, arg2=arg2)\n```\n\nThis will enqueue `long_job` to the queue `default`. Other available queues are `long` and `short`. You should choose the appropriate queue based on how long you estimate your enqueued job to execute.\n\nStarting Version 14, you can also enqueue jobs at front of the queue by passing `at_front` as `True` in your enqueue call.", "content_type": "mixed", "has_code": true, "token_count": 257}
{"chunk_id": "12_guides_app_dev__guides__app-development__running-background-jobs__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/running-background-jobs", "title": "Running Background Jobs", "section_heading": "Called delayed actions on Document objects", "content": "## Called delayed actions on Document objects\n\nYou can also called delayed actions on document objects, for example in Stock Reconciliation if there are more than 100 items, it is executed as a background job.\n\nExample: you can call `doc.queue_action('submit')`\n\nNote: This only works for `save`, `submit`, `cancel`\n\nYou can also push certain actions to the background if you anticipate the execution is very large.\n\nFor example:\n\ndef submit(self):\nif len(self.items) > 100:\nself.queue\\_action('submit')\nelse:\nself.\\_submit()\n\n### Debugging\n\nIf you are on `bench start`\n\nYou will see logs in your terminal.\n\nNote: default worker does not auto restart, so you will have to kill bench and start again after you make changes.", "content_type": "prose", "has_code": false, "token_count": 180}
{"chunk_id": "12_guides_app_dev__guides__app-development__adding-custom-button-to-form__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/adding-custom-button-to-form", "title": "Adding Custom Button To Form", "section_heading": "Function Signature for `add_custom_button(...)`", "content": "## Function Signature for `add_custom_button(...)`\n\nTo create a custom button on your form, you need to edit the javascript file associated to your doctype. For example, If you want to add a custom button to User form then you must edit `user.js`.\n\nIn this file, you need to write a new method `add_custom_button` which should add a button to your form.\n\n### Function Signature for `add_custom_button(...)`\n\nfrm.add\\_custom\\_button(\\_\\_(buttonName), function(){\n//perform desired action such as routing to new form or fetching etc.\n}, \\_\\_(groupName));\n\n### Example-1: Adding a button to User form\n\nWe should edit `frappe\\core\\doctype\\user\\user.js`\n\nfrappe.ui.form.on('User', {\nrefresh: function(frm) {\n...\nfrm.add\\_custom\\_button(\\_\\_('Get User Email Address'), function(){\nfrappe.msgprint(frm.doc.email);\n}, \\_\\_(\"Utilities\"));\n...\n}\n});\n\nYou should be seeing a button on user form as shown below,\n\n![Custom Button](/files/add_custom_button.png)", "content_type": "prose", "has_code": false, "token_count": 236}
{"chunk_id": "12_guides_app_dev__guides__app-development__trigger-event-on-deletion-of-grid-row__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/trigger-event-on-deletion-of-grid-row", "title": "Trigger Event On Deletion Of Grid Row", "section_heading": "", "content": "To trigger an event when a row from a Child Table has been deleted (when user clicks on `delete` button), you need to add a handler the `fieldname_remove` event to Child Table, where fieldname is the fieldname of the Child Table in Parent Table declaration.\n\nFor example:\n\nAssuming that your parent DocType is named `Item` has a Table Field linked to `Item Color` DocType with decloration name `color`.\n\nIn order to \"catch\" the delete event:\n\n```python\nfrappe.ui.form.on('Item Color', {\n color_remove: function(frm) {\n // You code here\n // If you console.log(frm.doc.color) you will get the remaining color list\n }\n);\n```\n\nThe same process is used to trigger the add event (when user clicks on `add row` button):\n\n```python\nfrappe.ui.form.on('Item Color', {\n color_remove: function(frm) {\n // You code here\n // If you console.log(frm.doc.color) you will get the remaining color list\n },\n color_add: function(frm) {}\n});\n```\n\nNotice that the handling is be made on Child DocType Table `form.ui.on` and not on Parent Doctype so a minimal full example is:\n\n```python\nfrappe.ui.form.on('Item',{\n // Your client side handling for Item\n});\n\nfrappe.ui.form.on('Item Color', {\n color_remove: function(frm) {\n // Deleting is triggered here\n }\n);\n```\n\nHandlers are:\n\n1. fieldname\\_add\n2. fieldname\\_move\n3. fieldname\\_before\\_remove\n4. fieldname\\_remove", "content_type": "mixed", "has_code": true, "token_count": 335}
{"chunk_id": "12_guides_app_dev__guides__app-development__dialogs-types__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/dialogs-types", "title": "Dialogs Types", "section_heading": "Alert Dialog", "content": "## Alert Dialog\n\nFrappe provides a group of standard dialogs that are very useful while coding.\n\n### Alert Dialog\n\n![](/files/show-alert.png)\n\nAlert Dialog is used for showing non-obstructive messages.\n\nIt has 2 parameters:\n\n* **txt:** The message to be shown in the `Alert Dialog`\n* **seconds:** The duration that the message will be displayed. The default is `3 seconds`.\n\n### Example\n\nshow\\_alert('Hi, do you have a new message', 5);\n\n---\n\n### Prompt Dialog\n\n![](/files/prompt.png)\n\nPrompt Dialog is used for collecting data from users.\n\nIt has 4 parameters:\n\n* **fields:** a list with the fields objects\n* **callback:** a function to process the data in the dialog\n* **title:** the title of the dialog\n* **primary\\_label:** the label of the primary button\n\n### Example\n\nfrappe.prompt([\n{'fieldname': 'birth', 'fieldtype': 'Date', 'label': 'Birth Date', 'reqd': 1}\n],\nfunction(values){\nshow\\_alert(values, 5);\n},\n'Age verification',\n'Subscribe me'\n)\n\n---\n\n### Confirm Dialog\n\n![](/files/confirm-dialog.png)\n\nConfirm Dialog is used to get a confirmation from the user before executing an action.\n\nIt has 3 arguments:\n\n* **mesage:** The message to display in the dialog\n* **onyes:** The callback on positive confirmation\n* **oncancel:** The callback on negative confirmation\n\n### Example\n\nfrappe.confirm(\n'Are you sure to leave this page?',\nfunction(){\nwindow.close();\n},\nfunction(){\nshow\\_alert('Thanks for continue here!')\n}\n)\n\n---\n\n### Message Print\n\n![](/files/msgprint.png)\n\nMessage Print is used for showing information to users.\n\nIt has 2 arguments:\n\n* **message:** The message to display. It can be a HTML string\n* **title:** The title of the dialog\n\n### Example\n\nmsgprint(\"**Server Status**\"\n\n* \"\n\n---\n\n\"\n\n* \"\"\n* \"\\* **28%** Memory\n  \"\n* \"\\* **12%** Processor\n  \"\n* \"\\* **0.3%** Disk\n  \"\n* \"\n  \", 'Server Info')\n\n---\n\n### Custom Dialog\n\n![](/files/dialog.png)\n\nYou can extend and build your own custom dialogs using `frappe.ui.Dialog`\n\n### Example\n\nvar d = new frappe.ui.Dialog({\n'fields': [\n{'fieldname': 'ht', 'fieldtype': 'HTML'},\n{'fieldname': 'today', 'fieldtype': 'Date', 'default': frappe.datetime.nowdate()}\n],\nprimary\\_action: function(){\nd.hide();\nshow\\_alert(d.get\\_values());\n}\n});\nd.fields\\_dict.ht.$wrapper.html('Hello World');\nd.show();", "content_type": "prose", "has_code": false, "token_count": 565}
{"chunk_id": "12_guides_app_dev__guides__app-development__overriding-link-query-by-custom-script__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/overriding-link-query-by-custom-script", "title": "Overriding Link Query By Custom Script", "section_heading": "1. Adding Filters", "content": "## 1. Adding Filters\n\nYou can override the standard link query by using `set_query` via the Client Script DocType from the desk.\n\nThe `set_query` method takes one of two formats: `set_query(field_name, options_function())` for regular fields, or `set_query(field_name, child_table_name, options_function())` for fields in child tables.\n\n### 1. Adding Filters\n\nYou can add filters to the query:\n\n```python\nfrappe.ui.form.on(\"Bank Reconciliation\", \"onload\", function(frm) {\n frm.set_query(\"bank_account\", function() {\n return {\n \"filters\": {\n \"account_type\": \"Bank\",\n \"group_or_ledger\": \"Ledger\"\n }\n };\n });\n});\n```\n\nA more complex query:\n\n```python\nfrappe.ui.form.on(\"Bank Reconciliation\", \"onload\", function(frm){\n frm.set_query(\"bank_account\", function(){\n return {\n \"filters\": [\n [\"Bank Account\", \"account_type\", \"=\", \"Bank\"],\n [\"Bank Account\", \"group_or_ledger\", \"!=\", \"Group\"]\n ]\n }\n });\n});\n```\n\n---\n\n### 2. Calling a Different Method to Generate Results\n\nYou can also set a server side method to be called on the query:\n\n```python\nfrm.set_query(\"item_code\", \"items\", function() {\n return {\n query: \"erpnext.controllers.queries.item_query\",\n filters: frm.doc.enquiry_type === \"Maintenance\" ?\n {\"is_service_item\": \"Yes\"} : {\"is_sales_item\": \"Yes\"}\n };\n});\n```", "content_type": "mixed", "has_code": true, "token_count": 315}
{"chunk_id": "12_guides_app_dev__guides__app-development__overriding-link-query-by-custom-script__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/overriding-link-query-by-custom-script", "title": "Overriding Link Query By Custom Script", "section_heading": "Custom Method", "content": "## Custom Method\n\nThe custom method should return a list of items for auto select. If you want to send additional data, you can send multiple columns in the list.\n\nParameters to the custom method are:\n\n```python\ndef custom_query(doctype, txt, searchfield, start, page_len, filters)\n```\n\n**Example:**\n\n```python\n# searches for leads which are not converted\n@frappe.whitelist()\n@frappe.validate_and_sanitize_search_inputs\ndef lead_query(doctype, txt, searchfield, start, page_len, filters):\n return frappe.db.sql(\"\"\"\n SELECT name, lead_name, company_name\n FROM `tabLead`\n WHERE docstatus < 2\n AND ifnull(status, '') != 'Converted'\n AND ({key} LIKE %(txt)s\n OR lead_name LIKE %(txt)s\n OR company_name LIKE %(txt)s)\n {mcond}\n ORDER BY\n IF(LOCATE(%(_txt)s, name), LOCATE(%(_txt)s, name), 99999),\n IF(LOCATE(%(_txt)s, lead_name), LOCATE(%(_txt)s, lead_name), 99999),\n IF(LOCATE(%(_txt)s, company_name), LOCATE(%(_txt)s, company_name), 99999),\n name, lead_name\n LIMIT %(start)s, %(page_len)s\n \"\"\".format(**{\n 'key': searchfield,\n 'mcond':get_match_cond(doctype)\n }), {\n 'txt': \"%{}%\".format(txt),\n '_txt': txt.replace(\"%\", \"\"),\n 'start': start,\n 'page_len': page_len\n })\n```\n\n**Note:** `@frappe.whitelist()` is used to expose `lead_query` to the client-side\nand `@frappe.validate_and_sanitize_search_inputs` decorator is used to validate and sanitize user inputs sent through API or client-side request to avoid possible SQLi.\n\nFor more examples see:\n\n<https://github.com/frappe/erpnext/blob/develop/erpnext/controllers/queries.py>", "content_type": "mixed", "has_code": true, "token_count": 381}
{"chunk_id": "12_guides_app_dev__guides__app-development__connected-app__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/connected-app", "title": "Connected App", "section_heading": "", "content": "You can use **Connected App** to allow your frappe instance to access other web services on your behalf.\n\n> This example shows how to connect to Google, but you can use any service supporting OAuth 2.0.\n\nFirst, create a new **Connected App** and give it a name. You can already enter the desired scopes and endpoint URIs, if you wish.\n\nScopes describe what information can be accessed. The Authorization URI is where you will be redirected to give your consent. The Token URI is the endpoint where the system can exchange an authorization code for an access or refresh token. Please check the documentation of the specific integration or third party service to get the right values.\n\n> To automatically populate all the URI fields, enter the `openid_configuration` endpoint of any provider and click \"Get OpenID Configuration\". For example, Google's OpenID configuration can be found at `https://accounts.google.com/.well-known/openid-configuration`.\n\n![Create a new Connected App](/files/1-new-connected-app.png)\n\nOnce the **Connected App** has been created, you can see the Redirect URI. (Note that the last part of it is specific to your **Connected App**.)\n\n![Get the redirect URI](/files/2-redirect_uri.png)\n\nCopy the Redirect URI, head to the third party service and create new OAuth 2.0 client credentials. You will need to specify the authorized JavaScript origins and the Redirect URI you just copied. Enter the domain name of your frappe instance as authorized JavaScript origin. On a production server this might be `https://erp.mycompany.com`. For local development you can use something like `http://localhost:8000`.\n\n> It is crucial that the authorized JavaScript origins and the authorized redirect URIs are correct. Otherwise you will not be able to connect.\n\n![Create OAuth 2.0 client credentials](/files/3-get-client-credentials.png)\n\nCopy the client ID and secret from the third party service to your **Connected App** and save. Now you and your users can click on \"Connect to ...\" on the top right. This will open a new browser tab that shows the third party service's consent screen. After this, you will be redirected to your frappe instance.\n\n![Connect to the third party service](/files/4-connect.png)\n\nIn the backend, your server will exchange a code that it obtained during the redirect for a temporary access token. This can then be used to access the third party service on your behalf.", "content_type": "prose", "has_code": false, "token_count": 603}
{"chunk_id": "12_guides_app_dev__guides__app-development__custom-module-icon__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/custom-module-icon", "title": "Custom Module Icon", "section_heading": "", "content": "If you want to create a custom icon for your module, you will have to create an SVG file for your module and set the path to this file in the `desktop/config.py` of your app.\n\nThis icon is loaded via AJAX first time, then it will be rendered.\n\nExample:\n\nfrom frappe import \\_\n\ndef get\\_data():\nreturn {\n\"Frappe Apps\": {\n\"color\": \"orange\",\n\"icon\": \"assets/frappe/images/frappe.svg\",\n\"label\": \\_(\"Frappe.io Portal\"),\n\"type\": \"module\"\n}\n}\n\n> PS: A great place to buy SVG icons for a low cost is the awesome [Noun Project](http://thenounproject.com/)", "content_type": "prose", "has_code": false, "token_count": 136}
{"chunk_id": "12_guides_app_dev__guides__app-development__insert-a-document-via-api__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/insert-a-document-via-api", "title": "Insert A Document Via Api", "section_heading": "1. Insert a ToDo", "content": "## 1. Insert a ToDo\n\nYou can insert documents via a script using the `frappe.get_doc` method\n\n### 1. Insert a ToDo\n\ntodo = frappe.get\\_doc({\"doctype\":\"ToDo\", \"description\": \"test\"})\ntodo.insert()\n\n---\n\n### 2. Insert without the user's permissions being checked:\n\ntodo = frappe.get\\_doc({\"doctype\":\"ToDo\", \"description\": \"test\"})\ntodo.insert(ignore\\_permissions = True)\n\n---\n\n### 3. Submit after inserting\n\ntodo = frappe.get\\_doc({\"doctype\":\"ToDo\", \"description\": \"test\"})\ntodo.insert(ignore\\_permissions=True)\ntodo.submit()\n\n---\n\n### 4. Insert a document on saving of another document\n\nclass MyType(Document):\ndef on\\_update(self):\ntodo = frappe.get\\_doc({\"doctype\":\"ToDo\", \"description\": \"test\"})\ntodo.insert()\n\n---\n\n### 5. Insert a document with child tables:\n\nsales\\_order = frappe.get\\_doc({\n\"doctype\": \"Sales Order\",\n\"company\": \"\\_Test Company\",\n\"customer\": \"\\_Test Customer\",\n\"delivery\\_date\": \"2013-02-23\",\n\"sales\\_order\\_details\": [\n{\n\"item\\_code\": \"\\_Test Item Home Desktop 100\",\n\"qty\": 10.0,\n\"rate\": 100.0,\n\"warehouse\": \"\\_Test Warehouse - \\_TC\"\n}\n]\n})\nsales\\_order.insert()", "content_type": "prose", "has_code": false, "token_count": 271}
{"chunk_id": "12_guides_app_dev__guides__app-development__how-to-create-custom-fields-during-app-installation__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/how-to-create-custom-fields-during-app-installation", "title": "How To Create Custom Fields During App Installation", "section_heading": "", "content": "Your custom app can automatically add **Custom Fields** to DocTypes outside of your app when it is installed to a new site.\n\nTo do this, add the new custom fields that your app requires, using the Frappe web application.\n\nIn your `hooks.py` file, add `\"Custom Fields\"`\n\nfixtures = [\"Custom Field\"]\n\nExport fixtures before you commit your app with:\n\n$ bench --site mysite export-fixtures\n\nThis will create a new folder called `fixtures` in your app folder and a `.csv` or `.json` file will be created with the definition of the custom fields you added.\n\nThis file will be automatically imported when the app is installed in a new site or updated via `bench update`.\n\nNote: You can also add single DocTypes like \"Website Settings\" as fixtures", "content_type": "prose", "has_code": false, "token_count": 185}
{"chunk_id": "12_guides_app_dev__guides__app-development__using-html-templates-in-javascript__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/using-html-templates-in-javascript", "title": "Using Html Templates In Javascript", "section_heading": "Example Template:", "content": "## Example Template:\n\nOften while building javascript interfaces, there is a need to render DOM as an HTML template. Frappe Framework uses John Resig's Microtemplate script to render HTML templates in the Desk application.\n\n> Note 1: In Frappe we use the Jinja-like `{% raw %}{%{% endraw %}` tags to embed code rather than the standard `<%`\n\n> Note 2: Never use single quotes `'` inside the HTML template.\n\nTo render a template,\n\n1. Create a template `html` file in your app. e.g. `address_list.html`\n2. Add it to `build.json` for your app (you can include it in `frappe.min.js` or your own javascript file).\n3. To render it in your app, use `frappe.render(frappe.templates.address_list, {[context]})`\n\n### Example Template:\n\nFrom `erpnext/public/js/templates/address_list.js`\n\nNew Address\n\n{% for(var i=0, l=addr\\_list.length; i<l; i++) { %}\n\n---\n\n[{%= \\\\_\\\\_(\"Edit\") %}](/app/address/{%= addr\\_list[i].name %})\n\n### {%= addr\\\\_list[i].address\\\\_type %}\n\n{% if(addr\\_list[i].is\\_primary\\_address) { %}\n{%= \\_\\_(\"Primary\") %}{% } %}\n{% if(addr\\_list[i].is\\_shipping\\_address) { %}\n{%= \\_\\_(\"Shipping\") %}{% } %}\n\n{%= addr\\_list[i].display %}\n\n{% } %}\n{% if(!addr\\_list.length) { %}\n{%= \\_\\_(\"No address added yet.\") %}\n\n{% } %}", "content_type": "prose", "has_code": false, "token_count": 306}
{"chunk_id": "12_guides_app_dev__guides__app-development__how-enable-developer-mode-in-frappe__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/how-enable-developer-mode-in-frappe", "title": "How Enable Developer Mode In Frappe", "section_heading": "", "content": "When you are in application design mode and you want the changes in your DocTypes, Reports etc to affect the app repository, you must be in **Developer Mode**.\n\nTo enable developer mode, update the `site_config.json` file of your site in the sites folder:\n\n```python\nfrappe-bench/sites/{your site}/site_config.json\n```\n\nInside the `frappe-bench` folder, run\n\n```python\nbench set-config -g developer_mode 1\n```\n\nOR, manually, write `\"developer_mode\": 1` inside the `{ .. }` of `site_config.json`\n\n```python\n{\n  \"developer_mode\": 1,\n  ...\n}\n```\n\nAfter setting developer mode, clear the cache:\n\n```python\nbench --site {your site} clear-cache\n```\n\nSome apps might require additional dependencies to build and test in development mode. Install them using bench:\n\n```python\nbench setup requirements --dev\n```\n\nTo view the full developer options, you must be logged in as the \"Administrator\" user. You also will need to enable the Developer icon in your desktop settings:\n\n```python\nDesk -> User dropdown list -> Set Desktop Icons -> check \"Developer\"\n```", "content_type": "mixed", "has_code": true, "token_count": 262}
{"chunk_id": "12_guides_app_dev__guides__app-development__fetch-custom-field-value-from-master-to-all-related-transactions__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/fetch-custom-field-value-from-master-to-all-related-transactions", "title": "Fetch Custom Field Value From Master To All Related Transactions", "section_heading": "Scenario I: You want to keep this field updated", "content": "## Scenario I: You want to keep this field updated\n\nLet's say, there is a custom field \"GSTIN\" in Supplier, which should be fetched in Purchase Order.\n\n### Scenario I: You want to keep this field updated\n\nIn this scenario, the custom field will be updated automatically based on the value in Supplier when you save the Purchase Order and will be re-updated everytime you save the Purchase Order. Since this field needs to be updated automatically, it overwrites user input. If you want to allow user input, refer to Scenario II.\n\n### Steps:\n\n1. Create a Custom Field **GSTIN** for *Supplier* document with *Field Type* as **Data**.\n   ![](/files/gstin-field-supplier.png)\n2. Create another Custom Field **GSTIN** for *Purchase Order* document, but in this case with *Field Type* as **Read Only** or check **Read Only** checkbox. Set **Fetch From** as `supplier.gstin`.\n\n![](/files/gstin-field-po-s1.png)\n\n1. Go to the user menu and click \"Reload\".\n2. Now, on selection of Supplier in a new Purchase Order, **GSTIN** will be fetched automatically from the selected Supplier.\n\n![](/files/po-gstin-s1.png)\n\n### Scenario II: You want to allow user input if value not found\n\nIn this scenario, the value is fetched from the Supplier the first time the Purchase Order is created. If the value is not found in Supplier, you can enter it manually. The value will only be fetched on saving Purchase Order if the field is empty.", "content_type": "prose", "has_code": false, "token_count": 354}
{"chunk_id": "12_guides_app_dev__guides__app-development__fetch-custom-field-value-from-master-to-all-related-transactions__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/fetch-custom-field-value-from-master-to-all-related-transactions", "title": "Fetch Custom Field Value From Master To All Related Transactions", "section_heading": "Steps:", "content": "## Steps:\n\n1. Create a Custom Field **GSTIN** for *Supplier* document with *Field Type* as **Data**.\n\n![](/files/gstin-field-supplier.png)\n\n1. Create another Custom Field **GSTIN** for *Purchase Order* document with *Field Type* as **Data**. Set **Fetch From** as `supplier.vat_number` and tick the checkbox titled **Fetch If Empty**.\n\n![](/files/gstin-field-po-s2.png)\n\n1. Go to the user menu and click \"Reload\".\n2. Now, on selection of Supplier in a new Purchase Order, **GSTIN** will be fetched automatically from the selected Supplier. If GSTIN is not found in supplier, you can enter it manually.\n\n![](/files/po-gstin-s2.png)", "content_type": "prose", "has_code": false, "token_count": 157}
{"chunk_id": "12_guides_app_dev__guides__app-development__adding-module-icons-on-desktop__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/adding-module-icons-on-desktop", "title": "Adding Module Icons On Desktop", "section_heading": "Example App Library Management", "content": "## Example App Library Management\n\n> Frappe version 12\n\nTo create an icon for your app, you have to edit your app's `config/desktop.py`. In this file you can add a `get_data` method returns a dictionary with the module icon parameters.\n\nYou can also create a dropdown list of actions available on this module and actions available on the page when you click on this module. To achieve this, create a file `config/MODULE_NAME.py` (replace `MODULE_NAME` with the name of one of your app's modules).\n\n### Example App Library Management\n\n`config/desktop.py`:\n\n```python\ndef get_data():\n return [\n {\n \"module_name\": \"Library Management\",\n \"category\": \"Modules\",\n \"label\": _(\"Library Management\"),\n \"color\": \"#589494\",\n \"icon\": \"octicon octicon-book\",\n \"type\": \"module\",\n \"description\": \"Library management\"\n }\n ]\n```\n\n`config/library_management.py`:\n\n```python\ndef get_data():\n return [\n {\n \"label\": _(\"Library Management\"),\n \"icon\": \"octicon octicon-book\",\n \"items\": [\n {\n \"type\": \"doctype\",\n \"name\": \"Article\",\n \"label\": _(\"Article\"),\n \"description\": _(\"Manage Books\"),\n \"onboard\": 1,\n },\n {\n \"type\": \"doctype\",\n \"name\": \"Library Member\",\n \"label\": _(\"Library Member\"),\n \"description\": _(\"Manage Members\"),\n # Not displayed on dropdown list action but on page after click on module\n \"onboard\": 0,\n }\n ]\n }\n ]\n```\n\nNote: Module views are visible based on permissions.", "content_type": "mixed", "has_code": true, "token_count": 340}
{"chunk_id": "12_guides_app_dev__guides__app-development__single-type-doctype__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/single-type-doctype", "title": "Single Type Doctype", "section_heading": "Examples", "content": "## Examples\n\nDocTypes have a table associated with them. For example DocType **Customer** will have a table `tabCustomer` associated with it.\n\n**Single** type DocTypes have no table associated and there is only one Document for it. This is similar to the Singleton pattern in Java. Single DocTypes are ideal for saving Settings (that are globally applicable) and for wizard / helper type forms that have no documents, but when the DocType is used for the Form UI.\n\nThe data in Single DocType is stored in `tabSingles` (`doctype`, `field`, `value`)\n\n### Examples\n\nIn Frappe, Single types are **System Settings** and **Customize Form**", "content_type": "prose", "has_code": false, "token_count": 158}
{"chunk_id": "12_guides_app_dev__guides__app-development__generic-oauth-client__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/generic-oauth-client", "title": "Generic Oauth Client", "section_heading": "Getting started", "content": "## Getting started\n\n* [Connected App](/framework/v14/user/en/guides/app-development/connected-app)\n\n**Connected App** stores the client ID and secret, scopes and endpoints of the platform you're integrating with.\n\n### Getting started\n\n> This example uses Google, but you can use any service supporting OAuth 2.0.\n\nYour integration will most probably need a settings doctype (for example, \"Google Settings\"). Here you create a link field to **Connected App**. A System Manager can later create a **Connected App**, enter the client credentials and link it to your integration. You will know which **Connected App** belongs to your integration via your settings DocType.\n\n```python\ngoogle_settings = frappe.get_single('Google Settings')\nconnected_app_name = google_settings.get('connected_app')\n\nconnected_app = frappe.get_doc('Connected App', connected_app_name)\n```\n\nNow you have an instance of your **Connected App**, containing the credentials and endpoint URIs. If a user didn't connect yet, they can open the **Connected App** and click the \"Connect to ...\" button on the top right. Alternatively, you can get the authorization URI and use it for your own custom button or redirect:\n\n```python\nauthorization_uri = connected_app.initiate_web_application_flow() # optional\n```\n\nOnce the user is authorized, you can get an authenticated session like this:\n\n```python\nsession = connected_app.get_oauth2_session()\n```\n\n> If the user is not authenticated at this time, they will be redirected to the authentication page.\n\nNow you can retrieve any allowed resource from the target platform:\n\n```python\nsession.get('https://www.googleapis.com/oauth2/v2/userinfo')\n```\n\nIf the access token is expired, the session will automatically try to refresh it.", "content_type": "mixed", "has_code": true, "token_count": 436}
{"chunk_id": "12_guides_app_dev__guides__app-development__adding-social-login-provider__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/adding-social-login-provider", "title": "Adding Social Login Provider", "section_heading": "Add your provider in `SocialLoginKey.get_social_login_provider`", "content": "## Add your provider in `SocialLoginKey.get_social_login_provider`\n\nThis guide discusses how to add a social login provider to frappe via pull request.\n\n### Add your provider in `SocialLoginKey.get_social_login_provider`\n\n```python\nproviders[\"Frappe\"] = {\n \"provider_name\": \"Frappe\",\n \"enable_social_login\": 1,\n \"custom_base_url\": 1,\n \"icon\":\"/assets/frappe/images/favicon.png\",\n \"redirect_url\": \"/api/method/frappe.www.login.login_via_frappe\",\n \"api_endpoint\": \"/api/method/frappe.integrations.oauth2.openid_profile\",\n \"api_endpoint_args\":None,\n \"authorize_url\": \"/api/method/frappe.integrations.oauth2.authorize\",\n \"access_token_url\": \"/api/method/frappe.integrations.oauth2.get_token\",\n \"auth_url_data\": json.dumps({\n \"response_type\": \"code\",\n \"scope\": \"openid\"\n })\n}\n```\n\n### Add provider key in exact same type case in options of `social_login_provider` select field on `Social Login Key` DocType. e.g. `Frappe`\n\nOnce the user adds a social login provider and enables it the `Authorization Code` is sent back by the provider api server on to the redirect\\_url mentioned on the same server. You will have to add a whitelisted method allowing guest access in `frappe.integrations.oauth2_logins`. e.g. `login_via_office365`\n\nThere many implementations of OAuth 2.0 + OpenID Connect. Here we'll discuss two ways of accessing openid information.\n\n### User Creation via OpenID Profile Endpoint\n\nexample:\n\n```python\n@frappe.whitelist(allow_guest=True)\ndef login_via_frappe(code, state):\n login_via_oauth2(\"frappe\", code, state, decoder=json.loads)\n```\n\n### User Creation via id\\_token\n\nexample:\n\n```python\n@frappe.whitelist(allow_guest=True)\ndef login_via_office365(code, state):\n login_via_oauth2_id_token(\"office_365\", code, state, decoder=json.loads)\n```", "content_type": "mixed", "has_code": true, "token_count": 438}
{"chunk_id": "12_guides_app_dev__guides__app-development__exporting-customizations__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/app-development/exporting-customizations", "title": "Exporting Customizations", "section_heading": "", "content": "A common use case is to extend a DocType via Custom Fields and Property Setters for a particular app. To save these settings to an app, go to **Customize Form**\n\nYou will see a button for **Export Customizations**\n\n![](/files/export-custom-1.png)\n\nHere you can select the module and whether you want these particular customizations to be synced after every update.\n\nThe customizations will be exported to a new folder `custom` in the module folder of your app. The customizations will be saved by the name of the DocType\n\n![](/files/export-custom-2.png)\n\nWhen you do `bench update` or `bench migrate` these customizations will be synced to the app.", "content_type": "prose", "has_code": false, "token_count": 162}
{"chunk_id": "12_guides_app_dev__guides__caching__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/caching", "title": "Caching", "section_heading": "Redis Data Types and Usage", "content": "## Redis Data Types and Usage\n\nOne of the batteries included in Frappe Framework is inbuilt caching using Redis. Redis is fast, simple to use, in-memory key-value storage. Redis with Frappe Framework can be used to speed up repeated long-running computations or avoid database queries for data that doesn't change often.\n\nRedis is spawned as a separate service by the bench and each Frappe web/background worker can connect to it using `frappe.cache`.\n\n> Note: On older versions of Frappe, you may need to use `frappe.cache()` instead of `frappe.cache` to access Redis connection.\n\n### Redis Data Types and Usage\n\nRedis supports many data types, but here we will only cover a few most used datatypes:\n\n1. **Strings** are the most popular and most used datatype in Redis. They are stored as key-value pairs.\n\n```python\nIn [1]: frappe.cache.set_value(\"key\", \"value\")\n\nIn [2]: frappe.cache.get_value(\"key\")\nOut[2]: 'value'\n```\n\n2. **Hashes** are used to represent complicated objects, fields of which can be updated separately without sending the entire object. You can imagine Hashes as dictionaries stored on Redis.\n\n```python\n# Get fields separately\nIn [1]: frappe.cache.hset(\"user|admin\", \"name\", \"Admin\")\nIn [2]: frappe.cache.hset(\"user|admin\", \"email\", \"admin@example.com\")\n\n# Get single field value\nIn [3]: frappe.cache.hget(\"user|admin\", \"name\")\nOut[3]: 'Admin'\n\n# Or retrieve all fields at once.\nIn [4]: frappe.cache.hgetall(\"user|admin\")\nOut[4]: {'name': 'Admin', 'email': 'admin@example.com'}\n```", "content_type": "mixed", "has_code": true, "token_count": 376}
{"chunk_id": "12_guides_app_dev__guides__caching__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/caching", "title": "Caching", "section_heading": "Cached Documents", "content": "## Cached Documents\n\nFrappe has an inbuilt function for getting documents from the cache instead of the database.\n\nGetting a document from the cache is usually faster, so you should use them when the document doesn't change that often. A common usage for this is getting user configured settings.\n\n```python\nsystem_settings = frappe.get_cached_doc(\"System Settings\")\n```\n\nCached documents are automatically cleared using \"best-effort\" cache invalidation.\n\nWhenever Frappe's ORM encounters a change using `doc.save` or `frappe.db.set_value`, it clears the related document's cache. However, this isn't possible if a raw query to the database is issued.\n\nNote: Manual cache invalidation can be done using `frappe.clear_document_cache(doctype, name)`.\n\n### Implementing Custom Caching\n\nWhen you're dealing with a long expensive computation, the outcome of which is deterministic for the same inputs then it might make sense to cache the output.\n\nLet's attempt to implement a custom cache in this toy function which is slow.\n\n```python\ndef slow_add(a, b):\n    import time; time.sleep(1) # Fake workload\n    return a + b\n```\n\nThe most important part of implementing custom caching is generating a unique key. In this example the outcome of the cached value is dependent on two input variables, hence they should be part of the key.\n\n```python\ndef slow_add(a, b):\n    key = f\"slow_addition|{a}+{b}\" # unique key representing this computation\n\n    # If this key exists in cache, then return value\n    if cached_value := frappe.cache.get_value(key):\n        return cached_value\n\n    import time; time.sleep(1) # Fake workload\n    result = a + b\n\n    # Set the computed value in cache so next time we dont have to do the work\n    frappe.cache.set_value(key, result)\n\n    return result\n```\n\n### Cache Invalidation\n\nTwo strategies are recommended for avoiding stale cache issues:\n\n1. Setting short TTL while setting cached values.\n\n```python\n# This cached value will automatically expire in one hour\nfrappe.cache.set_value(key, result, expires_in_sec=60*60)\n```\n\n2. Manually clearing the cache when cached values are modified.\n\n```python\nfrappe.cache.delete_value(key) # `frappe.cache.hdel` if using hashes.\n```", "content_type": "mixed", "has_code": true, "token_count": 550}
{"chunk_id": "12_guides_app_dev__guides__caching__003", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/caching", "title": "Caching", "section_heading": "`@redis_cache` decorator", "content": "## `@redis_cache` decorator\n\nFrappe provides a decorator to automatically cache the results of a function call.\n\nYou can use it to quickly implement caching on top of any existing function which might be slow.\n\n```python\nIn [1]: def slow_function(a, b):\n   ...:     import time; time.sleep(1)  # fake expensive computation\n   ...:     return a + b\n   ...:\n\nIn [2]: # This takes 1 second to execute every time.\n   ...: %time slow_function(40, 2)\n   ...:\nWall time: 1 s\nOut[2]: 42\n\nIn [3]: %time slow_function(40, 2)\nWall time: 1 s\nOut[3]: 42\n\nIn [4]: from frappe.utils.caching import redis_cache\n   ...:\n\nIn [5]: @redis_cache\n   ...: def slow_function(a, b):\n   ...:     import time; time.sleep(1)  # fake expensive computation\n   ...:     return a + b\n   ...:\n\nIn [6]: # Now first call takes 1 second, but all subsequent calls return instantly.\n   ...: %time slow_function(40, 2)\n   ...:\nWall time: 1 s\nOut[6]: 42\n\nIn [7]: %time slow_function(40, 2)\n   ...:\nWall time: 897 \u00b5s\nOut[7]: 42\n```", "content_type": "mixed", "has_code": true, "token_count": 247}
{"chunk_id": "12_guides_app_dev__guides__caching__004", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/caching", "title": "Caching", "section_heading": "Cache Invalidation", "content": "## Cache Invalidation\n\nThere are two ways to invalidate cached values from `@redis_cache`.\n\n1. Setting appropriate expiry period (TTL in seconds) so cache invalidates automatically after some time. Example: `@redis_cache(ttl=60)` will cause cached value to expire after 60 seconds.\n2. Manual clearing of cache. This is done by calling function's `clear_cache` method.\n\n```python\n@redis_cache\ndef slow_function(...):\n    ...\n\ndef invalidate_cache():\n    slow_function.clear_cache()\n```\n\n### Frappe's Redis Setup\n\nBench sets up Redis by default. You will find Redis config in `{bench}/config/` directory.\n\nBench also configures `Procfile` and supervisor configuration file to launch Redis server when the bench is started.\n\n```python\nredis_cache: redis-server config/redis_cache.conf\n```\n\nA sample config looks like this:\n\n```python\ndbfilename redis_cache.rdb\ndir /home/user/benches/develop/config/pids\npidfile /home/user/benches/develop/config/pids/redis_cache.pid\nbind 127.0.0.1\nport 13000\nmaxmemory 737mb\nmaxmemory-policy allkeys-lru\nappendonly no\n\nsave \"\"\n```\n\nYou can modify this `maxmemory` in this config to increase the maximum memory allocated for caching. We do not recommend modifying anything else.\n\nRefer to the official config documentation to understand more: <https://redis.io/docs/management/config-file/>\n\n### Multi-tenancy\n\n`frappe.cache` internally prefixes keys by some site context. Hence calling `frappe.cache.set_value(\"key\")` from two different sites on the same bench will create two separate entries for each site.\n\nTo see implementation details of this see `frappe.cache.make_key` function.\n\n### Complex Types\n\nFrappe uses `pickle` module to serialize complex objects like documents in bytes. Hence when using `frappe.cache` you don't have to worry about serializing/de-serializing values.\n\nRead more about pickling here: <https://docs.python.org/3/library/pickle.html>\n\n### Client Side caching\n\nFrappe implements client-side cache on top of Redis cache inside `frappe.local.cache` to avoid repeated calls to Redis.\n\nAny repeated calls to Redis within the same request/job return data from the client cache instead of calling Redis again.\n\n### `RedisWrapper`\n\nAll Frappe related changes are made by wrapping the default Redis client and extending the methods. You can find this code in `frappe.utils.redis_wrapper` the module.", "content_type": "mixed", "has_code": true, "token_count": 588}
{"chunk_id": "12_guides_app_dev__guides__desk__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/desk", "title": "Desk", "section_heading": "", "content": "Articles related to customization of Frappe Desk\n\n1. [Formatter\\\\_ For Link Fields](/framework/v14/user/en/guides/desk/formatter_for_link_fields)\n2. [Making Charts](/framework/v14/user/en/guides/desk/making_charts)", "content_type": "prose", "has_code": false, "token_count": 53}
{"chunk_id": "12_guides_app_dev__guides__desk__formatter_for_link_fields__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/desk/formatter_for_link_fields", "title": "Formatter For Link Fields", "section_heading": "Example:", "content": "## Example:\n\nIn case where a code and a name is maintained for an entity, (for example for Employee there may be an Employee Code and Employee Name) and we want to show both the ID and name in a link field, we can make a formatter.\n\n### Example:\n\nfrappe.form.link\\_formatters['Employee'] = function(value, doc) {\nif(doc.employee\\_name && doc.employee\\_name !== value) {\nreturn value + ': ' + doc.employee\\_name;\n} else {\nreturn value;\n}\n}\n\nNotes:\n\n1. Both the primary key (`name) and the descriptive name (e.g.` employee\\_name`) must be present in the document. The descriptive name field could be hidden\n2. This needs to be loaded before the document is loaded and can be re-used for all forms. You can also add it in `build.json`", "content_type": "prose", "has_code": false, "token_count": 182}
{"chunk_id": "12_guides_app_dev__guides__desk__making_charts__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/desk/making_charts", "title": "Making Charts", "section_heading": "", "content": "[**Frappe Charts**](https://frappe.github.io/charts/) enables you to render simple line, bar or percentage graphs for single or multiple discreet sets of data points. You can also set special checkpoint values and summary stats. Check out the docs at https://frappe.github.io/charts/ to learn more.", "content_type": "prose", "has_code": false, "token_count": 74}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__getting-information-from-another-document-in-print-format__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/getting-information-from-another-document-in-print-format", "title": "Getting Information From Another Document In Print Format", "section_heading": "", "content": "In a print format, you can get data from another document. For example, if you have a field called `sales_order` in Sales Invoice, then you can get the sales order details using `frappe.get_doc`:\n\n```python\n{% set sales_order_doc = frappe.get_doc(\"Sales Order\", sales_order) %}\n\n```", "content_type": "mixed", "has_code": true, "token_count": 70}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__where-do-i-find-standard-print-formats__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/where-do-i-find-standard-print-formats", "title": "Where Do I Find Standard Print Formats", "section_heading": "1. Customizing Standard Print", "content": "## 1. Customizing Standard Print\n\nStandard Print formats are **auto generated** from the layout of the DocType. You can customize the standard format by\n\n### 1. Customizing Standard Print\n\nGo to **Setup > Customize > Customize Form View** and you can:\n\n1. Re-arranging fields by dragging and dropping\n2. Add static elements by adding **HTML** type fields and adding your HTML in **Options**\n3. Hiding fields by setting the **Print Hide** property\n\n### 2. Creating new layouts based on Print Formats\n\nAs there are not templates that are generated for standard Print Formats, you will have to create new templates from scratch using the [Jinja Templating Language](http://jinja.pocoo.org/) via\n\n**Setup > Printing and Branding > Print Format**\n\n1. [See Print Format help](https://docs.erpnext.com/docs/v14/user/manual/en/customize-erpnext/print-format).\n2. You can use the [Bootstrap CSS framework](http://getbootstrap.com) to layout your print formats\n\n**Tip: You can import [Standard Template macros](https://github.com/frappe/frappe/blob/develop/frappe/templates/print_formats/standard_macros.html) for building your print formats.**\n\nExample, adding the standard header:\n\n```python\n{%- from \"templates/print\\_formats/standard\\_macros.html\" import add\\_header -%}\n\n```", "content_type": "mixed", "has_code": true, "token_count": 317}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__how-to-make-query-report__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/how-to-make-query-report", "title": "How To Make Query Report", "section_heading": "1. Create a new Report", "content": "## 1. Create a new Report\n\nYou can create tabulated reports using complex SQL queries by creating a new Report. These reports can be created by a System Manager and are stored in the Database\n\n> Note: You will need System Manager Permissions for this.\n\nTo create a new Query Report:\n\n### 1. Create a new Report\n\n![Query Report](/files/query-report.png)\n\n1. Set type as \"Query Report\"\n2. Set the reference DocType - Users that have access to the reference DocType will have access to the report\n3. Set the module - The report will appear in the \"Custom Reports\" section of the module.\n4. Add your Query\n\n### 2. Set the Query\n\nYou can define complex queries such as:\n\nSELECT\n`tabProduction Order`.name as \"Production Order:Link/Production Order:200\",\n`tabProduction Order`.creation as \"Date:Date:120\",\n`tabProduction Order`.production\\_item as \"Item:Link/Item:150\",\n`tabProduction Order`.qty as \"To Produce:Int:100\",\n`tabProduction Order`.produced\\_qty as \"Produced:Int:100\"\nFROM\n`tabProduction Order`\nWHERE\n`tabProduction Order`.docstatus=1\nAND ifnull(`tabProduction Order`.produced\\_qty,0) = `tabProduction Order`.qty\nAND EXISTS (SELECT name from `tabStock Entry` where production\\_order =`tabProduction Order`.name)\n\n1. To format the columns, set labels for each column in the format: [Label]:[Field Type]/[Options]:[Width]\n\n### 3. Check the Report\n\n![Query Report](/files/query-report-out.png)", "content_type": "prose", "has_code": false, "token_count": 348}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__how-to-make-query-report__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/how-to-make-query-report", "title": "How To Make Query Report", "section_heading": "4. Advanced (adding filters)", "content": "## 4. Advanced (adding filters)\n\nIf you are making a standard report, you can add filters in your query report just like [script reports](https://frappe.io/docs/v14/user/en/guides/reports-and-printing/how-to-make-script-reports) by adding a `.js` file in your query report folder. To include filters in your query, use `%(filter_key)s` where your filter value will be shown.\n\nFor example\n\nSELECT ... FROM ... WHERE item\\_code = %(item\\_code)s ORDER BY ...\n\n---\n\n### Note: Standard Script Report\n\nIf you are developing a standard report for an app, make sure to set \"Is Standard\" as \"Yes\"", "content_type": "prose", "has_code": false, "token_count": 146}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__print-format-for-reports__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/print-format-for-reports", "title": "Print Format For Reports", "section_heading": "1. Creating New Print Formats", "content": "## 1. Creating New Print Formats\n\nIn version 4.1 we introduce Report Print Formats. These are HTML templates that you can use to format Query Report data for printing.\n\n### 1. Creating New Print Formats\n\nTo create a new Print Format, just drop in a `.html` file in the folder of the query report. For example, for the [General Ledger](https://github.com/frappe/erpnext/tree/develop/erpnext/accounts/report/general_ledger) report in ERPNext, you can drop in a file called `general_ledger.html` along side the `.js` and `.py` files.\n\n### Tree Of `erpnext/accounts/general_ledger`\n\ngeneral\\_ledger/\n\u251c\u2500\u2500 \\_\\_init\\_\\_.py\n\u251c\u2500\u2500 general\\_ledger.html\n\u251c\u2500\u2500 general\\_ledger.js\n\u251c\u2500\u2500 general\\_ledger.json\n\u2514\u2500\u2500 general\\_ledger.py\n\n### 2. Templating\n\nFor templating, we use an adapted version of [John Resig's microtemplating script](http://ejohn.org/blog/javascript-micro-templating/). If you know Javascript, it is very easy to follow this templating language.\n\n### Here are some examples (from John Resig's Blog):\n\nExample: Properities:\n\n\">\n\n![](%=profile_image_url%)\n\n**[<%=from\\_user%>](/%3C%=from_user%%3E):** <%=text%>\n\nExample: Code structures, Loops\n\n<% for ( var i = 0; i < users.length; i++ ) { %>\n\n* [<%=users[i].name%>](%=users%5Bi%5D.url%)\n\n<% } %>\n\n> **Note**: It is important to note that you should not use single quotes (') in your template as the engine cannot handle them effectively.\n\n### 3. Data\n\nData is available to the template as:\n\n* `data`: this is a list of records, with each record as an object with slugified properties from labels. For example \"Posting Date\" becomes \"posting\\_date\"\n* `filters`: filters set in the report\n* `report`: reportview object\n\n### 4. Example\n\nHere is how the General Ledger Report is built:\n\n[General Ledger Print Format Template](https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/report/general_ledger/general_ledger.html)\n\nHere is what the report looks like:\n\n![General Ledger](/files/general-ledger.png)\n\n### Comments:\n\n1. [Bootstrap Stylesheet](http://getbootstrap.com) is pre-loaded.\n2. You can use all global functions like `fmt_money` and dateutil.\n3. Translatable strings should be written as `__(\"text\")`\n4. You can create modules and import using `{% include \"templates/includes/formats/common_format\" %}`", "content_type": "prose", "has_code": false, "token_count": 567}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__how-to-make-script-reports__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/how-to-make-script-reports", "title": "How To Make Script Reports", "section_heading": "1. Create a new Report", "content": "## 1. Create a new Report\n\nYou can create tabulated reports using server side scripts by creating a new Report.\n\n> Note: You will need Administrator Permissions for this.\n\nSince these reports give you unrestricted access via Python scripts, they can only be created by Administrators. The script part of the report becomes a part of the repository of the application. If you have not created an app, [read this](https://frappe.io/docs/v14/user/en/guides/app-development/).\n\n> Note: You must be in [Developer Mode](https://frappe.io/docs/v14/user/en/guides/app-development/how-enable-developer-mode-in-frappe) to do this\n\n### 1. Create a new Report\n\n![Script Report](/files/script-report.png)\n\n1. Set Report Type as \"Script Report\"\n2. Set \"Is Standard\" as \"Yes\"\n3. Select the Module in which you want to add this report\n4. In the module folder (for example if it is Accounts in ERPnext the folder will be `erpnext/accounts/report/[report-name]`) you will see that templates for the report files will be created.\n5. In the `.js` file, you can set filters for the reports\n6. In the `.py` file, you can write the script that will generate the report\n\n### 2. Add Filters\n\nYou can add filters in the `.js`. See an example below:\n\nfrappe.query\\_reports[\"Accounts Receivable\"] = {\n\"filters\": [\n{\n\"fieldname\":\"company\",\n\"label\": \\_\\_(\"Company\"),\n\"fieldtype\": \"Link\",\n\"options\": \"Company\",\n\"default\": frappe.defaults.get\\_user\\_default(\"company\")\n},\n]\n}\n\n1. These properties are the same as you would set in a DocField in a DocType", "content_type": "prose", "has_code": false, "token_count": 380}
{"chunk_id": "12_guides_app_dev__guides__reports-and-printing__how-to-make-script-reports__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/reports-and-printing/how-to-make-script-reports", "title": "How To Make Script Reports", "section_heading": "3. Add the Script", "content": "## 3. Add the Script\n\nIn the `.py` file you can add the script for generating the report.\n\n1. In the `execute` method, two lists `columns` and `data` are returned\n2. Columns must be a list of dictionaries containing fields like fieldname, label, fieldtype, options,width. For example:\n\n```python\ncolumns = [{\n \"fieldname\": \"account\",\n \"label\": _(\"Account\"),\n \"fieldtype\": \"Link\",\n \"options\": \"Account\",\n \"width\": 300\n},\n{\n \"fieldname\": \"currency\",\n \"label\": _(\"Currency\"),\n \"fieldtype\": \"Link\",\n \"options\": \"Currency\",\n}]\n```\n\n3. You can use all server side modules to build your report.\n4. For example see existing reports. ([Balance Sheet](https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/report/balance_sheet/balance_sheet.py))\n\n### 4. Add link for your report on the module page\n\n![Module Page](/files/script-report-1.png)\n\n1. In the module folder (for example if it is Accounts in ERPNext the folder will be `erpnext/config/accounts.py`) you will see labels and items for various sections. The new report can be added in the item list as show in the example:\n\n```python\ndef get_data():\n return [{\n \"label\": _(\"Accounting Statements\"),\n \"items\": [{\n \"type\": \"report\",\n \"name\": \"Balance Sheet\",\n \"doctype\": \"GL Entry\",\n \"is_query_report\": True\n }]\n }]\n```", "content_type": "mixed", "has_code": true, "token_count": 318}
{"chunk_id": "12_guides_app_dev__guides__data__using-data-migration-tool__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/data/using-data-migration-tool", "title": "Using Data Migration Tool", "section_heading": "Data Migration Plan", "content": "## Data Migration Plan\n\n> Data Migration Tool was introduced in Frappe Framework version 9.\n\nThe Data Migration Tool was built to abstract all the syncing of data between a remote source and a DocType. This is a middleware layer between your Frappe based website and a remote data source.\n\nTo understand this tool, let's make a connector to push ERPNext Items to an imaginary service called Atlas.\n\n### Data Migration Plan\n\nA Data Migration Plan encapsulates a set of mappings.\n\nLet's make a new *Data Migration Plan*. Set the plan name as 'Atlas Sync'. We also need to add mappings in the mappings child table.\n\n![New Data Migration Plan](/files/new-data-migration-plan.png)\n\n### Data Migration Mapping\n\nA Data Migration Mapping is a set of rules that specify field-to-field mapping.\n\nMake a new *Data Migration Mapping*. Call it 'Item to Atlas Item'.\n\nTo define a mapping, we need to put in some values that define the structure of local and remote data.\n\n1. Remote Objectname: A name that identifies the remote object e.g Atlas Item\n2. Remote primary key: This is the name of the primary key for Atlas Item e.g id\n3. Local DocType: The DocType which will be used for syncing e.g Item\n4. Mapping Type: A Mapping can be of type 'Push' or 'Pull', depending on whether the data is to be mapped remotely or locally. It can also be 'Sync', which will perform both push and pull operations in a single cycle.\n5. Page Length: This defines the batch size of the sync.\n\n![New Data Migration Mapping](/files/new-data-migration-mapping.png)", "content_type": "prose", "has_code": false, "token_count": 382}
{"chunk_id": "12_guides_app_dev__guides__data__using-data-migration-tool__002", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/data/using-data-migration-tool", "title": "Using Data Migration Tool", "section_heading": "Specifying field mappings:", "content": "## Specifying field mappings:\n\nThe most basic form of a field mapping would be to specify fieldnames of the remote and local object. However, if the mapping is one-way (push or pull), the source field name can also take literal values in quotes (for e.g `\"GadgetTech\"`) and eval statements (for e.g `\"eval:frappe.db.get_value('Company', 'Gadget Tech', 'default_currency')\"`). For example, in the case of a push mapping, the local fieldname can be set to a string in quotes or an `eval` expression, instead of a field name from the local doctype. (This is not possible with a sync mapping, where both local and remote fieldnames serve as a target destination at a some point, and thus cannot be a literal value).\n\nLet's add the field mappings and save:\n\n![Add fields in Data Migration Mapping](/files/new-data-migration-mapping-fields.png)\n\nWe can now add the 'Item to Atlas Item' mapping to our Data Migration Plan and save it.\n\n![Save Atlas Sync Plan](/files/atlas-sync-plan.png)", "content_type": "prose", "has_code": false, "token_count": 245}
{"chunk_id": "12_guides_app_dev__guides__data__using-data-migration-tool__003", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/data/using-data-migration-tool", "title": "Using Data Migration Tool", "section_heading": "Additional layer of control with pre and post process:", "content": "## Additional layer of control with pre and post process:\n\nMigrating data frequently involves more steps in addition to one-to-one mapping. For a Data Migration Mapping that is added to a Plan, a mapping module is generated in the module specified in that plan.\n\nIn our case, an `item_to_atlas_item` module is created under the `data_migration_mapping` directory in `Integrations` (module for the 'Atlas Sync' plan).\n\n![Mapping <strong>init</strong>.py](/files/mapping-init-py.png)\n\nYou can implement the `pre_process` (receives the source doc) and `post_process` (receives both source and target docs, as well as any additional arguments) methods, to extend the mapping process. Here's what some operations could look like:\n\n![Pre and Post Process](/files/mapping-pre-and-post-process.png)\n\n### Data Migration Connector\n\nNow, to connect to the remote source, we need to create a *Data Migration Connector*.\n\n![New Data Migration Connector](/files/new-connector.png)\n\nWe only have two connector types right now, let's add another Connector Type in the Data Migration Connector DocType.\n\n![Add Connector Type in Data Migration Connector](/files/add-connector-type.png)\n\nNow, let's create a new Data Migration Connector.\n\n![Atlas Connector](/files/atlas-connector.png)\n\nAs you can see we chose the Connector Type as Atlas. We also added the hostname, username and password for our Atlas instance so that we can authenticate.\n\nNow, we need to write the code for our connector so that we can actually push data.\n\nCreate a new file called `atlas_connection.py` in `frappe/data_migration/doctype/data_migration_connector/connectors/` directory. Other connectors also live here.\n\nWe just have to implement the `insert`, `update` and `delete` methods for our atlas connector. We also need to write the code to connect to our Atlas instance in the `__init__` method. Just see `frappe_connection.py` for reference.\n\n![Atlas Connection file](/files/atlas-connection-py.png)\n\nAfter creating the Atlas Connector, we also need to import it into `data_migration_connector.py`\n\n![Edit Connector file](/files/edit-connector-py.png)", "content_type": "prose", "has_code": false, "token_count": 528}
{"chunk_id": "12_guides_app_dev__guides__data__using-data-migration-tool__004", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/data/using-data-migration-tool", "title": "Using Data Migration Tool", "section_heading": "Data Migration Run", "content": "## Data Migration Run\n\nNow that we have our connector, the last thing to do is to create a new *Data Migration Run*.\n\nA Data Migration Run takes a Data Migration Plan and Data Migration Connector and execute the plan according to our configuration. It takes care of queueing, batching, delta updates and more.\n\n![Data Migration Run](/files/data-migration-run.png)\n\nJust click Run. It will now push our Items to the remote Atlas instance and you can see the progress which updates in realtime.\n\nAfter a run is executed successfully, you cannot run it again. You will have to create another run and execute it.\n\nData Migration Run will try to be as efficient as possible, so the next time you execute it, it will only push those items which were changed or failed in the last run.\n\n> Note: Data Migration Tool is still in beta. If you find any issues please report them [here](https://github.com/frappe/erpnext/issues)", "content_type": "prose", "has_code": false, "token_count": 229}
{"chunk_id": "12_guides_app_dev__guides__data__import-large-csv-file__001", "module": "12_guides_app_dev", "source_url": "https://docs.frappe.io/framework/v15/user/en/guides/data/import-large-csv-file", "title": "Import Large Csv File", "section_heading": "Help", "content": "## Help\n\nTo import very large CSV files, you can use the bench utility `import-csv`.\n\nThe benefit is that this is not subject to timeouts if you use the web interface.\n\nHere is an example:\n\nbench --site test.erpnext.com import-csv ~/Downloads/Activity\\_Type.csv\n\n### Help\n\n$ bench import-csv --help\nUsage: bench import-csv [OPTIONS] PATH\n\nImport CSV using data import tool\n\nOptions:\n--only-insert Do not overwrite existing records\n--submit-after-import Submit document after importing it\n--ignore-encoding-errors Ignore encoding errors while coverting to unicode\n--help Show this message and exit.", "content_type": "prose", "has_code": false, "token_count": 149}
