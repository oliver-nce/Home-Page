{"chunk_id": "09_bench_cli__bench__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench", "title": "Bench", "section_heading": "References", "content": "## References\n\nBench is a CLI tool to manage Frappe Deployments. It provides an easy interface\nto help you setup and manage multiple sites and apps based on Frappe Framework.\n\nHowever, the term bench may mean different things depending on the context. We\nuse the term \"bench\" to refer to the CLI tool and the directory interchangeably.\nThis may get confusing a lot of times.\n\nA: \"Did you update the bench?\"\nB: \"Yes, migrations for the latest version were smoother this time around.\"\nA: \"What?! I told you to update the CLI tool!\"\nB: \"Let's hope our clients like Version 13\"\n\nTo avoid these type of situations, we will refer to **\"Bench\"** as the bench\ndirectory and **\"Bench CLI\"** to refer to the CLI tool.\n\n> To install the bench CLI and setup a Frappe environment, follow\n> [Installation](/framework/v14/user/en/installation).\n\nThis may not be known to a lot of people but half the bench commands we're used\nto, exist in the Frappe Framework and not in bench directly. Those commands\ngenerally are the `--site` commands. Even commands like `update` provide easy\nwrappers around and invoke multiple Frappe commands such as `backup` and\n`migrate` along with some other essential bench and system-level operations.\n\n### References\n\n1. [Bench Commands](/framework/v14/user/en/bench/bench-commands)\n2. [Frappe Commands](/framework/v14/user/en/bench/frappe-commands)\n3. [Command References](/framework/v14/user/en/bench/reference)\n4. [Extending the CLI](/framework/v14/user/en/bench/extending-the-cli)", "content_type": "prose", "has_code": false, "token_count": 374}
{"chunk_id": "09_bench_cli__bench__bench-commands__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Using the bench CLI", "content": "## Using the bench CLI\n\nThis page is concerned only with the commands that exist in the bench project,\nthat are a direct part of the CLI tool. These commands are defined under the\n[frappe/bench](https://github.com/frappe/bench).\n\n> For references of any Framework commands, checkout [Frappe\n> Commands](/framework/v14/user/en/bench/frappe-commands).\n\n### Using the bench CLI\n\n```python\n\u279c bench\nUsage: bench [OPTIONS] COMMAND [ARGS]...\n\n Bench manager for Frappe\n\nOptions:\n --version\n --help Show this message and exit.\n\nCommands:\n backup Backup single site\n backup-all-sites Backup all sites in current bench\n config Change bench configuration\n disable-production Disables production environment for the bench.\n download-translations Download latest translations\n exclude-app Exclude app from updating\n find Finds benches recursively from location\n get-app Clone an app from the internet or filesystem and...\n```\n\nSimilarly, all available flags and options can be checked for commands\nindividually by executing them with the `--help` flag. The `init` command for\ninstance:\n\n```python\n\u279c bench init --help\nUsage: bench init [OPTIONS] PATH\n\n Initialize a new bench instance in the specified path\n\nOptions:\n --python TEXT Path to Python Executable.\n --ignore-exist Ignore if Bench instance exists.\n --apps_path TEXT path to json files with apps to install\n after init\n```\n\n### Commands\n\nUnder Click's structure, `bench` is the main command group, under which there\nare three main groups of commands in bench currently, namely\n\n### General Commands\n\nA set of commands that don't classify broadly in the other commands. Commands\nsuch as `init`, `get-app`, `find` come under this category. These commands\nbelong directly to the bench group so they can be invoked directly prefixing\neach with `bench` in your shell. Therefore, the usage for these commands is as\n\n```python\n\u279c bench COMMAND [ARGS]...\n```", "content_type": "mixed", "has_code": true, "token_count": 473}
{"chunk_id": "09_bench_cli__bench__bench-commands__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Frequently Used", "content": "## Frequently Used\n\n* **init**: Initialize a new bench instance in the specified path. This sets up\n  a complete bench folder with an `apps` folder which contains all the Frappe\n  apps available in the current bench, `sites` folder that stores all site data\n  separated by individual site folders, `config` folder that contains your\n  redis, NGINX and supervisor configuration files. The `env` folder consists of\n  all python dependencies of the current bench and installed Frappe\n  applications have.\n* **restart**: Restart web, supervisor, systemd processes units. Used in the\n  production setup.\n* **update**: If executed in a bench directory, without any flags will backup,\n  pull, setup requirements, build, run patches and restart bench. Using\n  specific flags will only do certain tasks instead of all.\n* **migrate-env**: Migrate Virtual Environment to desired Python version. This\n  regenerates the `env` folder with the specified Python version.\n* **retry-upgrade**: Retry a failed upgrade\n* **disable-production**: Disables production environment for the bench.\n* **renew-lets-encrypt**: Renew Let's Encrypt certificate for site SSL.\n* **backup**: Backup single site data. Can be used to backup files as well.\n* **backup-all-sites**: Backup all sites in the current bench.\n* **get-app**: Download an app from the internet or filesystem and set it up in\n  your bench. This clones the git repo of the Frappe project and installs it in\n  the bench environment.\n* **remove-app**: Completely remove the specified Frappe App from the current\n  bench and re-build assets if not installed on any site.\n* **exclude-app**: Exclude app from updating during a `bench update`\n* **include-app**: Include app for updating. All Frappe applications are\n  included by default when installed.\n* **remote-set-url**: Set app remote url\n* **remote-reset-url**: Reset app remote url to frappe official\n* **remote-urls**: Show apps remote url\n* **switch-to-branch**: Switch all apps to specified branch, or specify apps\n  separated by space\n* **switch-to-develop**: Switch Frappe and ERPNext to develop branch", "content_type": "prose", "has_code": false, "token_count": 523}
{"chunk_id": "09_bench_cli__bench__bench-commands__003", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Advanced Setup-based", "content": "## Advanced Setup-based\n\n* **set-nginx-port**: Set NGINX port for site\n* **set-ssl-certificate**: Set SSL certificate path for site\n* **set-ssl-key**: Set SSL certificate private key path for site\n* **set-url-root**: Set URL root for site\n* **set-mariadb-host**: Set MariaDB host for bench\n* **set-redis-cache-host**: Set Redis cache host for bench\n* **set-redis-queue-host**: Set Redis queue host for bench\n* **set-redis-socketio-host**: Set Redis socketio host for bench\n* **use**: Set default site for bench\n* **download-translations**: Download latest translations\n\n### Development\n\n* **start**: Start Frappe development processes. Uses the Procfile to start the\n  Frappe development environment.\n* **src**: Prints bench source folder path, which can be used to cd into the\n  bench installation repository by `cd $(bench src)`.\n* **find**: Finds benches recursively from location or specified path.\n* **pip**: Use the current bench's pip to manage Python packages. For help\n  about pip usage: `bench pip help [COMMAND]` or `bench pip [COMMAND] -h`.\n* **new-app**: Create a new Frappe application under apps folder.\n\n### Release bench\n\n* **release**: Create a release of a Frappe application\n* **prepare-beta-release**: Prepare major beta release from develop branch", "content_type": "prose", "has_code": false, "token_count": 317}
{"chunk_id": "09_bench_cli__bench__bench-commands__004", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Setup Commands", "content": "## Setup Commands\n\nThis command group consists of commands used to manipulate the requirements and\nthe environment required by your Frappe environment. The setup commands used for\nsetting up the Frappe environment in the context of the current bench need to be\nexecuted using `bench setup` as the prefix. So, the general usage of these\ncommands is as\n\n```python\n\u279c bench setup COMMAND [ARGS]...\n```\n\n* **sudoers**: Add commands to sudoers list for allowing bench commands\n  execution without root password\n* **env**: Setup Python's virtual environment for your bench. This sets up a\n  `env` folder under the root of the bench directory.\n* **redis**: Generates configuration for Redis\n* **fonts**: Add Frappe fonts to system\n* **config**: Generate or over-write `sites/common_site_config.json`\n* **backups**: Add cronjob for bench backups\n* **socketio**: Setup node dependencies for socketio server\n* **requirements**: Setup Python and Node dependencies\n* **manager**: Setup `bench-manager.local` site with the [Bench\n  Manager](https://github.com/frappe/bench_manager) app, a GUI for bench\n  installed on it.\n* **procfile**: Generate Procfile for bench start\n* **production**: Setup a Frappe production environment for the specified user.\n  This installs ansible, NGINX, supervisor, fail2ban and generates the\n  respective configuration files.\n* **nginx**: Generate configuration files for NGINX\n* **fail2ban**: Setup fail2ban, an intrusion prevention software framework that\n  protects computer servers from brute-force attacks\n* **systemd**: Generate configuration for systemd\n* **firewall**: Setup firewall for system\n* **ssh-port**: Set SSH Port for system\n* **reload-nginx**: Checks NGINX config file and reloads service\n* **supervisor**: Generate configuration for supervisor\n* **lets-encrypt**: Setup lets-encrypt SSL for site\n* **wildcard-ssl**: Setup wildcard SSL certificate for multi-tenant bench\n* **add-domain**: Add a custom domain to a particular site\n* **remove-domain**: Remove a custom domain from a site\n* **sync-domains**: Check if there is a change in domains. If yes, updates the\n  domains list.\n* **role**: Install dependencies via ansible roles", "content_type": "mixed", "has_code": true, "token_count": 541}
{"chunk_id": "09_bench_cli__bench__bench-commands__005", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Config Commands", "content": "## Config Commands\n\nThe config command group deals with making changes in the current bench (not the\nCLI tool) configuration. The config group commands are used for manipulating\nconfigurations in the current bench context. The usage for these commands is as\n\n```python\n\u279c bench config COMMAND [ARGS]...\n```\n\n* **set-common-config**: Set value in common config with parameters -c, configs\n  or --config\n* **remove-common-config**: Remove specific keys from current bench's common\n  config\n* **update\\\\_bench\\\\_on\\\\_update**: Enable/Disable bench updates on running bench\n  update\n* **restart\\\\_supervisor\\\\_on\\\\_update**: Enable/Disable auto restart of\n  supervisor processes\n* **restart\\\\_systemd\\\\_on\\\\_update**: Enable/Disable auto restart of systemd\n  units\n* **dns\\\\_multitenant**: Enable/Disable bench multitenancy on running bench\n  update\n* **serve\\\\_default\\\\_site**: Configure nginx to serve the default site on port\n  80\n* **http\\\\_timeout**: Set HTTP timeout", "content_type": "mixed", "has_code": true, "token_count": 242}
{"chunk_id": "09_bench_cli__bench__bench-commands__006", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Install Commands", "content": "## Install Commands\n\nThe install command group deals with commands used to install system\ndependencies for setting up a Frappe environment. The usage for these commands\nis as\n\n```python\n bench install COMMAND [ARGS]...\n```\n\n* **prerequisites**: Installs pre-requisite libraries, essential tools like\n  b2zip, htop, screen, vim, x11-fonts, python libs, cups and Redis\n* **nodejs**: Installs Node.js v8\n* **nginx**: Installs NGINX. If user is specified, sudoers is setup for that\n  user\n* **packer**: Installs Oracle virtualbox and packer 1.2.1\n* **psutil**: Installs psutil via pip\n* **mariadb**: Install and setup MariaDB of specified version and root password\n* **wkhtmltopdf**: Installs wkhtmltopdf v0.12.3 for linux\n* **supervisor**: Installs supervisor. If user is specified, sudoers is setup\n  for that user\n* **fail2ban**: Install fail2ban, an intrusion prevention software framework\n  that protects computer servers from brute-force attacks\n* **virtualbox**: Installs virtualbox.\n\n### General Usage\n\nThis section covers the general usage of the Bench CLI, enough to get you\nfamiliar with the basic usage.\n\n### Create a new bench\n\nThe init command will create a bench directory with the frappe framework\ninstalled. It will be setup for periodic backups.\n\n```python\n\u279c bench init frappe-bench && cd frappe-bench\n```\n\n### Add a site\n\nFrappe apps are run by frappe sites and you will have to create at least one\nsite. The new-site command allows you to do that.\n\n```python\n\u279c bench new-site site1.local\n```\n\n### Add apps\n\nThe get-app command gets remote frappe apps from a remote git repository and\ninstalls them. Example: [erpnext](https://github.com/frappe/erpnext)\n\n```python\n\u279c bench get-app erpnext https://github.com/frappe/erpnext\n```\n\n### Install apps\n\nTo install an app on your new site, use the bench `install-app` command.\n\n```python\n\u279c bench --site site1.local install-app erpnext\n```\n\n### Start bench\n\nTo start using the bench, use the `bench start` command\n\n```python\n\u279c bench start\n```\n\nTo login to Frappe / ERPNext, open your browser and go to\n`[your-external-ip]:8000`, probably `localhost:8000`\n\nThe default username is \"Administrator\" and password is what you set when you\ncreated the new site.\n\n### Update bench\n\nUpdate all apps and sites from your bench directory. This operation performs\nbackups, sets up requirements, build asstes, runs migrations and restarts your\nprocess manager for you.\n\n```python\n\u279c bench update\n```", "content_type": "mixed", "has_code": true, "token_count": 610}
{"chunk_id": "09_bench_cli__bench__bench-commands__007", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/bench-commands", "title": "Bench Commands", "section_heading": "Update Bench config", "content": "## Update Bench config\n\nTo update the common site config for your bench, you can use the\n`set-common-config` and `remove-common-config` commands under the config\ncommand group. To learn more about Frappe Site configurations available,\ncheckout the [Site Config](/framework/v14/user/en/basics/sites#site-config) and [Bench Config docs](/framework/v14/user/en/bench/bench-commands#config-commands).\n\nTo add or update an existing config key, you can run something like\n\n```python\n\u279c bench config set-common-config -c enable_frappe_logger true\n```\n\nTo remove an existing config key, you can run something like\n\n```python\n\u279c bench config remove-common-config enable_frappe_logger\n```\n\n### Bench Manager\n\nFor a UI based approach to managing your deployments, checkout [Bench\nManager](https://github.com/frappe/bench_manager).\n\n```python\n\u279c bench setup manager\n```\n\nYou can set it up easily on any existing bench by running the above command.\n\n### What this does?\n\n1. Create a new site `bench-manager.local`\n2. Get the `bench_manager` app\n3. Install the `Bench Manager` app on the site `bench-manager.local`\n\nYou can use this site to manage your bench operations through\n*bench-manager.local*'s `/desk` view.", "content_type": "mixed", "has_code": true, "token_count": 299}
{"chunk_id": "09_bench_cli__bench__frappe-commands__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Site Commands", "content": "## Site Commands\n\nThe Bench CLI utilizes the module`frappe.utils.bench_manager` to get the framework's as well as any other Application's commands present on the current bench directory.\n\nThis page is concerned only with the commands that exist in the Frappe project, that are a direct part of the CLI tool. These commands are defined under the [frappe/frappe](https://github.com/frappe/frappe).\n\n> For references of any Bench commands, checkout [Bench Commands](/framework/v14/user/en/bench/bench-commands).\n\nThere are four major command types in Frappe inherited by Bench during command executions. They can be broadly grouped into\n\n### Site Commands\n\nSet of commands used for site-specific operations. These are the most frequented commands to alter the state of your sites. These commands are accessed by using the `--site` option along with the site name (or \"all\") if you wish to run the operation *(if possible)* for all sites on the bench. These commands are defined under the module `frappe.commands.site`.\n\n### Site Creation\n\nCreate a new Site on your bench. By default, all sites created on your bench will have only the Frappe Framework installed on them.\n\n```python\nbench new-site {site}\n```\n\nFor more information and examples, see the [bench new-site](/framework/v14/user/en/bench/reference/new-site) reference.", "content_type": "mixed", "has_code": true, "token_count": 331}
{"chunk_id": "09_bench_cli__bench__frappe-commands__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Site Backups", "content": "## Site Backups\n\nYou can use the Bench CLI to take backups on the sites of your bench. You can manage the site's database and files backups and have more control over the operation.\n\n```python\nbench --site {site} backup\n```\n\nThe Bench CLI also deletes the older backup files from your bench directory. By default, it deletes backups older than 24 hours from the backups directory.\n\nFor more information and examples, see the [bench backup](/framework/v14/user/en/bench/reference/backup) reference.\n\n### Site Restores\n\nBench CLI can be used to restore an existing site to a previous state. Using the `bench restore` command, a site may be restored with the specific database and file restores.\n\n```python\nbench --site {site} restore {path/to/database/file}\n```\n\nThe least requirement for performing a restore operation is having the database file on your local filesystem. The specified backup file may have the `sql.gz` of `sql` extension.\n\nFor more information and examples, see the [bench restore](/framework/v14/user/en/bench/reference/restore) reference.", "content_type": "mixed", "has_code": true, "token_count": 264}
{"chunk_id": "09_bench_cli__bench__frappe-commands__003", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Partial Site Restores and Backups", "content": "## Partial Site Restores and Backups\n\nSince Version 13, Frappe has support for taking partial backups and restoring them. Partial backups can be taken using the `bench backup` command directly. As for partial restores, the `bench partial-restore` command may be used to restore the partial backups to an existing site.\n\nFor more information and examples, see the [bench partial-restore](/framework/v14/user/en/bench/reference/partial-restore) and [bench backup](/framework/v14/user/en/bench/reference/backup) reference.\n\n### Site App Management\n\nYou can install or uninstall Frappe Applications available on your Bench. To add Apps to your bench using `bench get-app` checkout [the docs](/framework/v14/user/en/bench/bench-commands#frequently-used).\n\n### App Installation\n\nThe easiest way to install a Frappe Application on your site is through the Bench CLI. However, the application must be installed on your bench prior to that.\n\n```python\nbench --site {site} install-app {app}\n```\n\nIn this operation, Application `meta`, `modules` and `doctypes` of the specified site are installed on the specified site.", "content_type": "mixed", "has_code": true, "token_count": 277}
{"chunk_id": "09_bench_cli__bench__frappe-commands__004", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "App Uninstallation", "content": "## App Uninstallation\n\nUninstall an app installed on site. This is a destructive action and consists of removing all app-related data from the site. Hence, a backup is taken before uninstalling said app.\n\n```python\nbench --site {site} uninstall-app {app}\n```\n\n> Note: From Version 13, even apps not installed on the Bench can be uninstalled from the site.\n\nFor more information and examples, see the [bench uninstall-app](/framework/v14/user/en/bench/reference/uninstall-app) reference.\n\n### Site Migrations\n\nRun patches, sync schema and rebuild files, translations and indexes on a particular site. Find out how site migrations work in [the docs](/framework/v14/user/en/database-migrations).\n\n```python\nbench --site {site} migrate\n```\n\nFor more information and examples, see the [bench migrate](/framework/v14/user/en/bench/reference/migrate) reference.\n\n### Site Deletion\n\nDrops the database and moves the site directory from `./sites` to the `./archived_sites` *(unless specified otherwise)* folder on your Bench.\n\n```python\nbench drop-site {site}\n```\n\nFor more information and examples, see the [bench drop-site](/framework/v14/user/en/bench/reference/drop-site) reference.\n\n### Reset Site Data\n\nRe-install all installed Applications from your specified site. This completely resets the site.\n\n```python\nbench reinstall {site}\n```\n\nFor more information and examples, see the [bench reinstall](/framework/v14/user/en/bench/reference/reinstall) reference.", "content_type": "mixed", "has_code": true, "token_count": 364}
{"chunk_id": "09_bench_cli__bench__frappe-commands__005", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "List Installed Apps", "content": "## List Installed Apps\n\nList all the Frappe Applications installed on the specified site. The information shown by the command is fetched from the **Installed Applications** DocType which tracks the latest version of the apps, the site was migrated to. The global default `installed_apps` is used as fallback.\n\n```python\nbench --site {site} list-apps\n```\n\nMulti-site support has been added in Version 13. To see the summary for all sites, run the command with site's value as `all`.\n\nFor more information and examples, see the [bench list-apps](/framework/v14/user/en/bench/reference/list-apps) reference.\n\n### Setting the default site\n\nSometimes typing `--site [sitename]` for every site command can be tedious. You can set the default site for the terminal session by setting the `FRAPPE_SITE` environment variable.\n\n```python\n~/frappe-bench\n\u276f export FRAPPE_SITE=mysite.localhost\n\n~/frappe-bench\n\u276f echo $FRAPPE_SITE\nmysite.localhost\n\n~/frappe-bench\n\u276f bench console\nApps in this namespace:\nfrappe\n\nIn [1]: frappe.local.site\nOut[1]: 'mysite.localhost'\n```", "content_type": "mixed", "has_code": true, "token_count": 263}
{"chunk_id": "09_bench_cli__bench__frappe-commands__006", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Access site in the browser", "content": "## Access site in the browser\n\nTo access a site in the browser, you have to remember the webserver port on which bench is running and then type out the full URL. There is a bench command that does this for you.\n\nRunning the following command will open the site url directly in your default browser.\n\n```python\n# open site.local in the browser\n$ bench --site site.local browse\n\n# this also works\n$ bench browse site.local\n```\n\nYou can also login as a user by passing `--user` option.\n\n```python\n$ bench --site site.local browse --user test@example.com\n\n$ bench --site site.local browse --user Administrator\nLogin URL: http://site.local:8000/app?sid=<generated-sid>\n```\n\n> Note that this command:\n>\n> * Allows login as any user only when developer\\_mode is set to 1\n> * Allows login as Administrator regardless of developer\\_mode\n> * Prints the login URL only when user is Administrator", "content_type": "mixed", "has_code": true, "token_count": 221}
{"chunk_id": "09_bench_cli__bench__frappe-commands__007", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Site Operations, Debugging and Development", "content": "## Site Operations, Debugging and Development\n\nHere are some operations you can perform on your site via the Bench CLI to update your site state. You may never have to use some of these, but they exist just in case.\n\n* **add-system-manager**: Add a new system manager to a site.\n* **add-user**: Add a new User with specific roles to a site.\n* **add-to-hosts**: Add the specified site to the hosts file on your system.\n* **build-search-index**: Builds search index for Websites. Refer to [Full Text Search API Docs](/framework/v14/user/en/api/full-text-search) for more information.\n* **disable-user**: Disable user on site.\n* **publish-realtime**: Publish realtime event from bench.\n* **reload-doc**: Reload schema for a particular *Doctype* and refresh the specified *Document*\n* **reload-doctype**: Reload schema for a particular *DocType*\n* **remove-from-installed-apps**: Removes the mentioned app from the site gloabl value of `installed_applications`.\n* **run-patch**: Run a particular patch via the Frappe Patch Handler.\n* **migrate-to**: Command to migrate your local site to a Frappe Hosting Provider's service.\n* **ngrok**: Create a temporary URL and share it with anyone, and they can access your local site in their browser. Primarily built for aiding with the development of third party services.\n* **set-password**: Set the password for any user.\n* **set-admin-password**: Set the password for the Administrator user.\n* **set-last-active-for-user**: Set users last active date to current datetime.\n* **start-recording**: Starts the Frappe Recorder for the specified sites.\n* **stop-recording**: Terminates the Frappe Recorder for the specified sites.\n* **use**: Sets the default site on the bench.\n\n### Database Maintenance Commands\n\nSet of commands that are related to database management and maintenance. These commands offer more control to your site's database. You may want to fine-tune your deployment to fit your site's needs over time.", "content_type": "prose", "has_code": false, "token_count": 489}
{"chunk_id": "09_bench_cli__bench__frappe-commands__008", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Table Transformations", "content": "## Table Transformations\n\nThe `transform-database` command allows you to manage the settings of your site's tables. At this point, you can switch `engine` and `row_format` settings for select tables on your site database.\n\n```python\nbench --site {site} transform-database --tables {tables}\n```\n\nFor more information and examples, see the [bench transform-database](/framework/v14/user/en/bench/reference/transform-database) reference.\n\n### Table Trimming\n\nDocfields removed from a particular DocType may not be deleted from their Database tables. This is by design to prevent premature data loss in Frappe. This won't be problematic for the most part, however, at some point you may face issues due to this lingering data.\n\nSome benefits of regular table trimming are:\n\n* Smaller backup sizes\n* Reduced time taken to backup sites\n* Reduced Site Database Usages\n* Optimized queries in case of `SELECT *`\n* Database is clean and doesn't have anything hidden or redundant data\n\n```python\nbench trim-tables [OPTIONS]\n```\n\nFor more information and examples, see the [bench trim-tables](/framework/v14/user/en/bench/reference/trim-tables) reference.", "content_type": "mixed", "has_code": true, "token_count": 285}
{"chunk_id": "09_bench_cli__bench__frappe-commands__009", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Database Trimming", "content": "## Database Trimming\n\nDeleting DocTypes from the list view may not delete their corresponding tables from the database. Migrations may leave ghost tables in your Site Database at times. This may be done for the sake of redundancy, for recovery in case your data is corrupted or lost, or simply, in cases of human error.\n\n```python\nbench trim-database [OPTIONS]\n```\n\nFor more information and examples, see the [bench trim-database](/framework/v14/user/en/bench/reference/trim-database) reference.\n\n### Scheduler Commands\n\nCommands to manage and review the scheduler and background jobs' statuses for the sites on your bench. Defined under module `frappe.commands.schedule`.\n\n* **disable-scheduler**: Disable scheduler for specified sites.\n* **doctor**: Get diagnostic info about the status of the scheduler for all sites (if unspecified) and active workers on bench.\n* **enable-scheduler**: Enables scheduler for specified sites.\n* **purge-jobs**: Purge any pending periodic tasks, if the event option is not given, it will purge everything for the site.\n* **ready-for-migration**: Checks if a particular site is ready for migration by checking the existence of any pending background jobs.\n* **scheduler**: Change the state of the scheduler for any site from *pause*, *resume*, *disable* or *enable* state.\n* **set-maintenance-mode**: Set the value for maintenance mode in the config for specified sites.\n* **show-pending-jobs**: Get diagnostic info about background jobs.\n* **schedule**: Start the scheduler process for your bench. This process manages scheduler events defined in the `hooks.py` file. You can find this command mentioned in the bench config for your process manager too.\n* **worker**: Start worker process on your bench. The process this starts will manage all background jobs started on this bench.\n* **trigger-scheduler-event**: Trigger a specific scheduler event for the specified sites.\n\n### Frappe Utility Commands\n\nFrappe Utility commands that can be both, site or bench specific. These commands are defined under the module `frappe.commands.utils`.", "content_type": "mixed", "has_code": true, "token_count": 518}
{"chunk_id": "09_bench_cli__bench__frappe-commands__010", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Displaying Site Config", "content": "## Displaying Site Config\n\nThe applied configuration for your sites gets applied as a combination of the bench directory's `common_site_config.json` and the site's own `site_config.json`. You can read more about this, [here](/framework/v14/user/en/basics/site_config). Bench provides an interface to view the applied `frappe.conf` values for your sites. You may choose to access this information in tabular or JSON formats.\n\n```python\nbench --site {site} show-config\n```\n\nFor more information and examples, see the [bench show-config](/framework/v14/user/en/bench/reference/show-config) reference.\n\n### Updating Site Config\n\nBench provides a wrapper command to insert or update values in the site config files. You can update values in your site's `site_config.json`, along with the bench directory's `common_site_config.json` through the same command.\n\n```python\nbench --site {site} set-config KEY VALUE\n```\n\nFor more information and examples, see the [bench set-config](/framework/v14/user/en/bench/reference/set-config) reference.\n\n### Display Version Of Installed Apps\n\nThe `version` command displays all installed apps and their versions.\n\n```python\nbench version [OPTIONS]\n```\n\nWith version 13, the `-f` / `--format` option was introduced. This option allows you to display additional information about the branch and last commit. For more information and examples, see the [bench version](/framework/v14/user/en/bench/reference/bench-version) reference.", "content_type": "mixed", "has_code": true, "token_count": 365}
{"chunk_id": "09_bench_cli__bench__frappe-commands__011", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "More Commands", "content": "## More Commands\n\n* **add-to-email-queue**: Add an email to the Email Queue.\n* **build**: Builds assets for the Frappe Applications installed on bench.\n* **bulk-rename**: Rename multiple records via a CSV file. *Example File Format (Without Header)*:\n\n| Old Name | New Name | Merge |\n| --- | --- | --- |\n| HR-EMP-00001 | EMP0001 | FALSE |\n| HR-EMP-00002 | EMP0002 | FALSE |\n| HR-EMP-00003 | EMP0003 | FALSE |\n| HR-EMP-00004 | EMP0004 | FALSE |\n| HR-EMP-00005 | EMP0005 | FALSE |\n| HR-EMP-00006 | EMP0006 | FALSE |\n\n* **clear-cache**: Clear cache, doctype cache and defaults.\n* **clear-website-cache**: Clear Website cache.\n* **console**: Starts an IPython console for the site. Use with the `--autoreload` flag to reload changes to code automatically.\n* **data-import**: Import documents in bulk from CSV or XLSX using data import.\n* **destroy-all-sessions**: Clear sessions of all users (logs them out).\n* **execute**: Execute a particular function or method with a given set of `args` and `kwargs`.\n* **export-csv**: Export data import template with data for DocType.\n* **export-doc**: Export a single document to CSV.\n* **export-fixtures**: Export records from a site to your Frappe Application, as JSON files. Fixtures are defined in your app's `hooks.py` file.\n* **export-json**: Export doclist as json to the given path, use '-' as name for Singles.\n* **import-csv**: Import from your CSV file using data import.\n* **import-doc**: Import (insert/update) doclist. If the argument is a directory, all files ending with `.json` are imported\n* **jupyter**: Starting a Jupyter Notebook server.\n* **make-app**: Creates a boilerplate Frappe Application.\n* **db-console**: Start the interactive DB console for your site. This command is an alias over commands: mariadb, postgres\n* **mariadb**: Start the MySQL interactive console for the mysql site.\n* **postgres**: Start the PostgreSQL interactive console for the postgres site.\n* **rebuild-global-search**: Setup help table in the current site (called after migrate).\n* **request**: Make a request as Administrator with Arguements to a Path.\n* **reset-perms**: Reset permissions for all DocTypes to their default settings.\n* **run-tests**: Run Python tests on the specified site.\n* **run-parallel-tests**: Run Python tests parallelly on CI.\n* **run-ui-tests**: Run Cypress UI tests.\n* **serve**: Start the webserver for the bench.\n* **watch**: Watch and concatenate JS and CSS files as and when they change.", "content_type": "prose", "has_code": false, "token_count": 614}
{"chunk_id": "09_bench_cli__bench__frappe-commands__012", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/frappe-commands", "title": "Frappe Commands", "section_heading": "Translation Commands", "content": "## Translation Commands\n\nSet of commands to manage translations for your multi-lingual deployments. These commands are defined under the module `frappe.commands.translate`.\n\n* **build-message-files**: Build message files for translation.\n* **get-untranslated**: Get untranslated strings for language.\n* **import-translations**: Import translations from file in standard format.\n* **new-language**: Create lang-code.csv for given Frappe Application.\n* **update-translations**: Update translations for set language between files.", "content_type": "prose", "has_code": false, "token_count": 131}
{"chunk_id": "09_bench_cli__bench__extending-the-cli__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/extending-the-cli", "title": "Extending The Cli", "section_heading": "", "content": "Along with the framework commands, Frappe's `bench_manager` module also searches\nfor any commands in your custom applications. Thereby, bench communicates with\nthe respective bench's Frappe which in turn will check for available commands in\nall of the applications.\n\nTo make your custom command available to bench, just create a `commands` module\nunder your parent module and write the command with a click wrapper and a\nvariable commands which contains a list of click functions, which are your own\ncommands.\n\nThe directory structure with a Frappe App `flags` may be visualized as:\n\n```python\nfrappe-bench\n|\u2500\u2500apps\n |\u2500\u2500 frappe\n \u251c\u2500\u2500 flags\n \u2502 \u251c\u2500\u2500 README.md\n \u2502 \u251c\u2500\u2500 flags\n \u2502 \u2502 \u251c\u2500\u2500 commands <------ commands module\n \u2502 \u251c\u2500\u2500 license.txt\n \u2502 \u251c\u2500\u2500 requirements.txt\n \u2502 \u2514\u2500\u2500 setup.py\n```\n\nThe commands module maybe a single file such as `commands.py` or a directory\nwith an `__init__.py` file. For a custom application of name 'flags', an example\nmay be given as\n\n```python\n# file_path: frappe-bench/apps/flags/flags/commands.py\nimport click\n\n@click.command('set-flags')\n@click.argument('state', type=click.Choice(['on', 'off']))\ndef set_flags(state):\n from flags.utils import set_flags\n set_flags(state=state)\n\ncommands = [\n set_flags\n]\n```\n\nand with the context of the current bench, this command maybe executed simply as\n\n```python\n\u279c bench set-flags\nFlags are set to state: 'on'\n```", "content_type": "mixed", "has_code": true, "token_count": 342}
{"chunk_id": "09_bench_cli__bench__reference__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference", "title": "Reference", "section_heading": "Site Commands", "content": "## Site Commands\n\nManual for the commands under Frappe & Bench, accessible via the Bench CLI.\n\n### Site Commands\n\n1. [new-site](/framework/v14/user/en/bench/reference/new-site)\n2. [drop-site](/framework/v14/user/en/bench/reference/drop-site)\n3. [migrate](/framework/v14/user/en/bench/reference/migrate)\n4. [backup](/framework/v14/user/en/bench/reference/backup)\n5. [reinstall](/framework/v14/user/en/bench/reference/reinstall)\n6. [list-apps](/framework/v14/user/en/bench/reference/list-apps)\n7. [install-app](/framework/v14/user/en/bench/bench-commands#install-apps)\n8. [uninstall-app](/framework/v14/user/en/bench/reference/uninstall-app)\n9. [show-config](/framework/v14/user/en/bench/reference/show-config)\n10. [set-config](/framework/v14/user/en/bench/reference/set-config)\n11. [restore](/framework/v14/user/en/bench/reference/restore)\n12. [partial-restore](/framework/v14/user/en/bench/reference/partial-restore)\n\n### Frappe Utility Commands\n\n1. [version](/framework/v14/user/en/bench/reference/bench-version)\n\n### Database Maintenance Commands\n\n1. [transform-database](/framework/v14/user/en/bench/reference/transform-database)\n2. [trim-database](/framework/v14/user/en/bench/reference/trim-database)\n3. [trim-tables](/framework/v14/user/en/bench/reference/trim-tables)", "content_type": "prose", "has_code": false, "token_count": 318}
{"chunk_id": "09_bench_cli__bench__reference__new-site__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/new-site", "title": "New Site", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench new-site [OPTIONS] SITE\n```\n\n### Description\n\nCreate a new Frappe site. This operation creates a new folder under `./sites`\nwhich will contain all the site information for the site and also creates a new\ndatabase in your DBMS with all of Frappe's Modules and DocTypes installed.\n\nThe site config, which can be found under `./sites/{site}/site_config.json`\nmaintains information about the site's state. For more information about it,\ncheckout [this guide](/framework/v14/user/en/introduction).\n\n### Options\n\n* `--db-name` Set the Database name for new site\n* `--db-password` Set the Database password for new site\n* `--db-type` Select the Database Type for new site, options being \"postgres\"\n  or \"mariadb\". Default is \"mariadb\"\n* `--db-host` Set Database Host for new site\n* `--db-port` Set Database Port for new site\n* `--db-root-username` Specify Root username for MariaDB or Postgres\n* `--db-root-password` Specify Root password for MariaDB or Postgres\n* `--admin-password` Specify the Administrator password for new site\n* `--source_sql` Initiate database with a SQL file\n* `--install-app` Install app after installation\n\n### Flags\n\n* `--no-mariadb-socket` Set MariaDB host to % and use TCP/IP Socket instead of\n  using the UNIX Socket\n* `--verbose` Add Verbosity\n* `--force` Force restore if the site or a database with the same name already\n  exists", "content_type": "mixed", "has_code": true, "token_count": 345}
{"chunk_id": "09_bench_cli__bench__reference__new-site__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/new-site", "title": "New Site", "section_heading": "Examples", "content": "## Examples\n\n1. Create a new site.\n\n```python\nbench new-site {site}\n```\n\n1. Create a new *PostgreSQL* site.\n\n```python\nbench new-site {site} --db-type postgres\n```\n\n1. Create a new site while skipping the interactive prompts for\n\n* Submitting the Site's *Administrator* Password\n* Submitting the *MariaDB Root* Password\n\n```python\nbench new-site {site}\n--admin-password {admin-password}\n--db-root-password {mariadb-password}\n```\n\n1. Create a new site with non-default and autogenerated values.\n\n```python\nbench new-site {site} --db-type {type}\n--db-name {name}\n--db-password {pass}\n--db-host {host}\n--db-port {port}\n```\n\n1. Create a new site with a MariaDB non-root user with database creation\n   priveledges.\n\n```python\nbench new-site {site}\n--db-root-username {user}\n--db-root-password {pass}\n```\n\n1. Create a new site with an app *(available on current bench)* installed.\n\n```python\nbench new-site {site} --install-app {app}\n```", "content_type": "mixed", "has_code": true, "token_count": 232}
{"chunk_id": "09_bench_cli__bench__reference__drop-site__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/drop-site", "title": "Drop Site", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench drop-site [OPTIONS] SITE\n```\n\n### Description\n\nDrop an existing site. In this operation, the database is dropped and the\nrespective site's folder is moved from `./sites` to `./archived_sites` *(unless\nspecified otherwise)* on your Bench. A full site backup is taken prior to this.\n\n### Options\n\n* `--db-root-username` Username for a DBMS user with drop database privileges.\n  Defaults to *root*\n* `--db-root-password` Password for the DBMS user\n* `--archived-sites-path` Specify the path to move the site's folder in\n\n### Flags\n\n* `--no-backup` Skip backup prior to site drop\n* `--force` Force drop-site even if an error is encountered\n\n### Examples\n\n1. Skip the interactive prompt by passing the root password.\n\n```python\nbench drop-site {site} --db-root-password {db-root-pass}\n```\n\n1. Skip taking a backup before site deletion.\n\n```python\nbench drop-site {site} --no-backup\n```\n\n1. Move the site's folder in a different folder instead of the standard\n   `./archived_sites`.\n\n```python\nbench drop-site {site} --archived-sites-path {path/to/archive}\n```", "content_type": "mixed", "has_code": true, "token_count": 270}
{"chunk_id": "09_bench_cli__bench__reference__migrate__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/migrate", "title": "Migrate", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench migrate [OPTIONS]\n```\n\n### Description\n\nThe migrate command updates the site's state to the current available apps. It\nperforms a range of tasks, in order:\n\n* Run `before_migrate` Hooks\n* Run Application Patches\n* Synchronize Database Schema and Background Jobs\n* Synchronize Fixtures\n* Synchronize Dashboards, Desktop Icons and Web Pages\n* Updates Translations\n* Rebuild Search Index for all routes\n* Run `after_migrate` Hooks\n\nThis operation also updates the `touched_tables.json` file for the respective\nfile and updates the App Versions in the \"Installed Applications\" DocType.\n\n### Flags\n\n* `--skip-failing` Skip patches that fail to run\n* `--skip-search-index` Skip search indexing for web documents\n\n### Examples\n\n1. Run migrations on an existing site.\n\n```python\nbench --site {site} migrate\n```\n\n1. Run migrations skipping rebuilding search index for web documents\n\n```python\nbench --site {site} migrate --skip-search-index\n```\n\n2. Run migrations skipping any failing patches.\n\n```python\nbench --site {site} migrate --skip-failing\n```\n\n> Note: Skipping failing patches is not recommended for production use", "content_type": "mixed", "has_code": true, "token_count": 285}
{"chunk_id": "09_bench_cli__bench__reference__backup__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/backup", "title": "Backup", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench backup [OPTIONS]\n```\n\n### Description\n\nBackup sites specified. Executing the vanilla command will create a database\ndump, compress it and save the data under the default backup location\n`./sites/{site}/private/backups`.\n\nIn case a current site is set, simply running `bench backup` command will backup\nthat site.\n\n### Options\n\n* `--backup-path` Set path for saving all the files in this operation\n* `--backup-path-db` Set path for saving database file\n* `--backup-path-conf` Set path for saving config file\n* `--backup-path-files` Set path for saving public file\n* `--backup-path-private-files` Set path for saving private file\n* `--exclude`, `-e` Specify the DocTypes to not backup seperated by commas\n* `--only`, `--include`, `-i` Specify the DocTypes to backup seperated by commas\n\n### Flags\n\n* `--ignore-backup-conf` Ignore excludes/includes set in config\n* `--with-files` Take backup with private and public files\n* `--compress` Compress private and public files\n* `--verbose` Add verbosity", "content_type": "mixed", "has_code": true, "token_count": 255}
{"chunk_id": "09_bench_cli__bench__reference__backup__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/backup", "title": "Backup", "section_heading": "Examples", "content": "## Examples\n\n1. Backing up with the site's private and public files.\n\n```python\nbench --site {site} backup --with-files\n```\n\n1. Compress the public and private files (if required). This saves the file\n   under a `tgz` format instead of the default `tar` format.\n\n```python\nbench --site {site} backup --with-files --compress\n```\n\n1. Change the path where the files backed up will be saved.\n\n```python\nbench --site {site} backup --backup-path {backup_path}\n```\n\n1. Change the path for a specific backup file. For each unspecified option, the\n   respective file will be saved in the default location.\n\n```python\nbench --site {site} backup --with-files\n--backup-path-conf {conf_path}\n--backup-path-db {db_path}\n--backup-path-files {files_path}\n--backup-path-private-files {private_path}\n```\n\n1. Add verbosity for the various stages managed internally via the Bench CLI.\n\n```python\nbench --site {site} backup --verbose\n```\n\n1. Backup only certain doctypes on the site.\n\n```python\nbench --site {site} backup --only 'ToDo,Note,Task,Project,Sales Invoice'\n```\n\n1. Backup all tables except certain doctypes.\n\n```python\nbench --site {site} backup --exclude 'Error Log,Access Log,Activity Log,Version'\n```\n\n1. Backup complete site ignoring the `frappe.conf.backup.*` values if specified.\n\n```python\nbench --site {site} backup --ignore-backup-conf\n```", "content_type": "mixed", "has_code": true, "token_count": 334}
{"chunk_id": "09_bench_cli__bench__reference__reinstall__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/reinstall", "title": "Reinstall", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench reinstall [OPTIONS]\n```\n\n### Description\n\nReinstall a site with the current apps. This will wipe all site data and start\nafresh. This is considered a destructive operation, hence, contains an\ninteractive confirmation prompt by default.\n\n> Note: This feature only exists for **MariaDB** sites currently. In the future,\n> they may be extended for **PostgreSQL** support as well.\n\n### Options\n\n* `--admin-password` Administrator Password for reinstalled site\n* `--mariadb-root-username` Root username for MariaDB\n* `--mariadb-root-password` Root password for MariaDB\n\n### Flags\n\n* `--yes` Skip confirmation for reinstall\n\n### Examples\n\n1. Reinstall a site skipping the prompts for:\n\n* Confirmation for operation\n* MariaDB Root Password\n* Administrator Password\n\n```python\nbench reinstall {site} --yes\n--mariadb-root-password {db-pass}\n--admin-password {admin-pass}\n```\n\n1. Reinstall a site using an alternative user with *DBMS SUPER* privileges.\n\n```python\nbench reinstall\n--mariadb-root-username {db-user}\n--mariadb-root-password {db-pass}\n```", "content_type": "mixed", "has_code": true, "token_count": 266}
{"chunk_id": "09_bench_cli__bench__reference__list-apps__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/list-apps", "title": "List Apps", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench list-apps [OPTIONS]\n```\n\n### Description\n\nList all the Frappe Applications installed on the specified site. The\ninformation shown by the command is fetched from the **Installed Applications**\nDocType which tracks the latest version of the apps, the site was migrated to.\nThe global default `installed_apps` is used as fallback.\n\nMulti-site support has been added in Version 13. To see the summary for all\nsites, run the command with site's value as `all`.\n\n### Options\n\n* `--format`, `-f` Choose the format for listing apps installed on the\n  specified site, options being \"text\" and \"json\". Default is \"json\".\n\n### Examples\n\n1. List apps installed on all sites.\n\n```python\nbench --site all list-apps\n```\n\n1. List apps installed on all sites in parsable JSON format.\n\n```python\nbench --site all list-apps --format json\n```\n\n1. List apps installed on a specific site in text format.\n\n```python\nbench --site {site} list-apps --format text\n```\n\n```python\nbench --site {site} list-apps -f text\n```\n\n```python\nbench --site {site} list-apps\n```", "content_type": "mixed", "has_code": true, "token_count": 266}
{"chunk_id": "09_bench_cli__bench__reference__uninstall-app__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/uninstall-app", "title": "Uninstall App", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench uninstall-app [OPTIONS] APP\n```\n\n### Description\n\nRemove Application and linked doctypes, modules from the site. Executing the\nvanilla command will check if the app exists on site before attempting to delete\nits modules and doctypes. The application may not be necessarily installed on\nthe bench to run the `uninstall-app` command.\n\n### Flags\n\n* `-y`, `--yes` To bypass confirmation prompt for uninstalling the app\n* `--dry-run` List all doctypes that will be deleted\n* `--no-backup` Do not backup the site\n* `--force` Force remove the app from site\n\n### Examples\n\n1. Perform a dry run to see what would happen on running it on a particular\n   site.\n\n```python\nbench --site {site} uninstall-app {app} --dry-run\n```\n\n1. Don't take a backup before the application uninstall operation.\n\n```python\nbench --site {site} uninstall-app {app} --no-backup\n```\n\n1. Use force to uninstall application from site.\n\n```python\nbench --site {site} uninstall-app {app} --force\n```\n\n2. Skip the interactive prompt for confirmation of uninstall.\n\n```python\nbench --site {site} uninstall-app {app} --yes\n```", "content_type": "mixed", "has_code": true, "token_count": 278}
{"chunk_id": "09_bench_cli__bench__reference__show-config__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/show-config", "title": "Show Config", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench show-config [OPTIONS]\n```\n\n### Description\n\nThe applied configuration for your sites gets applied as a combination of the bench directory's `common_site_config.json` and the site's own `site_config.json`. Bench provides an interface to view the applied `frappe.conf` values for your sites. You may choose to access this information in tabular or JSON formats.\n\nTo read more about site configuration and understanding key precedence, refer to the docs [here](/framework/v14/user/en/basics/site_config).\n\n### Flags\n\n* `-f`, `--format` Choose the format for listing apps installed on the specified site, options being \"text\" and \"json\". Default is \"text\".\n\n### Examples\n\n1. Show site config for all sites in JSON format.\n\n```python\nbench --site all show-config -f json\n```\n\n2. Show the site config in tabular form.\n\n```python\nbench --site {site} show-config --format text\n```\n\n```python\nbench --site {site} show-config -f text\n```\n\n```python\nbench --site {site} show-config\n```", "content_type": "mixed", "has_code": true, "token_count": 250}
{"chunk_id": "09_bench_cli__bench__reference__set-config__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/set-config", "title": "Set Config", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench set-config [OPTIONS] KEY VALUE\n```\n\n### Description\n\nBench provides a wrapper command to insert or update values in the site config\nfiles. You can update values in your site's `site_config.json`, along with the\nbench directory's `common_site_config.json` through the same command.\n\nTo read more about site configuration and understanding key precedence, refer to\nthe docs [here](/framework/v14/user/en/basics/site_config).\n\n### Flags\n\n* `-g`, `--global` Set value in the Bench's Common Site Config\n* `-p`, `--parse` Parse given value instead of string. You can use this to set\n  dict and list values. This was `--as-dict` in earlier versions.\n\n### Examples\n\n1. Enable tests for given site.\n\n```python\nbench --site {site} set-config allow_tests true\n```\n\n1. Enable tests for all sites.\n\n```python\nbench --site all set-config allow_tests true\n```\n\nUsing the above command, each site's `site_config.json` will have the\nkey-value `\"allow_tests\": true`. This allows running tests on all of the\nsites.\n\n```python\nbench set-config -g allow_tests true\n```\n\nUsing the above command, the bench's `common_site_config.json` will have the\nkey-value `\"allow_tests\": true`. This will allow each site on the bench to\nhave tests run unless they have a value defined for the sma in their\n`site_config.json`.\n\n1. Set a dict value in your site's `frappe.conf`\n\n```python\nbench --site {site} set-config backup '{\"includes\": [\"Not\", \"ToDo\"]}' --parse\n```\n\nYou can now access the list in code as `frappe.conf.backup.get(\"includes\")`.", "content_type": "mixed", "has_code": true, "token_count": 384}
{"chunk_id": "09_bench_cli__bench__reference__restore__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/restore", "title": "Restore", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench restore [OPTIONS] SQL_FILE_PATH\n```\n\n### Description\n\nBench CLI can be used to restore an existing site to a previous state. Using the\n`bench restore` command, a site may be restored with the specific database and\nfile restores. Downgrades aren't supported for Frappe Sites; when a downgrade is\ndetected, an interactive prompt will pop up before the site restore begins.\n\nThe least requirement for performing a restore operation is having the database\nfile on your local filesystem. The specified path may be relative to the bench\nor sites folder, although absolute paths often work best.\n\nThe specified database backup file may have the `sql.gz` or `sql` extension. For\npublic and private file backup archives, the default is `tar`, but since **Version\n13**, compressed archives with the extension `tgz` are also supported.\n\n> Note: As of this point, there's no way to restore only files using this\n> command.\n\n### Arguments\n\n* `SQL_FILE_PATH` Path to the database source file. The path may be relative from\n  the bench directory root, or the sites folder. It may also be an absolute path.\n\n> To learn more about relative and absolute paths, on Wikipedia click [here](https://en.wikipedia.org/wiki/Path_(computing)#Absolute\\_and\\_relative\\_paths).", "content_type": "mixed", "has_code": true, "token_count": 318}
{"chunk_id": "09_bench_cli__bench__reference__restore__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/restore", "title": "Restore", "section_heading": "Options", "content": "## Options\n\n* `--db-root-username` Root username for MariaDB or Postgres\n* `--db-root-password` Root password for MariaDB or Postgres\n* `--db-name` Database name for site in case it is a new one\n* `--admin-password` Administrator password for new site\n* `--install-app` Install app after installation\n* `--with-public-files` Restores the public files of the site, given path to\n  its archive file\n* `--with-private-files` Restores the private files of the site, given path to\n  its archive file\n\n### Flags\n\n* `--force` Ignore the site downgrade warning, if applicable. This is **not\n  recommended** unless you're fully aware of the consequences\n\n### Examples\n\n1. Restore a site with files\n\n```python\nbench --site {site} restore {path/to/database/file}\n--with-public-files {path/to/public/archive}\n--with-private-files {path/to/private/archive}\n```\n\n1. Bypass DBMS root interactive prompt by passing values in options\n\n```python\nbench --site {site} restore {path/to/database/file}\n--db-root-username {db-user}\n--db-root-password {db-pass}\n```\n\n1. Specify new app to install after site restore\n\n```python\nbench --site {site} restore {path/to/database/file}\n--install-app {app}\n```\n\n1. Specify custom database name for the restored site\n\n```python\nbench --site {site} restore {path/to/database/file}\n--db-name {custom-db-name}\n```\n\n1. Reset the admin password for the restored site\n\n```python\nbench --site {site} restore {path/to/database/file}\n--admin-password {admin-pass}\n```", "content_type": "mixed", "has_code": true, "token_count": 368}
{"chunk_id": "09_bench_cli__bench__reference__partial-restore__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/partial-restore", "title": "Partial Restore", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench partial-restore [OPTIONS] SQL_FILE_PATH\n```\n\n### Description\n\nYou may want to restore only specific tables you've backed up to a site. You have\nlikely taken partial backups using the `--only`, `--exclude` options in `bench backup`.\n\nThe `partial-restore` command may be used to restore sites using partial backups. The\npartial backup files may be gzip compressed or plain SQL files. In essence, you can\nrestore anything from SQL files using this command.\n\n### Arguments\n\n* `SQL_FILE_PATH` Path to the database source file. The path may be relative from\n  the bench directory root, or the sites folder. It may also be an absolute path.\n\n> To learn more about relative and absolute paths, on Wikipedia click [here](https://en.wikipedia.org/wiki/Path_(computing)#Absolute\\_and\\_relative\\_paths).\n\n### Flags\n\n* `-v`, `--verbose` Add verbosity\n\n### Examples\n\n1. Restore with partial backups on a site.\n\n```python\nbench --site {site} partial-restore -v {/path/to/sql/file}\n```", "content_type": "mixed", "has_code": true, "token_count": 249}
{"chunk_id": "09_bench_cli__bench__reference__bench-version__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/bench-version", "title": "Bench Version", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench version [OPTIONS]\n```\n\n### Description\n\nThe `version` command displays compiled info about all the apps installed in the\ncurrent bench directory. You can choose your preferred output format: plain\ntext, JSON or ASCII table. The `--format plain` option displays version\ninformation as plain text, just like `bench version`, but with additional\ninformation.\n\n```python\n$ bench version --format plain\nerpnext 14.0.3 version-14 (4e88dcf)\nfrappe 14.0.1 version-14 (f8ec3d7)\n```\n\nThe `--format json` option displays version information as a formatted JSON\nstring. This is particularly useful if you're building tools over the bench CLI.\n\n```python\n$ bench version --format json\n[\n {\n \"app\": \"erpnext\",\n \"branch\": \"version-14\",\n \"commit\": \"4e88dcf\",\n \"version\": \"14.0.3\"\n },\n {\n \"app\": \"frappe\",\n \"branch\": \"version-14\",\n \"commit\": \"ef0a5e9\",\n \"version\": \"14.0.1\"\n }\n]\n```\n\nThe `--format table` option displays version information formatted as an ASCII\ntable.\n\n```python\n$ bench version --format table\n+-------------------------+------------+------------------------------+---------+\n| App | Version | Branch | Commit |\n+-------------------------+------------+------------------------------+---------+\n| erpnext | 14.0.3 | version-14 | 4e88dcf |\n| frappe | 14.0.1 | version-14 | f8ec3d7 |\n+-------------------------+------------+------------------------------+---------+\n```\n\n### Options\n\n* `-f`, `--format` Choose the format for showing versions of the apps\n  installed in the current bench. The available options are \"plain\", \"table\",\n  \"json\", \"legacy\". This value defaults to \"legacy\".\n\n### Examples\n\n1. Get human readable information about the installed apps on current bench,\n   with commit messages.\n\n```python\nbench version --format plain\n```\n\n1. Get bench version information in `JSON` format.\n\n```python\nbench version -f json\n```", "content_type": "mixed", "has_code": true, "token_count": 464}
{"chunk_id": "09_bench_cli__bench__reference__transform-database__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/transform-database", "title": "Transform Database", "section_heading": "Usage", "content": "## Usage\n\n> This command is added in **Version 14**, and supports only **MariaDB**\n\n### Usage\n\n```python\nbench transform-database [OPTIONS] table\n```\n\n### Description\n\nThe `transform-database` command allows you to manage the settings of your site's tables. At this point, you can switch engines and row\\_format settings for select tables on your site database.\n\n> MariaDB 10.6 deprecated the COMPRESSED ROW\\_FORMAT which was Frappe's default option for a very long time. This command was added to handle upgrades to later versions of MariaDB. For more information on this, refer to the [PR](https://github.com/frappe/frappe/pull/13954).\n\n### Options\n\n* `--table` Comma separated name of tables to convert. To convert all tables, pass 'all' **[required]**\n* `--engine` Choice of storage engine for said table(s). Options available are *InnoDB* and *MyISAM*.\n* `--row_format` Set *ROW\\_FORMAT* parameter for said table(s). Options available are *DYNAMIC*, *COMPACT*, *REDUNDANT*, *COMPRESSED*.\n\n### Flags\n\n* `failfast` Exit on first failure occurred", "content_type": "mixed", "has_code": true, "token_count": 262}
{"chunk_id": "09_bench_cli__bench__reference__transform-database__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/transform-database", "title": "Transform Database", "section_heading": "Examples", "content": "## Examples\n\n1. Consider a scenario where you'd want to change the engine of a table *\"tabAccess Record\"* to `MyISAM`. You may want to do this if it's a log table that's dealing with huge volumes of writes and very little reads.\n\n```python\nbench --site {site} transform-database --table 'tabAccess Record' --engine 'MyISAM'\n```\n\n1. You've upgraded MariaDB on your current server from 10.3 to 10.7. You're going to have to convert all the tables that used the COMPRESSED row\\_format to the new default, ie `DYNAMIC`. You'd want to run the following command.\n\n```python\nbench --site {site} transform-database --table 'all' --row_format 'DYNAMIC'\n```", "content_type": "mixed", "has_code": true, "token_count": 161}
{"chunk_id": "09_bench_cli__bench__reference__trim-database__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/trim-database", "title": "Trim Database", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench trim-database [OPTIONS]\n```\n\n### Description\n\nDeleting DocTypes from the list view may not delete their corresponding tables from\nthe database. Migrations may leave ghost tables in your Site Database at times. This\nmay be done for the sake of redundancy, for recovery in case your data is corrupted\nor lost, or simply, in cases of human error.\n\nThis command drops any tables that seem to be remnants like the above mentioned. It will\nattempt a partial backup of the tables before dropping them. In case, these tables were\nrequired, and were dropped errenously, you can restore them in your site's database using\nthe [`partial-restore`](/framework/v14/user/en/bench/reference/partial-restore) command.\n\n### Options\n\n* `--format`, `-f` Set output format. Available options are JSON and Table. Defaults to Table.\n\n### Flags\n\n* `--dry-run` Show what would be deleted.\n* `--no-backup` Do not backup the site prior to the trimming.\n\n### Examples\n\n1. You want to figure out what data will be deleted if you run this command? Run it with the\n   `--dry-run` flag.\n\n```python\nbench --site {site} trim-database --dry-run\n```\n\n1. Want to build over this command and need the data to be machine parsable? Set the output\n   `--format` to **json**.\n\n```python\nbench --site {site} trim-database --format json\n```", "content_type": "mixed", "has_code": true, "token_count": 330}
{"chunk_id": "09_bench_cli__bench__reference__trim-tables__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/reference/trim-tables", "title": "Trim Tables", "section_heading": "Usage", "content": "## Usage\n\n```python\nbench trim-tables [OPTIONS]\n```\n\n### Description\n\nDocfields removed from a particular DocType may not be deleted from their\nDatabase tables. This is by design to prevent premature data loss in Frappe.\nThis won't be problematic for the most part, however, at some point you may face\nissues due to this lingering data.\n\nSome benefits of regular table trimming are:\n\n* Smaller backup sizes\n* Reduced time taken to backup sites\n* Reduced Site Database Usages\n* Optimized queries in case of `SELECT *`\n* Database is clean and doesn't have anything hidden or redundant data\n\nThis command modifies the schema of tables in your site's database. It will by default,\ntake a full backup of your entire database before modifying them. In case, these tables\nwere modified errenously, you can restore your site to it's original state using\nthe [`restore`](/framework/v14/user/en/bench/reference/restore) command.\n\n### Options\n\n* `--format`, `-f` Set output format. Available options are JSON and TEXT.\n  Defaults to TEXT.\n\n### Flags\n\n* `--dry-run` Show what would be deleted\n* `--no-backup` Do not backup the site. This is not recommended since this is a\n  destructive operation.\n\n### Examples\n\n1. There maybe a lot of lingering columns taking up the space. Perhaps you figured this out\n   when you got an error that row size limit has reached while customizing your DocType. To\n   be sure that there aren't any ghost columns, or old hidden fields taking up the space, you\n   can be sure by running\n\n```python\nbench --site {site} trim-tables --dry-run\n```", "content_type": "mixed", "has_code": true, "token_count": 390}
{"chunk_id": "09_bench_cli__bench__guides__adding-custom-domains__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/adding-custom-domains", "title": "Adding Custom Domains", "section_heading": "", "content": "You can add **multiple custom domains** for your site, just run:\n\nbench setup add-domain [desired-domain]\n\nOn running the command you will be asked for which site you want to set the custom domain for.\n\nYou can also setup SSL for your custom domain by using the options:\n\n--ssl-certificate [path-to-certificate]\n--ssl-certificate-key [path-to-certificate-key]\n\nExample:\n\nbench setup add-domain custom.erpnext.com --ssl-certificate /etc/letsencrypt/live/erpnext.cert --ssl-certificate-key /etc/letsencrypt/live/erpnext.key\n\nDomain configuration is stored in the respective site's site\\_config.json\n\n\"domains\": [\n{\n\"ssl\\_certificate\": \"/etc/letsencrypt/live/erpnext.cert\",\n\"domain\": \"erpnext.com\",\n\"ssl\\_certificate\\_key\": \"/etc/letsencrypt/live/erpnext.key\"\n}\n],\n\n**You will need to regenerate the nginx configuration by runnning `bench setup nginx` and reload the nginx service by running `sudo service nginx reload` to put your custom domain in effect**", "content_type": "prose", "has_code": false, "token_count": 238}
{"chunk_id": "09_bench_cli__bench__guides__configuring-https__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/configuring-https", "title": "Configuring Https", "section_heading": "Get the required files", "content": "## Get the required files\n\nYou can get a SSL certificate from a trusted Certificate Authority or generate your own. For self signed certificates the browser will show a warning that the certificate is not trusted. [Here's a tutorial for using Let's Encrypt to get a free SSL Certificate](lets-encrypt-ssl-setup.html)\n\nThe files required are\n\n* Certificate (usually with extension .crt)\n* Decrypted private key\n\n### Prequisites\n\n1. You need to have a [DNS Multitenant Setup](https://frappe.io/docs/v14/user/en/bench/guides/setup-multitenancy)\n2. Your site should be accessible via a valid domain\n3. You need root permissions on your server\n4. You need a valid certificate generated through a trusted Certificate Authority or a Self-Signed Certificate.\n\nTo generate .crt from private authority, generally you would have to generate a CSR (Certificate Signing Request). You may skip this step if you already have a certificate (.crt) file. To generate a CSR and the corresponding key file, run the following command:\n\nopenssl req -new -newkey rsa:2048 -nodes -keyout mydomain.com.key -out mydomain.com.csr\n\nYou need to upload this CSR (.csr) file to the private certificate authority (eg. GoDaddy, ComodoSSL) to generate a valid certificate (.crt) file against it.\n\nIf you have multiple certificates (primary and intermediate), you will have to concatenate them. For example:\n\ncat your\\_certificate.crt CA.crt >> certificate\\_bundle.crt\n\nAlso make sure that your private key is readable only by the root user:\n\nchown root private.key\nchmod 600 private.key\n\n### Move the two files to an appropriate location\n\nmkdir /etc/nginx/conf.d/ssl\nmv private.key /etc/nginx/conf.d/ssl/private.key\nmv certificate\\_bundle.crt /etc/nginx/conf.d/ssl/certificate\\_bundle.crt\n\n### Setup nginx config\n\nSet the paths to the certificate and private key for your site\n\nbench set-ssl-certificate site1.local /etc/nginx/conf.d/ssl/certificate\\_bundle.crt\nbench set-ssl-key site1.local /etc/nginx/conf.d/ssl/private.key\n\n### Generate nginx config\n\nbench setup nginx\n\n### Reload nginx\n\nsudo service nginx reload\n\nor\n\nsystemctl reload nginx # for CentOS 7\n\nNow that you have configured SSL, all HTTP traffic will be redirected to HTTPS", "content_type": "prose", "has_code": false, "token_count": 551}
{"chunk_id": "09_bench_cli__bench__guides__diagnosing-the-scheduler__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/diagnosing-the-scheduler", "title": "Diagnosing The Scheduler", "section_heading": "bench doctor", "content": "## bench doctor\n\nIf you're experiencing delays in scheduled jobs or they don't seem to run, you can run the several commands to diagnose the issue.\n\n### bench doctor\n\nThis will output the following in order:\n\n* Scheduler Status per site\n* Number of Workers\n* Pending Tasks\n\nDesirable output:\n\nWorkers online: 0\n-----None Jobs-----\n\n### bench --site [site-name] show-pending-jobs\n\nThis will output the following in order:\n\n* Queue\n* Tasks within Queue\n\nDesirable output:\n\n-----Pending Jobs-----\n\n### bench purge-jobs\n\nThis will remove all pending jobs from all queues", "content_type": "prose", "has_code": false, "token_count": 141}
{"chunk_id": "09_bench_cli__bench__guides__lets-encrypt-ssl-setup__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/lets-encrypt-ssl-setup", "title": "Lets Encrypt Ssl Setup", "section_heading": "Prerequisites", "content": "## Prerequisites\n\n1. You need to have a [DNS Multitenant Setup](https://frappe.io/docs/v14/user/en/bench/guides/setup-multitenancy)\n2. Your site should be accessible via a valid domain\n3. You need root permissions on your server\n\n**Note : Let's Encrypt Certificates expire every three months**\n\n### Using Bench Command\n\nJust run:\n\nsudo -H bench setup lets-encrypt [site-name]\n\nYou will be faced with several prompts, respond to them accordingly. This command will also add an entry to the crontab of the root user *(this requires elevated permissions)*, that will attempt to renew the certificate every month.\n\n### Custom Domains\n\nYou can setup Let's Encrypt for [custom domains](adding-custom-domains.html) as well. Just use the `--custom-domain` option\n\nsudo -H bench setup lets-encrypt [site-name] --custom-domain [custom-domain]\n\n### Renew Certificates\n\nTo renew certificates manually you can use:\n\nsudo bench renew-lets-encrypt\n\n---\n\n### Download the appropriate Certbot-auto script into /opt\n\nhttps://certbot.eff.org/\n\n### Stop nginx service\n\n$ sudo service nginx stop", "content_type": "prose", "has_code": false, "token_count": 268}
{"chunk_id": "09_bench_cli__bench__guides__lets-encrypt-ssl-setup__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/lets-encrypt-ssl-setup", "title": "Lets Encrypt Ssl Setup", "section_heading": "Run Certbot", "content": "## Run Certbot\n\n$ ./opt/certbot-auto certonly --standalone\n\nAfter letsencrypt initializes, you will be prompted for some information. This exact prompts may vary depending on if you've used Let's Encrypt before, but we'll step you through the first time.\n\nAt the prompt, enter an email address that will be used for notices and lost key recovery:\n\n![](https://assets.digitalocean.com/articles/letsencrypt/le-email.png)\n\nThen you must agree to the Let's Encrypt Subscribe Agreement. Select Agree:\n\n![](https://assets.digitalocean.com/articles/letsencrypt/le-agreement.png)\n\nThen enter your domain name(s). Note that if you want a single cert to work with multiple domain names (e.g. example.com and www.example.com), be sure to include all of them:\n\n![](https://assets.digitalocean.com/articles/letsencrypt/le-domain.png)\n\n### Certificate Files\n\nAfter obtaining the cert, you will have the following PEM-encoded files:\n\n* **cert.pem**: Your domain's certificate\n* **chain.pem**: The Let's Encrypt chain certificate\n* **fullchain.pem**: cert.pem and chain.pem combined\n* **privkey.pem**: Your certificate's private key\n\nThese certificates are stored under `/etc/letsencrypt/live/example.com` folder\n\n### Configure the certificates for your site(s)\n\nGo to your erpnext sites site\\_config.json\n\n$ cd frappe-bench/sites/\n\nAdd the following two lines to your site\\_config.json\n\n\"ssl\\_certificate\": \"/etc/letsencrypt/live/example.com/fullchain.pem\",\n\"ssl\\_certificate\\_key\": \"/etc/letsencrypt/live/example.com/privkey.pem\"\n\nRegenerate the nginx configuration\n\n$ bench setup nginx\n\nRestart the nginx server\n\n$ sudo service nginx restart\n\n---\n\n### Auto renewal (experimental)\n\nLogin as root or a user with superuser privileges, run `crontab -e` and enter:\n\n### renew letsencrypt certificates on 1st monday of every month and get an email if it gets executed\n\nMAILTO=\"mail@example.com\"\n0 0 1-7 \\* \\* [ \"$(date '+%a')\" = \"Mon\" ] && sudo service nginx stop && /opt/certbot-auto renew && sudo service nginx start", "content_type": "prose", "has_code": false, "token_count": 499}
{"chunk_id": "09_bench_cli__bench__guides__settings-limits__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/settings-limits", "title": "Settings Limits", "section_heading": "", "content": "> Note: This feature has been deprecated since Version 12\n\nFrappe v7 has added support for setting limits and restrictions for your site.\nThese restrictions are set in the `site_config.json` file inside the site's folder.\n\n{\n\"db\\_name\": \"xxxxxxxxxx\",\n\"db\\_password\": \"xxxxxxxxxxxx\",\n\"limits\": {\n\"emails\": 1500,\n\"space\": 0.157,\n\"expiry\": \"2016-07-25\",\n\"users\": 1\n}\n}\n\nYou can set a limit by running:\n\nbench --site [sitename] set-limit [limit] [value]\n\nYou can set multiple limits at the same time, by running\n\nbench --site [sitename] set-limits --limit [limit] [value] --limit [limit-2] [value-2]\n\nThe valid limits you can set are:\n\n* **users** - Limit on the number of maximum users for a site\n* **emails** - Limit on the number of emails sent per month from the site\n* **space** - Limit on the maximum space the site can use (GB)\n* **email\\_group** - Limit on the maximum number of members allowed in an Email Group\n* **expiry** - Expiry date for the site (YYYY-MM-DD within quotes)\n\nExample:\n\nbench --site site1.local set-limit users 5\n\nYou can check your usage by opening the \"Usage Info\" page from the toolbar / AwesomeBar. A limit will only show up on the page if it has been set.\n\n![Doctype Saved](/files/usage_info.png)", "content_type": "prose", "has_code": false, "token_count": 306}
{"chunk_id": "09_bench_cli__bench__guides__setup-multitenancy__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/setup-multitenancy", "title": "Setup Multitenancy", "section_heading": "Port based multitenancy", "content": "## Port based multitenancy\n\nAssuming that you've already got your first site running and you've performed\nthe [production deployment steps](setup-production.html), this section explains how to host your second\nsite (and more). Your first site is automatically set as default site. You can\nchange it with the command,\n\nbench use sitename\n\n### Port based multitenancy\n\nYou can create a new site and make run it on a different port (while the first\none runs on port 80).\n\n* Switch off DNS based multitenancy (once)\n\n`bench config dns_multitenant off`\n\n* Create a new site\n\n`bench new-site site2name`\n\n* Set port\n\n`bench set-nginx-port site2name 82`\n\n* Re generate nginx config\n\n`bench setup nginx`\n\n* Reload nginx\n\n`sudo service nginx reload`\n\n### DNS based multitenancy\n\nYou can name your sites as the hostnames that would resolve to it. Thus, all the sites you add to the bench would run on the same port and will be automatically selected based on the hostname.\n\nTo make a new site under DNS based multitenancy, perform the following steps.\n\n* Switch on DNS based multitenancy (once)\n\n`bench config dns_multitenant on`\n\n* Create a new site\n\n`bench new-site site2name`\n\n* Re generate nginx config\n\n`bench setup nginx`\n\n* Reload nginx\n\n`sudo service nginx reload`", "content_type": "prose", "has_code": false, "token_count": 315}
{"chunk_id": "09_bench_cli__bench__guides__setup-production__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/setup-production", "title": "Setup Production", "section_heading": "Easy Production Setup", "content": "## Easy Production Setup\n\n> **WARNING:** We DO NOT recommend installing on bare metal servers. Recommend way of setting up production sites is using docker images. You can find instructions here: <https://github.com/frappe/frappe#installation>\n\nYou can setup the bench for production use by configuring two programs, Supervisor and nginx. If you want to revert your Production Setup to Development Setup refer to [these commands](https://github.com/frappe/bench/wiki/Stopping-Production-and-starting-Development)\n\n### Easy Production Setup\n\nThese steps are automated if you run `sudo bench setup production`\n\n### Supervisor\n\nSupervisor makes sure that the process that power the Frappe system keep running and it restarts them if they happen to crash. You can generate the required configuration for supervisor using the command `bench setup supervisor`. The configuration will be available in `config/supervisor.conf` directory. You can then copy/link this file to the supervisor config directory and reload it for it to take effect.\n\neg,\n\n```python\nbench setup supervisor\nsudo ln -s `pwd`/config/supervisor.conf /etc/supervisor/conf.d/frappe-bench.conf\n```\n\nNote:\n\n* Use `--skip-redis` option if you do not need to generate config to start redis servers. e.g. `bench setup supervisor --skip-redis`\n* For CentOS 7, the extension should be `ini`, thus the command becomes\n\n```python\nbench setup supervisor\nsudo ln -s `pwd`/config/supervisor.conf /etc/supervisor/conf.d/frappe-bench.ini #for CentOS 7 only\n```\n\nThe bench will also need to restart the processes managed by supervisor when you update the apps. To automate this, you will have to setup sudoers using the command, `sudo bench setup sudoers $(whoami)`.", "content_type": "mixed", "has_code": true, "token_count": 428}
{"chunk_id": "09_bench_cli__bench__guides__setup-production__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/guides/setup-production", "title": "Setup Production", "section_heading": "Nginx", "content": "## Nginx\n\nNginx is a web server and we use it to serve static files and proxy rest of the requests to frappe. You can generate the required configuration for nginx using the command `bench setup nginx`. The configuration will be available in `config/nginx.conf` file. You can then copy/link this file to the nginx config directory and reload it for it to take effect.\n\neg,\n\n```python\nbench setup nginx\nsudo ln -s `pwd`/config/nginx.conf /etc/nginx/conf.d/frappe-bench.conf\n```\n\nNote: When you restart nginx after the configuration change, it might fail if you have another configuration with server block as default for port 80 (in most cases for the nginx welcome page). You will have to disable this config. Most probable places for it to exist are `/etc/nginx/conf.d/default.conf` and `/etc/nginx/conf.d/default`. In the latest nginx installs, the file is in `/etc/nginx/sites-available/default`", "content_type": "mixed", "has_code": true, "token_count": 224}
{"chunk_id": "09_bench_cli__bench__resources__background-services__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/background-services", "title": "Background Services", "section_heading": "System Processes", "content": "## System Processes\n\nRunning an active Frappe environment requires the running of various system\nlevel services and some Frappe processes.\n\nThe system level services, apart from your choice of database solutions and\nRedis will depend on your deployment architecture and strategy. As for the\nFrappe services, they are defined in the\n[Procfile](/framework/v14/user/en/bench/resources/bench-procfile) for development benches\nand config/supervisor.conf for production benches.\n\n### System Processes\n\nThese processes are handled at a system level and may have configs setup via\nbench or some other Frappe deployment management tool.\n\n* MariaDB/PostgreSQL (Database)\n* Redis (Queues for background workers, and Caching)\n* NGINX (Reverse Proxy for production deployment)\n* Supervisor (Process Management for bench's non containerized production deployment)", "content_type": "prose", "has_code": false, "token_count": 212}
{"chunk_id": "09_bench_cli__bench__resources__background-services__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/background-services", "title": "Background Services", "section_heading": "Frappe Processes", "content": "## Frappe Processes\n\nThese processes may be triggered manually or via a process manager. However,\nthey are defined in Frappe's codebase and are managed by the same.\n\n* WSGI Server\n\nThe WSGI server is responsible for responding to the HTTP requests to frappe. In\na development scenario, `bench serve` or `bench start` start the Werkzeug server.\nFor production setups, Bench uses Gunicorn (automatically configured in supervisor).\n\n* Redis Worker Processes\n\nThe worker processes execute background jobs in the Frappe system.\n\nThese processes are automatically started when `bench start` is run and for production\nare configured in supervisor configuration.\n\n* Scheduler Process\n\nThe Scheduler process schedules enqeueing of scheduled jobs in the Frappe\nsystem. This process is automatically started when `bench start` is run and for\nproduction are configured in supervisor configuration.", "content_type": "prose", "has_code": false, "token_count": 221}
{"chunk_id": "09_bench_cli__bench__resources__bench-commands-cheatsheet__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/bench-commands-cheatsheet", "title": "Bench Commands Cheatsheet", "section_heading": "Printable Bench CLI Cheatsheet", "content": "## Printable Bench CLI Cheatsheet\n\nGrab a A4 size printable cheatsheet of the most important Bench CLI commands [here](/files/Bench Cheatsheet v1.1.pdf). Download, print and put it on your desk!\n\n### General Usage\n\n* `bench --version` - Show bench version\n* `bench version` - Show version of all apps\n* `bench src` - Show bench repo directory\n* `bench --help` - Show all commands and help\n* `bench [command] --help` - Show help for command\n* `bench init [bench-name]` - Create a new bench (Run from home dir)\n* `--python TEXT` Path to Python Executable.\n* `--ignore-exist` Ignore if Bench instance exists.\n* `--apps_path TEXT` path to json files with apps to install after init\n* `--frappe-path TEXT` path to frappe repo\n* `--frappe-branch TEXT` Clone a particular branch of frappe\n* `--clone-from TEXT` copy repos from path\n* `--clone-without-update` copy repos from path without update\n* `--no-procfile` Pull changes in all the apps in bench\n* `--no-backups` Run migrations for all sites in the bench\n* `--no-auto-update` Build JS and CSS artifacts for the bench\n* `--skip-redis-config-generation` Skip redis config generation if already specifying the common-site-config file\n* `--verbose` Verbose output during install\n* `bench --site [site-name] COMMAND` - Specify site for command\n* `bench update` - Pulls changes for bench-repo and all apps, applies patches, builds JS and CSS, and then migrates.\n* `--pull` Pull changes in all the apps in bench\n* `--patch` Run migrations for all sites in the bench\n* `--build` Build JS and CSS artifacts for the bench\n* `--bench` Update bench\n* `--requirements` Update requirements\n* `--restart-supervisor` restart supervisor processes after update\n* `--no-backup` Don't take a backup before update\n* `--reset` Ignore local changes and update\n* `bench restart` Restart all bench services\n* `bench backup` Create a backup of the default site.\n\nBackup will be saved to `~/frappe-bench/sites/{your site}/private/backups/`.\n\n* `bench backup-all-sites` Backup all sites\n* `--with-files` Backup site with files\n* `bench restore` Restore\n* `--with-private-files` Restore site with private files (Path to tar file)\n* `--with-public-files` Restore site with public files (Path to tar file)\n* `bench migrate` Run patches, sync schema and rebuild files/translations\n* `--rebuild-website TEXT` Rebuild webpages after migration\n* `bench migrate-env [python-version]` Will migrate the virtual environment to the desired python version\n* `bench --site [sitename] set-admin-password [password]` Will reset the administrator password\n* `bench destroy-all-sessions` Destroys all sessions", "content_type": "prose", "has_code": false, "token_count": 652}
{"chunk_id": "09_bench_cli__bench__resources__bench-commands-cheatsheet__002", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/bench-commands-cheatsheet", "title": "Bench Commands Cheatsheet", "section_heading": "Config", "content": "## Config\n\n* `bench config` - Change bench configuration\n* `auto_update [on/off]` Enable/Disable auto update for bench\n* `dns_multitenant [on/off]` Enable/Disable DNS Multitenancy\n* `http_timeout` Set http timeout\n* `restart_supervisor_on_update` Enable/Disable auto restart of supervisor\n* `serve_default_site` Configure nginx to serve the default site on\n* `update_bench_on_update` Enable/Disable bench updates on running bench...\n* `bench setup` - Setup components\n* `auto-update` Add cronjob for bench auto update\n* `backups`  Add cronjob for bench backups\n* `config`  overwrite or make config.json\n* `env`  Setup virtualenv for bench\n* `nginx`  generate config for nginx\n* `procfile`  Setup Procfile for bench start\n* `production`  setup bench for production\n* `redis`  generate config for redis cache\n* `socketio`  Setup node deps for socketio server\n* `sudoers`  Add commands to sudoers list for execution...\n* `supervisor`  generate config for supervisor\n* `add-domain`  add custom domain for site\n* `firewall`  setup firewall and block all ports except 22, 80 and 443\n* `ssh-port`  change the default ssh connection port\n* `requirements` Update Python and Node packages\n* `--node`  Update only Node packages\n* `--python`  Update only Python packages\n* `--dev` Update only Python development dependencies.\n* `bench set-nginx-port [sitename] [port]` - Set site's port in Production", "content_type": "prose", "has_code": false, "token_count": 347}
{"chunk_id": "09_bench_cli__bench__resources__bench-commands-cheatsheet__003", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/bench-commands-cheatsheet", "title": "Bench Commands Cheatsheet", "section_heading": "Development", "content": "## Development\n\n* `bench new-app [app-name]` Creates a new app\n* `bench get-app [repo-link]` - Downloads an app from a git repository and installs it\n* `--branch [branch-name]` Fetches specific branch of app\n* `bench install-app [app-name]` Installs existing app\n* `bench remove-from-installed-apps [app-name]` Remove app from the list of apps\n* `bench uninstall-app [app-name]` Delete app and everything linked to the app (Bench needs to be running)\n* `bench remove-app [app-name]` Remove app from the bench entirely\n* `bench --site [sitename] --force reinstall`  Reinstall with fresh database (Caution: Will wipe out old database)\n* `bench new-site [sitename]` - Creates a new site\n* `--db-name` Database name\n* `--db-host` Custom database host URL for remote connection\n* `--db-port` Custom database listening port (eg. port other than the default 3306)\n* `--mariadb-root-username` Root username for MariaDB\n* `--mariadb-root-password` Root password for MariaDB\n* `--admin-password` Administrator password for new site\n* `--verbose` Verbose\n* `--force` Force restore if site/database already exists\n* `--source_sql` Initiate database with a SQL file\n* `--install-app` Install app after installation`\n* `bench use [site]` Sets a default site\n* `bench drop-site` Removes site from disk and database completely\n* `--root-login`\n* `--root-password`\n* `bench set-config [key] [value]` Adds a key-value pair to site's config file\n* `bench console` Opens a IPython console in the bench venv\n* `--autoreload` Reload changes to code automatically\n* `bench execute` Execute a method inside any app.\n* Eg : `bench execute frappe.utils.scheduler.enqueue\\_scheduler\\_events`\n* `bench --site [sitename] mariadb` Opens SQL Console\n* `bench --site [sitename] export-fixtures [--app TEXT]` Export the [records defined in the app's hooks](/framework/v14/user/en/python-api/hooks#fixtures) as JSON files.\n* `bench run-tests` Run tests\n* `--app` App Name\n* `--doctype` DocType to run tests for\n* `--test` Specific Test\n* `--module` Run a particular module that has tests\n* `--profile` Runs a Python profiler on the test\n* `bench disable-production` Disables production environment\n\n### Scheduler\n\n* `bench enable-scheduler` - Enables Scheduler that will run scheduled tasks\n* `bench doctor` - Get diagnostic info about background workers\n* `bench show-pending-jobs`- Get pending jobs\n* `bench purge-jobs` - Destroy all pending jobs\n\n### Data Import\n\n* `bench data-import` - Imports Bulk Data from .csv, .xls or .xlsx\n* `--file` File Name\n* `--doctype` The DocType\n* `--type`  Insert/Update", "content_type": "prose", "has_code": false, "token_count": 643}
{"chunk_id": "09_bench_cli__bench__resources__bench-procfile__001", "module": "09_bench_cli", "source_url": "https://docs.frappe.io/framework/v15/user/en/bench/resources/bench-procfile", "title": "Bench Procfile", "section_heading": "Processes", "content": "## Processes\n\n`bench start` uses [honcho](http://honcho.readthedocs.org) to manage multiple processes in **developer mode**.\n\n### Processes\n\nThe various process that are needed to run frappe are:\n\n1. `bench start` - the web server\n2. `redis_cache` for caching (general)\n3. `redis_queue` for managing queue for background workers\n4. `redis_socketio` as a message broker for real-time updates / updates from background workers\n5. `web` for the frappe web server.\n6. `socketio` for real-time messaging.\n7. `schedule` to trigger periodic tasks\n8. `worker_*` redis workers to handle async jobs\n\nOptionally if you are developing for frappe you can add:\n\n`bench watch` to automatically build the desk javascript app.\n\n### Sample\n\nredis\\_cache: redis-server config/redis\\_cache.conf\nredis\\_socketio: redis-server config/redis\\_socketio.conf\nredis\\_queue: redis-server config/redis\\_queue.conf\nweb: bench serve --port 8000\nsocketio: /usr/bin/node apps/frappe/socketio.js\nwatch: bench watch\nschedule: bench schedule\nworker\\_short: bench worker --queue short\nworker\\_long: bench worker --queue long\nworker\\_default: bench worker --queue default", "content_type": "prose", "has_code": false, "token_count": 283}
